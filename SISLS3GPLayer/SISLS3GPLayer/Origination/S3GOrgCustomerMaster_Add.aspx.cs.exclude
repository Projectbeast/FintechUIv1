#region Page Header
/// © 2010 SUNDARAM INFOTECH SOLUTIONS P LTD . All rights reserved
/// 
/// <Program Summary>
/// Module Name			: Orgination 
/// Screen Name			: Customer Master
/// Created By			: Prabhu K
/// Created Date		: 22-July-2010
/// Purpose	            : To Add/Edit the Customer
#endregion

#region Namespaces
using System;
using System.Collections.Generic;
using System.Data;
using System.Text;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using S3GBusEntity;
using ORG = S3GBusEntity.Origination;
using ORGSERVICE = OrgMasterMgtServicesReference;
using System.Collections;
using System.Globalization;
using System.Configuration;
using System.Web;
using System.Security.Permissions;
using System.Reflection;
using System.IO;
using System.Linq;
using System.Text.RegularExpressions;

#endregion

public partial class Origination_S3GOrgCustomerMaster_Add : ApplyThemeForProject
{
    #region Initialization

    #region Variables
    //int ErrorCode;
    int intCompanyId = 0;
    int intUserId = 0;
    int intCustomerId = 0;
    string strCustomerCode;
    int intUserLevelId = 0;
    Dictionary<string, string> Procparam = null;
    //User Authorization
    string strMode = string.Empty;
    bool bClearList = false;
    bool bCreate = false;
    bool bModify = false;
    bool bQuery = false;
    bool bDelete = false;
    bool bMakerChecker = false;
    //Code end
    public string strDateFormat;
    string strKey = "Insert";
    static string strPageName = "Customer Master";
    string strAlert = "alert('__ALERT__');";
    string strRedirectPageView = "window.location.href='../Origination/S3GOrgCustomerMaster_View.aspx';";
    string strRedirectPageAdd = "window.location.href='../Origination/S3GOrgCustomerMaster_Add.aspx';";
    public static Origination_S3GOrgCustomerMaster_Add obj_Page;
    DataTable dtContractNos = null; DataTable dtSubContractNos = null;
    DataTable dtCustSubLimit = null;
    #endregion

    #region Objects
    S3GSession ObjS3GSession;
    UserInfo ObjUserInfo;
    StringBuilder strbBnkDetails = new StringBuilder();
    #endregion

    #endregion

    #region PageLoad

    /// <summary>
    /// Event for Display the UI to Add/Edit the Customer.
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    protected void Page_Load(object sender, EventArgs e)
    {
        try
        {
            ObjUserInfo = new UserInfo();
            ObjS3GSession = new S3GSession();
            strDateFormat = ObjS3GSession.ProDateFormatRW;
            intCompanyId = ObjUserInfo.ProCompanyIdRW;
            intUserId = ObjUserInfo.ProUserIdRW;
            intUserLevelId = ObjUserInfo.ProUserLevelIdRW;

            if (!IsPostBack)
            {
                if (intUserLevelId == 5)
                {
                    cmbIndustryCode.DropDownStyle = AjaxControlToolkit.ComboBoxStyle.DropDown;
                    cmbsub.DropDownStyle = AjaxControlToolkit.ComboBoxStyle.DropDown;
                    lblIndustryCode.CssClass = "styleReqFieldLabel";
                    lblsub.CssClass = "styleReqFieldLabel";
                }
                else
                {
                    cmbIndustryCode.DropDownStyle = AjaxControlToolkit.ComboBoxStyle.DropDownList;
                    cmbsub.DropDownStyle = AjaxControlToolkit.ComboBoxStyle.DropDownList;
                    lblIndustryCode.CssClass = "styleReqFieldLabel";
                    lblsub.CssClass = "styleReqFieldLabel";
                }
                FunProIntializeData();
                funPriLoadCommonLoad();
                FunGetIndustryCode();
                funPriLoadNationality();
                funPriLoadAddressType();
                FunProClearCaches();
                FunPriInsertCustSubLimit("", "", "", "", "");
                FunGetCity();
                FunGetSubIndustryCode();
                // FunPriLoadRelationType();
            }

            obj_Page = this;

            this.Page.Title = FunPubGetPageTitles(enumPageTitle.PageTitle);

            ftxtBankAddress.ValidChars += "\n";
            ftxtBankBranch.ValidChars += "\n";
            //User Authorization
            bCreate = ObjUserInfo.ProCreateRW;
            bModify = ObjUserInfo.ProModifyRW;
            bQuery = ObjUserInfo.ProViewRW;
            //Code end
            string strFormat = ObjS3GSession.ProDateFormatRW;
            txtDOB.Attributes.Add("onblur", "fnDoDate(this,'" + txtDOB.ClientID + "','" + strFormat + "',true,false);");
            txtWeddingdate.Attributes.Add("onblur", "fnDoDate(this,'" + txtWeddingdate.ClientID + "','" + strFormat + "',true,false);");
            txtIdentityIssueDate.Attributes.Add("onblur", "fnDoDate(this,'" + txtIdentityIssueDate.ClientID + "','" + strFormat + "',true,false);");
            txtIdentityExpiredate.Attributes.Add("onblur", "fnDoDate(this,'" + txtIdentityExpiredate.ClientID + "','" + strFormat + "',true,false);");
            txtLabourCardDate.Attributes.Add("onblur", "fnDoDate(this,'" + txtLabourCardDate.ClientID + "','" + strFormat + "',true,false);");
            txtLaborExpDate.Attributes.Add("onblur", "fnDoDate(this,'" + txtLaborExpDate.ClientID + "','" + strFormat + "',true,false);");
            txtDateOfJoin.Attributes.Add("onblur", "fnDoDate(this,'" + txtDateOfJoin.ClientID + "','" + strFormat + "',true,false);");
            txtOCCIIssueDate.Attributes.Add("onblur", "fnDoDate(this,'" + txtOCCIIssueDate.ClientID + "','" + strFormat + "',true,false);");
            txtOCCIExpiryDate.Attributes.Add("onblur", "fnDoDate(this,'" + txtOCCIExpiryDate.ClientID + "','" + strFormat + "',true,false);");
            txtFacLimitExp.Attributes.Add("onblur", "fnDoDate(this,'" + txtFacLimitExp.ClientID + "','" + strFormat + "',true,false);");
            txtMaxLenLimiExpDate.Attributes.Add("onblur", "fnDoDate(this,'" + txtMaxLenLimiExpDate.ClientID + "','" + strFormat + "',true,false);");
            //txtCEOWeddingDate.Attributes.Add("onblur", "fnDoDate(this,'" + txtCEOWeddingDate.ClientID + "','" + strFormat + "',true,false);");
            // txtExprDate.Attributes.Add("onblur", "fnDoDate(this,'" + txtExprDate.ClientID + "','" + strFormat + "',true,false);");
            //txtIdentityExpiredate.Attributes.Add("readonly", "true");
            //txtIdentityIssueDate.Attributes.Add("readonly", "true");123
            //<<Performance>>
            //FunSetComboBoxAttributes(txtComCity.TextBox, "City", "30");

            //FunSetComboBoxAttributes(txtComState, "State", "60");

            //FunSetComboBoxAttributes(txtPerState, "State", "60");


            //FunSetComboBoxAttributes(txtPerCountry, "Country", "60");
            //FunSetComboBoxAttributes(txtComCountry, "Country", "60");



            if (Request.QueryString["CR_VALUE"] != null)
            {
                if (Request.QueryString["CR_VALUE"].ToString() != string.Empty && Request.QueryString["CR_VALUE"].ToString() != " ")
                {
                    txtCustomercode.Text = Request.QueryString["CR_VALUE"].ToString();
                }
            }

            if (Request.QueryString["qsCustomerId"] != null)
            {
                FormsAuthenticationTicket fromTicket = FormsAuthentication.Decrypt(Request.QueryString.Get("qsCustomerId"));
                if (fromTicket != null)
                {
                    intCustomerId = Convert.ToInt32(fromTicket.Name);
                    ViewState["CustomerId"] = intCustomerId;
                }
                else
                {
                    strAlert = strAlert.Replace("__ALERT__", "Invalid Customer Details");
                    ScriptManager.RegisterStartupScript(this, this.GetType(), strKey, strAlert + strRedirectPageView, true);
                }
                strMode = Request.QueryString["qsMode"];
            }
            if (ViewState["CustomerId"] != null)
            {
                intCustomerId = Convert.ToInt32(ViewState["CustomerId"]);
            }
            if (strMode == "")
            {
                tcCustomerMaster.Tabs[6].Visible = false;
            }
            //txtPercentageStake.SetDecimalPrefixSuffix(2, 2, false, false, "Promoters Stake %");
            //txtJVPartnerStake.SetDecimalPrefixSuffix(2, 2, false, false, "JV Partner Stake %");
            if (ObjUserInfo.ProCountryNameR.Trim().ToLower() == "india")
            {
                ftxtMICRCode.FilterType = AjaxControlToolkit.FilterTypes.Numbers;
                txtMICRCode.MaxLength = 9;
            }
            else
            {
                ftxtMICRCode.FilterType = AjaxControlToolkit.FilterTypes.Custom | AjaxControlToolkit.FilterTypes.Numbers | AjaxControlToolkit.FilterTypes.LowercaseLetters | AjaxControlToolkit.FilterTypes.UppercaseLetters;
                txtMICRCode.MaxLength = 10;
            }
            if (ObjS3GSession.ProPINCodeDigitsRW > 0)
            {
                //txtComPincode.MaxLength = txtPerPincode.MaxLength = ObjS3GSession.ProPINCodeDigitsRW;
                //if (ObjS3GSession.ProPINCodeTypeRW.ToUpper() == "ALPHA NUMERIC")
                //{
                //    ftxtComPincode.FilterType = AjaxControlToolkit.FilterTypes.Numbers | AjaxControlToolkit.FilterTypes.Custom | AjaxControlToolkit.FilterTypes.UppercaseLetters | AjaxControlToolkit.FilterTypes.LowercaseLetters;
                //    ftxtPerPincode.FilterType = AjaxControlToolkit.FilterTypes.Numbers | AjaxControlToolkit.FilterTypes.Custom | AjaxControlToolkit.FilterTypes.UppercaseLetters | AjaxControlToolkit.FilterTypes.LowercaseLetters;
                //}
                //else
                //{
                //    ftxtComPincode.FilterType = AjaxControlToolkit.FilterTypes.Numbers;
                //    ftxtPerPincode.FilterType = AjaxControlToolkit.FilterTypes.Numbers;
                //}
            }
            if (!IsPostBack)
            {
                ucBasicDetAddressSetup.BindAddressSetupDetails(1);
                pnlCustdtls.Visible = false;
                FunPriSetControlSettings();
                FunPubBindAddsGrid();
                //ucOtherDetAddressSetup.BindAddressSetupDetails(2);
                //CalendarCEOWeddingDate.Format = ObjS3GSession.ProDateFormatRW;
                CalendarExtenderSD.Format = ObjS3GSession.ProDateFormatRW;
                CalendarValidupto.Format = ObjS3GSession.ProDateFormatRW;
                CalendarWeddingdate.Format = ObjS3GSession.ProDateFormatRW;
                calIdentityIssueDate.Format = ObjS3GSession.ProDateFormatRW;
                calIdentityExpiredate.Format = calLabourCardDate.Format = calLaborExpDate.Format = ObjS3GSession.ProDateFormatRW;
                calDateOfJoin.Format = calOCCIIssueDate.Format = calOCCIExpiryDate.Format = calFacLimitExp.Format = calMaxLenLimiExpDate.Format = ObjS3GSession.ProDateFormatRW;

                if (strMode != "Q")
                {
                    FunPriLoadMasterData();
                    FunProLoadAddressCombos();
                    // FunSetCompanyCountryName();
                    //FunPriLoadContractNos();
                }
                txtDOB.Attributes.Add("onblur", "fnDoDate(this,'" + txtDOB.ClientID + "','" + strDateFormat + "',true,false);");
                //txtCEOWeddingDate.Attributes.Add("onblur", "fnDoDate(this,'" + txtCEOWeddingDate.ClientID + "','" + strDateFormat + "',true,false);");
                txtWeddingdate.Attributes.Add("onblur", "fnDoDate(this,'" + txtWeddingdate.ClientID + "','" + strDateFormat + "',true,false);");
                txtIdentityExpiredate.Attributes.Add("onblur", "fnDoDate(this,'" + txtIdentityExpiredate.ClientID + "','" + strDateFormat + "',true,false);");
                txtIdentityIssueDate.Attributes.Add("onblur", "fnDoDate(this,'" + txtIdentityIssueDate.ClientID + "','" + strDateFormat + "',true,false);");
                //User Authorization
                bClearList = Convert.ToBoolean(ConfigurationManager.AppSettings.Get("ClearListValues"));
                if (intCustomerId > 0)
                {

                    if (strMode == "M")
                    {
                        FunPriDisableControls(1);
                        if (ddlCustomerType.SelectedItem.ToString().ToLower() == "non individual")
                        {
                            rfvIndustryCode.Enabled = true;
                            rfvcmbsub.Enabled = true;
                            lblIndustryCode.CssClass = "styleReqFieldLabel";
                            lblsub.CssClass = "styleReqFieldLabel";
                        }
                        else
                        {
                            lblIndustryCode.CssClass = "styleReqFieldLabel";
                            lblsub.CssClass = "styleDisplayLabel";
                            rfvIndustryCode.Enabled = true;
                            rfvcmbsub.Enabled = false;
                        }
                    }
                    else
                    {
                        FunPriDisableControls(-1);
                    }

                }
                else
                {
                    FunPriDisableControls(0);
                }

                if (Request.QueryString["IsFromEnquiry"] != null || Request.QueryString["IsFromApplication"] != null || Request.QueryString["IsFromAssignment"] != null)
                {
                    chkCoApplicant.Enabled = chkGuarantor1.Enabled = chkGuarantor2.Enabled = false;
                    if (Request.QueryString["IsFromAssignment"] != null)
                        btnCancel.Enabled = false;

                    if (Request.QueryString["EnquiryID"] != null)
                    {
                        int intEnquiryID = Convert.ToInt32(Request.QueryString.Get("EnquiryID"));
                        FunPriLoadEnquiryDetails(intEnquiryID);
                    }
                }

            }
        }
        catch (Exception objException)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(objException, strPageName);
            cvCustomerMaster.ErrorMessage = Resources.LocalizationResources.PageLoadError;
            cvCustomerMaster.IsValid = false;
        }
    }

    protected void FunSetComboBoxAttributes(AjaxControlToolkit.ComboBox cmb, string Type, string maxLength)
    {
        TextBox textBox = cmb.FindControl("TextBox") as TextBox;

        if (textBox != null)
        {
            textBox.Attributes.Add("onkeyup", "maxlengthfortxt('" + maxLength + "');fnCheckSpecialChars('true');");
            textBox.Attributes.Add("onblur", "funCheckFirstLetterisNumeric(this, '" + Type + "');");
            textBox.Attributes.Add("onpaste", "return false");
        }
    }

    protected void FunSetComboBoxAttributes(TextBox textBox, string Type, string maxLength)
    {
        if (textBox != null)
        {
            textBox.Attributes.Add("onkeyup", "maxlengthfortxt('" + maxLength + "');fnCheckSpecialChars('true');");
            textBox.Attributes.Add("onblur", "funCheckFirstLetterisNumeric(this, '" + Type + "');");
            textBox.Attributes.Add("onpaste", "return false");
        }
    }

    //<<Performance>>
    [System.Web.Services.WebMethod]
    public static string[] GetCityList(String prefixText, int count)
    {
        Dictionary<string, string> Procparam;
        Procparam = new Dictionary<string, string>();
        List<String> suggetions = new List<String>();
        DataTable dtCommon = new DataTable();
        DataSet Ds = new DataSet();

        Procparam.Clear();
        Procparam.Add("@Company_ID", obj_Page.intCompanyId.ToString());
        Procparam.Add("@Category", "1");
        Procparam.Add("@PrefixText", prefixText);
        suggetions = Utility.GetSuggestions(Utility.GetDefaultData("S3G_SYSAD_GetAddressLoodup_AGT", Procparam), false);

        return suggetions.ToArray();
    }

    protected void FunProLoadAddressCombos()
    {
        try
        {
            Dictionary<string, string> Procparam = new Dictionary<string, string>();
            if (intCompanyId > 0)
            {
                Procparam.Add("@Company_ID", Convert.ToString(intCompanyId));
            }
            DataTable dtAddr = Utility.GetDefaultData("S3G_SYSAD_GetAddressLoodup", Procparam);

            DataTable dtSource = new DataTable();
            //if (dtAddr.Select("Category = 1").Length > 0)
            //{
            //    dtSource = dtAddr.Select("Category = 1").CopyToDataTable();
            //}
            //else
            //{
            //    dtSource = FunProAddAddrColumns(dtSource);
            //}

            //<<Performance>>
            //txtComCity.FillDataTable(dtSource, "Name", "Name", false);
            //txtPerCity.FillDataTable(dtSource, "Name", "Name", false);

            dtSource = new DataTable();
            if (dtAddr.Select("Category = 2").Length > 0)
            {
                dtSource = dtAddr.Select("Category = 2").CopyToDataTable();
            }
            else
            {
                dtSource = FunProAddAddrColumns(dtSource);
            }

            //txtComState.FillDataTable(dtSource, "Name", "Name", false);
            //txtPerState.FillDataTable(dtSource, "Name", "Name", false);

            dtSource = new DataTable();
            if (dtAddr.Select("Category = 3").Length > 0)
            {
                dtSource = dtAddr.Select("Category = 3").CopyToDataTable();
            }
            else
            {
                dtSource = FunProAddAddrColumns(dtSource);
            }

            //txtComCountry.FillDataTable(dtSource, "ID", "Name", false);
            ////txtComCountry.SelectedValue = "18";
            //txtPerCountry.FillDataTable(dtSource, "ID", "Name", false);
            //txtPerCountry.SelectedValue = "18";

        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            cvCustomerMaster.ErrorMessage = ex.Message;
            cvCustomerMaster.IsValid = false;
        }
    }


    //private void FunPriLoadContractNos()
    //{
    //    try
    //    {
    //        Procparam = new Dictionary<string, string>();
    //        Procparam.Clear();
    //        Procparam.Add("@Company_ID", obj_Page.intCompanyId.ToString());
    //        Procparam.Add("@Customer_Id", intCustomerId.ToString());
    //        DataSet dsContractNos = Utility.GetDataset("S3G_ORG_Get_PANumSANum", Procparam);

    //        dtContractNos = dsContractNos.Tables[0].Copy();
    //        dtSubContractNos = dsContractNos.Tables[1].Copy();

    //        if (dtContractNos.Rows.Count > 0)
    //        {
    //            ddlPANum.FillDataTable(dtContractNos, "PANum", "PANum");
    //            ViewState["dsContractNos"] = dsContractNos;
    //        }
    //        if (dtSubContractNos.Rows.Count > 0)
    //        {
    //            ddlSANum.FillDataTable(dtSubContractNos, "SANum", "SANum");
    //        }
    //    }
    //    catch (Exception ex)
    //    {

    //    }
    //}

    protected DataTable FunProAddAddrColumns(DataTable dt)
    {
        dt.Columns.Add("ID");
        dt.Columns.Add("Name");
        dt.Columns.Add("Category");

        return dt;
    }

    /// <summary>
    /// Event for Pre-Initialize the Components  
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    protected new void Page_PreInit(object sender, EventArgs e)
    {
        try
        {
            if (Request.QueryString["IsFromEnquiry"] != null || Request.QueryString["IsFromApplication"] != null || Request.QueryString["IsFromAssignment"] != null)
            {
                this.Page.MasterPageFile = "~/Common/MasterPage.master";
                UserInfo ObjUserInfo = new UserInfo();
                this.Page.Theme = ObjUserInfo.ProUserThemeRW;
            }
            else
            {
                this.Page.MasterPageFile = "~/Common/S3GMasterPageCollapse.master";
                UserInfo ObjUserInfo = new UserInfo();
                this.Page.Theme = ObjUserInfo.ProUserThemeRW;
            }
        }
        catch (Exception objException)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(objException, strPageName);
            cvCustomerMaster.ErrorMessage = "Unable to Initialize the Customer Details";
            cvCustomerMaster.IsValid = false;
        }
    }


    #endregion

    #region Button Events

    /// <summary>
    /// Event for Insert/Update the CustomerDetails
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    protected void btnSave_Click(object sender, EventArgs e)
    {
        try
        {
            string strPassport;
            string strNational;

            Procparam = new Dictionary<string, string>();

            Procparam.Add("@CustomerName", txtCustomerName.Text.ToString());

            foreach (GridViewRow grv in gvConstitutionalDocuments.Rows)
            {
                TextBox txtValues = (TextBox)grv.FindControl("txtValues");

                string strDocumentFlag = grv.Cells[1].Text;
                if (strDocumentFlag.ToUpper() == "CID-PP")
                {
                    strPassport = txtValues.Text.ToString();
                    Procparam.Add("@PassportNo", strPassport);


                }

                else if (strDocumentFlag.ToUpper() == "CID-UID")
                {
                    strNational = txtValues.Text;
                    Procparam.Add("@NationalIdentificationNo", strNational.ToString());
                }




            }

            //txtValues.Text = Convert.ToDecimal(dt.Compute("Sum(Tran_Currency_Amount1)", "")).ToString(FunSetSuffix());



            DataTable dtNeg = Utility.GetDefaultData("NegativeListComparison", Procparam);

            if (dtNeg.Rows.Count > 0)
            {
                if (Convert.ToInt32(dtNeg.Rows[0]["ErrorCode"].ToString()) > 0)
                {
                    Utility.FunShowAlertMsg(this, "The entered Details exists in the Negative Customer List");
                    return;
                }

            }
            string strDocName = "";
            string strConstitutionAlert = "";
            string strDeDupCustomerCode = "";
            //if (FunPriValidateDeDuplicateCustomer(out strDocName, out strDeDupCustomerCode))
            //{
            //    strDocName = strDocName.Substring(0, strDocName.Length - 1);
            //    strConstitutionAlert = "alert('__ALERT__');";
            //    if (strDeDupCustomerCode != "")
            //    {
            //        strDeDupCustomerCode = strDeDupCustomerCode.Substring(0, strDeDupCustomerCode.Length - 1);
            //        strDeDupCustomerCode.Replace(",", @"\n");
            //        strConstitutionAlert = strDocName + @" already Exist for following Customer \n" + strDeDupCustomerCode;
            //    }
            //    else
            //    {
            //        strConstitutionAlert = strDocName + @" already Exist for another Customer";
            //    }
            //    strConstitutionAlert += @"\n\nWould you like to proceed?";
            //    strConstitutionAlert = "if(confirm('" + strConstitutionAlert + "')){ document.getElementById('ctl00_ContentPlaceHolder1_btnProceedSave').click();}else{;" + strRedirectPageView + "}";
            //    ScriptManager.RegisterStartupScript(this, this.GetType(), "Cusotmer Master", strConstitutionAlert, true);
            //    return;
            //}
            strDocName = "";
            if (FunPriValidateDuplicateConstitutionDocs(out strDocName))
            {
                strDocName = strDocName.Substring(0, strDocName.Length - 1);
                strConstitutionAlert = "alert('__ALERT__');";
                strConstitutionAlert = strDocName + " already Exist for another Customer";
                strAlert = strAlert.Replace("__ALERT__", strConstitutionAlert);
                ScriptManager.RegisterStartupScript(this, this.GetType(), "Customer Master", strAlert, true);
                //strConstitutionAlert += @"\n\nWould you like to proceed?";
                //strConstitutionAlert = "if(confirm('" + strConstitutionAlert + "')){ document.getElementById('ctl00_ContentPlaceHolder1_btnProceedSave').click();}else{;" + strRedirectPageView + "}";
                //ScriptManager.RegisterStartupScript(this, this.GetType(), "Cusotmer Master", strConstitutionAlert, true);
                return;
            }

            //if (txtComPincode.Text.Trim().Length > 0 && ObjS3GSession.ProPINCodeDigitsRW != txtComPincode.Text.Trim().Length)
            //{
            //    ScriptManager.RegisterStartupScript(this, this.GetType(), "Customer Details", "alert('Communication address Postal Code should be " + ObjS3GSession.ProPINCodeDigitsRW.ToString() + " digits');", true);
            //    tcCustomerMaster.ActiveTab = tbAddress;
            //    return;
            //}
            //else if (txtPerPincode.Text.Trim().Length > 0 && ObjS3GSession.ProPINCodeDigitsRW != txtPerPincode.Text.Trim().Length)
            //{
            //    ScriptManager.RegisterStartupScript(this, this.GetType(), "Customer Details", "alert('Permanent address Postal Code should be " + ObjS3GSession.ProPINCodeDigitsRW.ToString() + " digits');", true);
            //    tcCustomerMaster.ActiveTab = tbAddress;
            //    return;
            //}

            if (ddlCustomerType.SelectedItem.Text.ToUpper() != "INDIVIDUAL")
            {
                if (cmbPublic.SelectedIndex == 0)
                {
                    ScriptManager.RegisterStartupScript(this, this.GetType(), "Customer Details", "alert('Select the Public/Closely held');", true);
                    tcCustomerMaster.ActiveTabIndex = 1;
                    return;

                }

            }
            if (ddlCustomerType.SelectedItem.Text.ToUpper() == "INDIVIDUAL")
            {
                if (txtDOB.Text == "")
                {
                    ScriptManager.RegisterStartupScript(this, this.GetType(), "Customer Details", "alert('Enter the Date of Birth');", true);
                    tcCustomerMaster.ActiveTabIndex = 1;
                    return;
                }


            }
            //if (ddlCustomerType.SelectedItem.Text.ToUpper() != "INDIVIDUAL" && txtResidentialAddress.Text != "" && txtResidentialAddress.Text.Length > 300)
            //{
            //    ScriptManager.RegisterStartupScript(this, this.GetType(), "Customer Details", "alert('Residential Address Length should be less than or equal to 300');", true);
            //    tcCustomerMaster.ActiveTabIndex = 1;
            //    return;

            //}
            if (ViewState["ConsDocPath"] == null)
            {
                Utility.FunShowAlertMsg(this, "Define the spooling path in Document Path Setup for Constitution Document");
                return;
            }
            if (ViewState["ConsDocPath"] != null)
            {
                if (Convert.ToString(ViewState["ConsDocPath"]) == "")
                {
                    Utility.FunShowAlertMsg(this, "Define the spooling path in Document Path Setup for Constitution Document");
                    return;
                }
            }

            foreach (GridViewRow grv in gvConstitutionalDocuments.Rows)
            {
                //AjaxControlToolkit.AsyncFileUpload AsyncFileUpload1 = (AjaxControlToolkit.AsyncFileUpload)grv.FindControl("asyFileUpload");
                //TextBox txOD = grv.FindControl("txOD") as TextBox;
                LinkButton hlnkView = grv.FindControl("hlnkView") as LinkButton;
                CheckBox chkIsMandatory = (CheckBox)grv.FindControl("chkIsMandatory");
                CheckBox chkIsNeedImageCopy = (CheckBox)grv.FindControl("chkIsNeedImageCopy");
                CheckBox chkCollected = (CheckBox)grv.FindControl("chkCollected");
                CheckBox chkScanned = (CheckBox)grv.FindControl("chkScanned");
                TextBox txtValues = grv.FindControl("txtValues") as TextBox;
                Label lblActualPath = (Label)grv.FindControl("lblActualPath");
                int intRowindex = grv.RowIndex;
                string fileExtension = string.Empty;
                if (chkScanned.Checked && Cache["File" + intRowindex.ToString()] == null && string.IsNullOrEmpty(lblActualPath.Text))
                {
                    Utility.FunShowAlertMsg(this, "All the scanned documents file should be uploaded.");
                    tcCustomerMaster.ActiveTab = TabConstitution;
                    return;
                }
                else
                {
                    if (Cache["File" + intRowindex.ToString()] != null)
                    {
                        HttpPostedFile hpf = (HttpPostedFile)Cache["File" + intRowindex.ToString()];
                        fileExtension = hpf.FileName;
                    }
                    else if (!string.IsNullOrEmpty(lblActualPath.Text))
                    {
                        fileExtension = lblActualPath.Text;
                    }

                }
                // Modified by R. Manikandan
                //Added Two Condition to check Mandatory Scanned Doc must only validated chkScanned.Checked == true && chkCollected.Checked == true

                if (!string.IsNullOrEmpty(fileExtension) && chkScanned.Checked == true && chkCollected.Checked == true)
                {
                    fileExtension = fileExtension.Substring(fileExtension.LastIndexOf('.') + 1);
                    if (fileExtension != "" && fileExtension.ToLower() != "bmp" && fileExtension.ToLower() != "jpeg" && fileExtension.ToLower() != "jpg" && fileExtension.ToLower() != "gif" && fileExtension.ToLower() != "png" && fileExtension.ToLower() != "pdf")
                    {
                        Utility.FunShowAlertMsg(this, "Image/PDF file only can be uploaded. Please check the file format " + fileExtension + "");
                        //Utility.FunShowAlertMsg(this, "Image/PDF file only can be uploaded. Check the file format of " + fileExtension + "");
                        return;
                    }

                }


                //string fileExtension = AsyncFileUpload1.FileName.Substring(AsyncFileUpload1.FileName.LastIndexOf('.') + 1);
                //if (fileExtension != "" && fileExtension.ToLower() != "bmp" && fileExtension.ToLower() != "jpeg" && fileExtension.ToLower() != "jpg" && fileExtension.ToLower() != "gif" && fileExtension.ToLower() != "png" && fileExtension.ToLower() != "pdf")
                //{
                //    Utility.FunShowAlertMsg(this, "Image/PDF file only can be uploaded. Check the file format of " + AsyncFileUpload1.FileName.ToString() + "");
                //    return;
                //}

                //if (chkIsMandatory.Checked && !chkCollected.Checked)
                //{
                //    Utility.FunShowAlertMsg(this, "All the mandatory documents should be collected.");
                //    tcCustomerMaster.ActiveTab = TabConstitution;
                //    return;
                //}
                //if (chkIsNeedImageCopy.Checked && (!chkScanned.Checked || (!hlnkView.Enabled && !AsyncFileUpload1.HasFile)))
                // Bug Fixed on 07 - DEC - 2012  Based On Bashyam sir Mail.



                //if (chkIsNeedImageCopy.Checked && (!hlnkView.Enabled && !AsyncFileUpload1.HasFile) && (chkIsMandatory.Checked))
                //{
                //    Utility.FunShowAlertMsg(this, "All the mandatory documents should be Uploaded.");
                //    tcCustomerMaster.ActiveTab = TabConstitution;
                //    return;
                //}

                if (chkCollected.Checked && (grv.Cells[1].Text.ToString().StartsWith("CID")) && txtValues.Text.Trim() == string.Empty)
                {
                    Utility.FunShowAlertMsg(this, "All the Collected documents values should be entered.");
                    tcCustomerMaster.ActiveTab = TabConstitution;
                    return;
                }

                if (grv.Cells[1].Text.ToString().ToUpper() == "CID-PTN")
                {
                    if (ObjS3GSession.ProCompanyCountry.Trim().ToLower() == "india" && txtValues.Text.Trim() != "")
                    {
                        string strExp = @"^([a-zA-Z]){5}([0-9]){4}([a-zA-Z]){1}$";
                        if (!Regex.IsMatch(txtValues.Text.Trim(), strExp))
                        {
                            Utility.FunShowAlertMsg(this, "Permanent Tax Number should be in format of AAAAA9999A");
                            tcCustomerMaster.ActiveTab = TabConstitution;
                            txtValues.Focus();
                            return;
                        }
                    }
                }
            }

            //FunPriUploadFiles();
            FunProUploadFilesNew();
            FunPriSaveCustomer();
        }
        catch (Exception objException)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(objException, strPageName);
            if (intCustomerId > 0)
            {
                cvCustomerMaster.ErrorMessage = Resources.LocalizationResources.UpdateError;
            }
            else
            {
                cvCustomerMaster.ErrorMessage = Resources.LocalizationResources.InsertError;
            }
            cvCustomerMaster.IsValid = false;

        }
    }
    protected void btnProceedSave_Click(object sender, EventArgs e)
    {
        try
        {
            FunPriSaveCustomer();
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            if (intCustomerId > 0)
            {
                cvCustomerMaster.ErrorMessage = Resources.LocalizationResources.UpdateError;
            }
            else
            {
                cvCustomerMaster.ErrorMessage = Resources.LocalizationResources.InsertError;
            }
            cvCustomerMaster.IsValid = false;
        }
    }
    private void FunPriSaveCustomer()
    {

        OrgMasterMgtServicesReference.OrgMasterMgtServicesClient objCustomerMasterClient = new OrgMasterMgtServicesReference.OrgMasterMgtServicesClient();
        try
        {

            FunPriSetControlSettings();
            int intErrorCode = 0;
            CustomerMasterBusEntity ObjCustomerMaster = new CustomerMasterBusEntity();
            ObjCustomerMaster.ID = Convert.ToInt32(intCustomerId);
            ObjCustomerMaster.CustomerCode = txtCustomercode.Text.Trim();
            ObjCustomerMaster.CustomerType_ID = Convert.ToInt32(ddlCustomerType.SelectedValue);
            if (!string.IsNullOrEmpty(hdnGroupCode.Value))
            {
                ObjCustomerMaster.GROUP_ID = Convert.ToInt32(hdnGroupCode.Value);
                //ObjCustomerMaster.GroupCode = cmbGroupCode.Text.Trim();
            }
            //ObjCustomerMaster.Groupname = txtGroupName.Text.Trim();
            if (!string.IsNullOrEmpty(cmbIndustryCode.Text.Trim()))
                ObjCustomerMaster.IndustryCode = cmbIndustryCode.SelectedValue;
            ObjCustomerMaster.IndustryName = cmbIndustryCode.SelectedItem.Text;
            if (ObjCustomerMaster.IndustryCode == "--Select--")
            {
                ObjCustomerMaster.IndustryName = "";
                ObjCustomerMaster.IndustryCode = "";
            }
            //Sub Industry
            if (!string.IsNullOrEmpty(cmbsub.Text.Trim()))
                ObjCustomerMaster.SubIndustryCode = cmbsub.SelectedValue;
            ObjCustomerMaster.SubIndustryName = cmbsub.SelectedItem.Text;
            //Sub Industry
            if (ddlCustomerType.SelectedItem.Text.ToLower() == "non individual")
            {
                if (cmbIndustryCode.SelectedItem.Text == string.Empty || cmbIndustryCode.SelectedItem.Text == "" || cmbIndustryCode.SelectedItem.Text == "0")
                {
                    Utility.FunShowAlertMsg(this, "Enter Industry Name");
                    return;
                }
                else if (cmbsub.SelectedItem.Text == string.Empty || cmbsub.SelectedItem.Text == "0" || cmbsub.SelectedItem.Text == "")
                {
                    Utility.FunShowAlertMsg(this, "Enter Sub Industry Name");
                    return;
                }
            }
            //if (Convert.ToInt32(cmbIndustryCode.SelectedValue) > 0)
            //{
            //    ObjCustomerMaster.IndustryCode = cmbIndustryCode.SelectedValue;
            //    ObjCustomerMaster.IndustryName = cmbIndustryCode.SelectedItem.Text;
            //}
            if (!string.IsNullOrEmpty(ddlConstitutionName.Text.Trim())) ObjCustomerMaster.Constitution_ID = Convert.ToInt32(ddlConstitutionName.SelectedValue);
            ObjCustomerMaster.Title = ddlTitle.SelectedValue;
            ObjCustomerMaster.CustomerName = txtCustomerName.Text.Trim();
            if (!string.IsNullOrEmpty(ddlPostingGroup.SelectedValue)) ObjCustomerMaster.CustomerPostingGroupCode_ID = Convert.ToInt32(ddlPostingGroup.SelectedValue);

            //ObjCustomerMaster.Comm_Address1 = txtComAddress1.Text.Trim();
            //ObjCustomerMaster.Comm_Address2 = txtCOmAddress2.Text.Trim();
            ////<<Performance>>
            ////ObjCustomerMaster.Comm_City = txtComCity.Text.Trim();
            //ObjCustomerMaster.Comm_City = txtComCity.SelectedItem.Text.Trim();
            //ObjCustomerMaster.Comm_State = txtComState.Text.Trim();
            //ObjCustomerMaster.Comm_Country = txtComCountry.SelectedItem.Text.Trim();
            //ObjCustomerMaster.Comm_PINCode = txtComPincode.Text.Trim();
            //ObjCustomerMaster.Comm_Mobile = txtComMobile.Text.Trim();
            //ObjCustomerMaster.Comm_Telephone = txtComTelephone.Text.Trim();
            //ObjCustomerMaster.Comm_Email = txtComEmail.Text.Trim();
            //ObjCustomerMaster.Comm_Website = txtComWebsite.Text.Trim();
            //ObjCustomerMaster.Perm_Address1 = txtPerAddress1.Text.Trim();
            //ObjCustomerMaster.Perm_Address2 = txtPerAddress2.Text.Trim();
            ////<<Performance>>
            ////ObjCustomerMaster.Perm_City = txtPerCity.SelectedItem.Text.Trim();
            //ObjCustomerMaster.Perm_City = txtPerCity.SelectedItem.Text.Trim();
            //ObjCustomerMaster.Perm_State = txtPerState.SelectedItem.Text.Trim();
            //ObjCustomerMaster.Perm_Country = txtPerCountry.SelectedItem.Text.Trim();
            //ObjCustomerMaster.Perm_PINCode = txtPerPincode.Text.Trim();
            //ObjCustomerMaster.Perm_Mobile = txtPerMobile.Text.Trim();
            //ObjCustomerMaster.Perm_Telephone = txtPerTelephone.Text.Trim();
            //ObjCustomerMaster.Perm_Email = txtPerEmail.Text.Trim();
            //ObjCustomerMaster.Perm_Website = txtPerWebSite.Text.Trim();

            ObjCustomerMaster.Gender = ddlGender.SelectedValue;
            if (!string.IsNullOrEmpty(txtDOB.Text.Trim()))
                ObjCustomerMaster.DateofBirth = Utility.StringToDate(txtDOB.Text);
            if (!string.IsNullOrEmpty(ddlMaritalStatus.Text.Trim())) ObjCustomerMaster.MaritalStatus_ID = Convert.ToInt32(ddlMaritalStatus.SelectedValue);
            ObjCustomerMaster.Qualification = txtQualification.Text.Trim();
            ObjCustomerMaster.Profession = txtProfession.Text.Trim();
            ObjCustomerMaster.SpouseName = txtSpouseName.Text.Trim();
            if (!string.IsNullOrEmpty(txtChildren.Text.Trim())) ObjCustomerMaster.Children = Convert.ToInt32(txtChildren.Text.Trim());
            if (!string.IsNullOrEmpty(txtTotalDependents.Text.Trim())) ObjCustomerMaster.TotalDependents = Convert.ToInt32(txtTotalDependents.Text.Trim());
            if (!string.IsNullOrEmpty(txtWeddingdate.Text.Trim())) ObjCustomerMaster.WeddingAnniversaryDate = Utility.StringToDate(txtWeddingdate.Text);
            if (!string.IsNullOrEmpty(ddlHouseType.Text.Trim())) ObjCustomerMaster.HouseORFlat_ID = Convert.ToInt32(ddlHouseType.SelectedValue);
            //if (!string.IsNullOrEmpty(ddlOwn.Text.Trim())) ObjCustomerMaster.ISOwn = Convert.ToInt16(ddlOwn.SelectedValue);
            if (!string.IsNullOrEmpty(txtCurrentMarketValue.Text.Trim())) ObjCustomerMaster.CurrentMarketValue = txtCurrentMarketValue.Text.Trim();
            if (!string.IsNullOrEmpty(txtRemainingLoanValue.Text.Trim())) ObjCustomerMaster.RemainingLoanValue = txtRemainingLoanValue.Text.Trim();
            if (!string.IsNullOrEmpty(txtTotNetWorth.Text.Trim())) ObjCustomerMaster.TotalNetMorth = txtTotNetWorth.Text.Trim();
            if (!string.IsNullOrEmpty(cmbPublic.Text.Trim())) ObjCustomerMaster.PublicCloselyheld_ID = Convert.ToInt32(cmbPublic.SelectedValue);
            if (!string.IsNullOrEmpty(txtDirectors.Text.Trim())) ObjCustomerMaster.NoOfDirectors = Convert.ToInt32(txtDirectors.Text.Trim());
            ObjCustomerMaster.ListedAtStockExchange = txtSE.Text.Trim();
            if (!string.IsNullOrEmpty(txtPaidCapital.Text.Trim())) ObjCustomerMaster.PaidupCapital = Convert.ToDecimal(txtPaidCapital.Text.Trim());
            if (!string.IsNullOrEmpty(txtfacevalue.Text.Trim())) ObjCustomerMaster.FaceValueofShares = Convert.ToDecimal(txtfacevalue.Text.Trim());
            if (!string.IsNullOrEmpty(txtbookvalue.Text.Trim())) ObjCustomerMaster.BookValueofShares = Convert.ToDecimal(txtbookvalue.Text.Trim());
            ObjCustomerMaster.BusinessProfile = txtBusinessProfile.Text.Trim();
            ObjCustomerMaster.Geographicalcoverage = txtGeographical.Text.Trim();
            if (!string.IsNullOrEmpty(txtnobranch.Text.Trim())) ObjCustomerMaster.NoOfBranches = Convert.ToDecimal(txtnobranch.Text.Trim());
            if (!string.IsNullOrEmpty(ddlGovernment.Text.Trim())) ObjCustomerMaster.GovernmentInstitutionalParticipation_ID = Convert.ToInt32(ddlGovernment.SelectedValue);
            if (!string.IsNullOrEmpty(txtPercentageStake.Text.Trim())) ObjCustomerMaster.PercentageOfStake = Convert.ToDecimal(txtPercentageStake.Text.Trim());
            ObjCustomerMaster.JVPartnerName = txtJVPartnerName.Text.Trim();
            if (!string.IsNullOrEmpty(txtJVPartnerStake.Text.Trim())) ObjCustomerMaster.JVPartnerStake = Convert.ToDecimal(txtJVPartnerStake.Text.Trim());
            ObjCustomerMaster.CEOName = txtCEOName.Text.Trim();
            if (!string.IsNullOrEmpty(txtCEOAge.Text.Trim())) ObjCustomerMaster.CEOAge = Convert.ToDecimal(txtCEOAge.Text.Trim());
            if (!string.IsNullOrEmpty(txtCEOexperience.Text.Trim())) ObjCustomerMaster.CEOExperienceInYears = Convert.ToDecimal(txtCEOexperience.Text.Trim());
            //if (!string.IsNullOrEmpty(txtCEOWeddingDate.Text.Trim())) ObjCustomerMaster.CEOWeddingDate = Utility.StringToDate(txtCEOWeddingDate.Text);
            //ObjCustomerMaster.ResidentialAddress = txtResidentialAddress.Text.Trim();


            string strXMLBankDetails = ((DataTable)ViewState["DetailsTable"]).FunPubFormXml(true);
            strXMLBankDetails = strXMLBankDetails.Replace("OWN_BRANCH_ID='-1'", "");
            strXMLBankDetails = strXMLBankDetails.Replace("BRANCH='&nbsp;'", "");
            strXMLBankDetails = strXMLBankDetails.Replace("OWN_BRANCH_ID='&nbsp;'", "");
            ObjCustomerMaster.XmlBankDetails = strXMLBankDetails;

            if (!string.IsNullOrEmpty(txtValidupto.Text.Trim())) ObjCustomerMaster.ValidUpto = Utility.StringToDate(txtValidupto.Text);
            ObjCustomerMaster.Created_By = intUserId;
            ObjCustomerMaster.Modified_By = intUserId;
            ObjCustomerMaster.Company_ID = intCompanyId;
            ObjCustomerMaster.Customer = chkCustomer.Checked;
            ObjCustomerMaster.Guarantor1 = chkGuarantor1.Checked;
            ObjCustomerMaster.Guarantor2 = chkGuarantor2.Checked;
            ObjCustomerMaster.CoApplicant = chkCoApplicant.Checked;
            ObjCustomerMaster.Customer_Group = chkGroupDet.Checked;
            ObjCustomerMaster.XmlConstitutionalDocuments = gvConstitutionalDocuments.FunPubFormXml(true);
            ObjCustomerMaster.CustomerCode = txtCustomercode.Text.Trim();
            ObjCustomerMaster.XmlSubLimitDetails = ((DataTable)ViewState["CUST_SUBLIMIT"]).FunPubFormXml();

            // Added By R. Manikandan CBO Related Chages
            //if (!string.IsNullOrEmpty(txtIdentityExpiredate.Text.Trim()))
            //    ObjCustomerMaster.ExprDate = Utility.StringToDate(txtIdentityExpiredate.Text.ToString()).ToString();

            //Added By Ganapathy on 13-Nov-2013 BEGINS

            if (Request.QueryString["IsFromEnquiry"] != null && Request.QueryString["EnquiryID"] != null)
            {
                ObjCustomerMaster.Enquiry_ID = Convert.ToInt32(Request.QueryString["EnquiryID"].ToString());
            }

            //Added By Ganapathy on 13-Nov-2013 ENDS


            //BCA Changes - Kuppu - Aug-17
            ObjCustomerMaster.Family_Name = txtFamilyName.Text.Trim(); //txtFamilyName.Text.Trim();
            ObjCustomerMaster.Notes = txtNotes.Text.Trim();
            ObjCustomerMaster.IS_BlockListed = chkBadTrack.Checked;
            //BDO Changes - Thangam M - 03-Oct-2012
            ObjCustomerMaster.CreditType = Convert.ToInt32(rbCreditType.SelectedValue);
            //End here
            // Created By : Anbuvel.T, Date : 18-MAY-2018, Description : Customer Master Changes Done.
            ObjCustomerMaster.Nationality = Convert.ToInt32(ddlNationality.SelectedValue);
            ObjCustomerMaster.Passport_Number = txtIdentityColumn.Text.Trim();
            ObjCustomerMaster.Passport_Issue_Date = Utility.StringToDate(txtIdentityIssueDate.Text.Trim());
            ObjCustomerMaster.Passport_Exp_Date = Utility.StringToDate(txtIdentityExpiredate.Text.Trim());
            if (((DataTable)ViewState["AddsDetailsTable"]).Rows.Count > 0)
            {
                ObjCustomerMaster.XmlAddressDetails = ((DataTable)ViewState["AddsDetailsTable"]).FunPubFormXml();
            }
            if (txtVisaNo.Text.Trim() != string.Empty)
            {
                ObjCustomerMaster.Visa_Number = txtVisaNo.Text.Trim();
            }
            if (hdnLocationID.Value != string.Empty)
                ObjCustomerMaster.Customer_Branch = Convert.ToInt32(hdnLocationID.Value);
            if (txtVisaNo.Text.Trim() != string.Empty)
                ObjCustomerMaster.Labour_Card_No = txtLabourCardNo.Text.Trim();
            if (txtLabourCardDate.Text.Trim() != string.Empty)
                ObjCustomerMaster.Labour_Card_Issue_Date = Utility.StringToDate(txtLabourCardDate.Text.Trim());
            if (txtLaborExpDate.Text.Trim() != string.Empty)
                ObjCustomerMaster.Labour_Card_Exp_Date = Utility.StringToDate(txtLaborExpDate.Text.Trim());
            if (cmbOccupation.SelectedIndex > 0)
            {
                ObjCustomerMaster.Occupation = Convert.ToInt32(cmbOccupation.SelectedValue);
            }
            if (rbnMFCEmpIndi.SelectedIndex > 0)
                ObjCustomerMaster.MFC_Employee_Indi = Convert.ToInt32(rbnMFCEmpIndi.SelectedValue);
            if (hdnMFCUserID.Value != string.Empty)
            {
                ObjCustomerMaster.MFC_Employee_ID = Convert.ToInt32(hdnMFCUserID.Value);
            }
            if (cmbEmployerName.SelectedIndex > 0)
            {
                ObjCustomerMaster.Employer_Name = Convert.ToInt32(cmbEmployerName.SelectedValue);
            }
            if (cmEmpEcoCode.SelectedIndex > 0)
            {
                ObjCustomerMaster.Employer_Eco_Act_Code = Convert.ToInt32(cmEmpEcoCode.SelectedValue);
            }
            if (txtEmployeeCode.Text.Trim() != string.Empty)
            {
                ObjCustomerMaster.Employee_Code = txtEmployeeCode.Text.Trim();
            }
            if (txtDepartmentName.Text.Trim() != string.Empty)
            {
                ObjCustomerMaster.Department_Name = txtDepartmentName.Text.Trim();
            }
            if (txtDesignation.Text.Trim() != string.Empty)
            {
                ObjCustomerMaster.Designation = txtDesignation.Text.Trim();
            }
            if (txtPlaceofWork.Text.Trim() != string.Empty)
            {
                ObjCustomerMaster.Place_of_Work = txtPlaceofWork.Text.Trim();
            }
            if (txtDateOfJoin.Text.Trim() != string.Empty)
            {
                ObjCustomerMaster.Date_Of_Join = Utility.StringToDate(txtDateOfJoin.Text.Trim());
            }
            if (txtMonBusIncome.Text.Trim() != string.Empty)
            {
                ObjCustomerMaster.Monthily_Income = Convert.ToDecimal(txtMonBusIncome.Text.Trim());
            }
            if (ddlVIP.SelectedIndex > 0)
            {
                ObjCustomerMaster.VIP_Customer = Convert.ToInt32(ddlVIP.SelectedValue);
            }
            if (txtFinancialrequired.Text.Trim() != string.Empty)
            {
                ObjCustomerMaster.Financial_required = Convert.ToDecimal(txtFinancialrequired.Text.Trim());
            }
            if (cmbFinancialReceived.SelectedIndex > -1)
            {
                ObjCustomerMaster.Financial_received = Convert.ToInt32(cmbFinancialReceived.SelectedValue);
            }
            if (txtOCCIIssueDate.Text.Trim() != string.Empty)
            {
                ObjCustomerMaster.OCCI_Issue_Date = Utility.StringToDate(txtOCCIIssueDate.Text.Trim());
            }
            if (txtOCCIExpiryDate.Text.Trim() != string.Empty)
            {
                ObjCustomerMaster.OCCI_Exp_Date = Utility.StringToDate(txtOCCIExpiryDate.Text.Trim());
            }
            if (rbnSeMemStatus.SelectedIndex > -1)
            {
                ObjCustomerMaster.Fac_Applicable = Convert.ToInt32(rbnSeMemStatus.SelectedValue);
            }
            if (cmbFactoringType.SelectedIndex > -1)
            {
                ObjCustomerMaster.Fac_Type = Convert.ToInt32(cmbFactoringType.SelectedValue);
            }
            if (txtFactoringLimit.Text.Trim() != string.Empty)
            {
                ObjCustomerMaster.Fac_Limit = Convert.ToDecimal(txtFactoringLimit.Text.Trim());
            }
            if (rbnCovenantApplicable.SelectedIndex > -1)
            {
                ObjCustomerMaster.Covenants_Applicable = Convert.ToInt32(rbnCovenantApplicable.SelectedValue);
            }
            if (txtCovenantClause.Text.Trim() != string.Empty)
            {
                ObjCustomerMaster.Covenants_Clause = txtCovenantClause.Text.Trim();
            }
            if (txtAssCollection.Text.Trim() != string.Empty)
            {
                ObjCustomerMaster.Assignment_Collection = Convert.ToDecimal(txtAssCollection.Text.Trim());
            }
            if (txtFacLimitExp.Text.Trim() != string.Empty)
            {
                ObjCustomerMaster.Fact_Limit_Exp_date = Utility.StringToDate(txtFacLimitExp.Text.Trim());
            }
            if (cmbIndustryType.SelectedIndex > -1)
            {
                ObjCustomerMaster.Customer_Industry = Convert.ToInt32(cmbIndustryType.SelectedValue);
            }
            if (rbnSenAppli.SelectedIndex > -1)
            {
                ObjCustomerMaster.Seni_Mem_Applicable = Convert.ToInt32(rbnSenAppli.SelectedValue);
            }
            if (rbnSenMemStatus.SelectedIndex > -1)
            {
                ObjCustomerMaster.Seni_Mem_Status = Convert.ToInt32(rbnSenMemStatus.SelectedValue);
            }
            if (rbnSenMemRelInd.SelectedIndex > -1)
            {
                ObjCustomerMaster.Seni_Mem_Rela_Indi = Convert.ToInt32(rbnSenMemRelInd.SelectedValue);
            }
            if (txtMaxLenLimit.Text.Trim() != string.Empty)
            {
                ObjCustomerMaster.Max_Lend_Amount = Convert.ToDecimal(txtMaxLenLimit.Text.Trim());
            }
            if (rbnRelaPartyind.SelectedIndex > -1)
            {
                ObjCustomerMaster.Related_Parti_Indi = Convert.ToInt32(rbnRelaPartyind.SelectedValue);
            }
            if (txtMaxLenLimiExpDate.Text.Trim() != string.Empty)
            {
                ObjCustomerMaster.Max_Lend_Limit_Exp = Utility.StringToDate(txtMaxLenLimiExpDate.Text.Trim());
            }
            if (ViewState["SharsDetails"] !=null && ((DataTable)ViewState["SharsDetails"]).Rows.Count > 0)
            {
                ObjCustomerMaster.XmlShareDetails = ((DataTable)ViewState["SharsDetails"]).FunPubFormXml();
            }
            if (!(ddlCustomerType.SelectedItem.ToString().ToLower() == "non individual"))
            {
                ObjCustomerMaster.CUSTOMER_NAME1 = txtFirstName.Text.Trim();
                ObjCustomerMaster.CUSTOMER_NAME2 = txtSecondName.Text.Trim();
                ObjCustomerMaster.CUSTOMER_NAME3 = txtThirdName.Text.Trim();
                ObjCustomerMaster.CUSTOMER_NAME4 = txtFourthName.Text.Trim();
                ObjCustomerMaster.CUSTOMER_NAME5 = txtFifthName.Text.Trim();
                ObjCustomerMaster.CUSTOMER_NAME6 = txtSixthName.Text.Trim();
                txtCustomerName.Text = txtFirstName.Text.Trim() + " " + txtSecondName.Text.Trim() + " " + txtThirdName.Text.Trim() + " " + txtFourthName.Text.Trim() + " " + txtFifthName.Text.Trim() + " " + txtSixthName.Text.Trim();
                ObjCustomerMaster.CustomerName = txtCustomerName.Text.Trim();
            }
            //aceMfcCode
            if (intCustomerId > 0)
            {
                ObjCustomerMaster.Mode = "Update";
                if (lblNoCustomerTrack.Visible)
                {
                    ObjCustomerMaster.XmlTrackDetails = "<Root></Root>";
                }
                else
                {
                    string strXML = gvTrack.FunPubFormXml(true);
                    strXML = strXML.Replace("RELEASEDBY='&nbsp;'", " ");
                    strXML = strXML.Replace("TYPE='-1'", " ");
                    strXML = strXML.Replace("RELEASEDATE=''", " ");
                    strXML = strXML.Replace("DATE=''", " ");
                    ObjCustomerMaster.XmlTrackDetails = strXML;
                }

            }
            else
            {
                ObjCustomerMaster.Mode = "Insert";
            }
            intErrorCode = objCustomerMasterClient.FunPubCreateCustomerInt(out strCustomerCode, ObjCustomerMaster);

            if (intErrorCode == 0)
            {
                //Added by Thangam M on 18/Oct/2012 to avoid double save click
                btnSave.Enabled = false;
                //End here
                FunProClearCaches();
                if (intCustomerId > 0)
                {
                    strAlert = strAlert.Replace("__ALERT__", "Customer details updated successfully");
                    ScriptManager.RegisterStartupScript(this, this.GetType(), strKey, strAlert + strRedirectPageView, true);
                }
                else
                {
                    string[] strCustomerDetails = strCustomerCode.Split('~');
                    txtCustomercode.Text = strCustomerDetails[1].ToString();
                    if (Request.QueryString["IsFromEnquiry"] != null || Request.QueryString["IsFromApplication"] != null)
                    {
                        string strCustomerAlert = "alert('Customer details added successfully');";
                        strCustomerAlert += "window.close();window.opener.location.reload();";
                        strRedirectPageView = "";
                        ScriptManager.RegisterStartupScript(this, this.GetType(), "Insert", strCustomerAlert, true);
                        Utility.store("EnqNewCustomerId", strCustomerDetails[0].ToString());
                        return;
                    }
                    else
                    {
                        strAlert = "Customer Code is " + txtCustomercode.Text;
                        strAlert += @"\n\nCustomer details added successfully";
                        strAlert += @"\n\nWould you like to add one more Customer?";
                        strAlert = "if(confirm('" + strAlert + "')){" + strRedirectPageAdd + "}else {" + strRedirectPageView + "}";
                        ScriptManager.RegisterStartupScript(this, this.GetType(), "Insert", strAlert, true);
                        strRedirectPageView = "";
                    }
                }
            }
            else if (intErrorCode == 85)
            {
                Utility.FunShowAlertMsg(this, "Already given Customer Code Exist");
            }
            else if (intErrorCode == -1)
            {
                Utility.FunShowAlertMsg(this.Page, Resources.LocalizationResources.DocNoNotDefined);
            }
            else if (intErrorCode == -2)
            {
                Utility.FunShowAlertMsg(this.Page, Resources.LocalizationResources.DocNoExceeds);
            }
            else if (intErrorCode == -3)
            {
                //Added by Tamilselvan.S on 2/11/2011 for Adding validation for DNC number length
                Utility.FunShowAlertMsg(this.Page, Resources.ValidationMsgs._3.ToString());
            }

            else
            {
                if (intCustomerId > 0)
                {
                    strAlert = strAlert.Replace("__ALERT__", "Error in updating Customer details");
                }
                else
                {
                    strAlert = strAlert.Replace("__ALERT__", "Error in adding Customer details");
                }
                strRedirectPageView = "";
                ScriptManager.RegisterStartupScript(this, this.GetType(), strKey, strAlert, true);
            }
        }
        catch (Exception ex)
        {
            throw ex;
        }
        finally
        {
            objCustomerMasterClient.Close();
        }
    }
    private bool FunPriValidateDuplicateConstitutionDocs(out string strConsDocName)
    {
        bool blnIsDuplicate = false;
        strConsDocName = "";
        try
        {
            Dictionary<string, string> Procparam = new Dictionary<string, string>();
            Procparam.Add("@Option", "309");
            Procparam.Add("@Param1", intCompanyId.ToString());
            DataSet dsConstitution = Utility.GetDataset("S3G_ORG_GetCustomerLookUp", Procparam);
            foreach (GridViewRow grDocs in gvConstitutionalDocuments.Rows)
            {
                string strID = grDocs.Cells[0].Text;
                string strDocumentFlag = grDocs.Cells[1].Text;
                string strDocName = grDocs.Cells[2].Text;
                TextBox txtValues = (TextBox)grDocs.FindControl("txtValues");
                if (txtValues != null && strDocumentFlag.ToUpper().StartsWith("CID"))
                {
                    if (txtValues.Text.Trim() != "")
                    {
                        string strCustomerCondition = "";
                        if (intCustomerId > 0)
                        {
                            strCustomerCondition = " and Customer_Id <> " + intCustomerId;
                        }
                        DataRow[] drDuplicateDoc = dsConstitution.Tables[0].Select("DocumentFlag = '" + strDocumentFlag + "' and Values = '" + txtValues.Text.ToUpper().Trim() + "'" + strCustomerCondition);
                        if (drDuplicateDoc.Length > 0)
                        {
                            strConsDocName += strDocName + ",";
                            blnIsDuplicate = true;
                        }
                    }
                }
            }
            //if (blnIsDuplicate)
            //{

            //}
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            throw new ApplicationException("Unable to Validate Duplicate Documents");
        }
        return blnIsDuplicate;
    }

    private bool FunPriValidateDeDuplicateCustomer(out string strConsDocName, out string strDeDupCustomerCode)
    {
        bool blnIsDuplicate = false;
        strConsDocName = "";
        strDeDupCustomerCode = "";
        try
        {
            Dictionary<string, string> Procparam = new Dictionary<string, string>();
            Procparam.Add("@CONSTITUTIONID", ddlConstitutionName.SelectedValue);
            Procparam.Add("@COMPANYID", intCompanyId.ToString());
            DataSet dsConstitution = Utility.GetDataset("S3G_ORG_GETDEDUPPARAMETER", Procparam);
            DataRow[] drDeDupField = dsConstitution.Tables[0].Select("DeDup_Field <> '' and IsRequired = 1");
            bool IsDuplicateCustomerName = false;
            bool IsDuplicateAddress1 = false;
            bool IsDuplicateAddress2 = false;

            if (drDeDupField.Length > 0)
            {
                foreach (DataRow drFieldName in drDeDupField)
                {
                    string strFieldName = drFieldName["DeDup_Field"].ToString();
                    dsConstitution.Tables[1].CaseSensitive = false;
                    if (strFieldName.ToUpper() == "CUSTOMER_NAME")
                    {
                        DataRow[] drDeDup = dsConstitution.Tables[1].Select("Customer_Name = '" + txtCustomerName.Text + "'");
                        if (drDeDup.Length > 0)
                        {
                            IsDuplicateCustomerName = true;
                            strConsDocName += "Customer Name,";
                        }
                    }
                    //if (strFieldName.ToUpper() == "COMM_ADDRESS1")
                    //{
                    //    DataRow[] drDeDup = dsConstitution.Tables[1].Select("Comm_Address1 = '" + txtComAddress1.Text + "'");
                    //    if (drDeDup.Length > 0)
                    //    {
                    //        IsDuplicateAddress1 = true;
                    //        strConsDocName += "Communication Address1,";
                    //    }
                    //}
                    //if (strFieldName.ToUpper() == "COMM_ADDRESS2")
                    //{
                    //    DataRow[] drDeDup = dsConstitution.Tables[1].Select("Comm_Address2 = '" + txtCOmAddress2.Text + "'");
                    //    if (drDeDup.Length > 0)
                    //    {
                    //        IsDuplicateAddress2 = true;
                    //        strConsDocName += "Communication Address2,";
                    //    }
                    //}
                }
            }
            foreach (GridViewRow grDocs in gvConstitutionalDocuments.Rows)
            {
                string strCategoryID = grDocs.Cells[9].Text;
                string strDocumentFlag = grDocs.Cells[1].Text;
                string strDocName = grDocs.Cells[2].Text;
                TextBox txtValues = (TextBox)grDocs.FindControl("txtValues");
                if (txtValues != null)
                {
                    if (txtValues.Text.Trim() != "")
                    {
                        DataRow[] drDuplicateDoc = dsConstitution.Tables[0].Select("CONSDOCUMENTCATEGORY_ID = '" + strCategoryID + "' and Document_Value = '" + txtValues.Text.ToUpper().Trim() + "'");
                        if (drDuplicateDoc.Length > 0)
                        {
                            strConsDocName += strDocName + ",";
                            blnIsDuplicate = true;
                            foreach (DataRow dr in drDuplicateDoc)
                            {
                                if (!strDeDupCustomerCode.Contains(dr["CustomerCode"].ToString()))
                                {
                                    strDeDupCustomerCode += dr["CustomerCode"].ToString() + ",";
                                }

                            }
                        }
                    }
                }
            }
            if (IsDuplicateAddress1 || IsDuplicateAddress2 || IsDuplicateCustomerName || blnIsDuplicate)
            {
                blnIsDuplicate = true;
            }

        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            throw new ApplicationException("Unable to Validate Duplicate Documents");
        }
        return blnIsDuplicate;
    }

    /// <summary>
    /// Event for Clear the Controls
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    protected void btnClear_Click(object sender, EventArgs e)
    {
        try
        {
            txtGroupCode.Text = txtCustomerName.Text =
                //txtComAddress1.Text = txtPerAddress1.Text = txtCOmAddress2.Text = txtPerAddress2.Text = txtComPincode.Text = txtPerPincode.Text =
                //txtComMobile.Text = txtPerMobile.Text = txtComTelephone.Text = txtPerTelephone.Text = txtComEmail.Text = txtPerEmail.Text =
                //txtComWebsite.Text = txtPerWebSite.Text = 
           txtDOB.Text = txtAge.Text = txtQualification.Text = txtProfession.Text =
           txtSpouseName.Text = txtChildren.Text = txtTotalDependents.Text = txtWeddingdate.Text = txtCurrentMarketValue.Text
           = txtRemainingLoanValue.Text = txtTotNetWorth.Text = txtDirectors.Text = txtSE.Text = txtPaidCapital.Text = txtfacevalue.Text
           = txtbookvalue.Text = txtBusinessProfile.Text = txtGeographical.Text = txtnobranch.Text = txtPercentageStake.Text =
           txtJVPartnerName.Text = txtJVPartnerStake.Text = txtCEOName.Text = txtCEOAge.Text = txtCEOexperience.Text =
                //txtResidentialAddress.Text = txtCEOWeddingDate.Text =
           txtAccountNumber.Text = txtBankName.Text = txtBankBranch.Text =
           txtMICRCode.Text = txtBankAddress.Text = txtIdentityExpiredate.Text = txtIdentityIssueDate.Text =
           txtLOBName.Text = txtValidupto.Text = txtUtilizedAmt.Text
           = txtFacilityType.Text = txtCustomercode.Text = string.Empty;

            //txtComCity.SelectedValue = txtPerCity.SelectedValue =
            cmbIndustryCode.SelectedValue = "0";
            //<<Performance>>
            //txtComCity.Items.Insert(0, "");
            //txtComCity.Clear();
            //txtPerCity.Items.Insert(0, "");
            //txtPerCity.Clear();
            //txtComState.Items.Insert(0, "");
            //txtPerState.Items.Insert(0, "");

            //txtComCountry.Items.Insert(0, "");
            //txtPerCountry.Items.Insert(0, "");
            //txtComCountry.SelectedIndex = txtPerCountry.SelectedIndex = -1;
            ////txtComCity.SelectedIndex = 
            ////txtPerCity.SelectedIndex =
            //txtComState.SelectedIndex = txtPerState.SelectedIndex = -1;

            if (ddlCustomerType.Items.Count > 0) ddlCustomerType.SelectedIndex = 0;
            if (ddlConstitutionName.Items.Count > 0) ddlConstitutionName.SelectedIndex = 0;
            if (ddlTitle.Items.Count > 0) ddlTitle.SelectedIndex = 0;
            if (ddlPostingGroup.Items.Count > 0) ddlPostingGroup.SelectedIndex = 0;
            if (ddlGender.Items.Count > 0) ddlGender.SelectedIndex = 0;
            if (ddlMaritalStatus.Items.Count > 0) ddlMaritalStatus.SelectedIndex = 0;
            if (ddlHouseType.Items.Count > 0) ddlHouseType.SelectedIndex = 0;
            //if (ddlOwn.Items.Count > 0) ddlOwn.SelectedIndex = 0;
            if (cmbPublic.Items.Count > 0) cmbPublic.SelectedIndex = 0;
            if (ddlGovernment.Items.Count > 0) ddlGovernment.SelectedIndex = 0;

            chkCoApplicant.Checked = chkCustomer.Checked = chkGuarantor1.Checked = chkGuarantor2.Checked = false;

            if (ddlAccountType.Items.Count > 0) ddlAccountType.SelectedIndex = 0;

            hdnGroupCode.Value = string.Empty;
            cmbIndustryCode.SelectedValue = "0";
            txtGroupCode.Text = string.Empty;
            cmbIndustryCode.SelectedItem.Text = string.Empty;
            cmbsub.SelectedItem.Text = string.Empty;
            gvConstitutionalDocuments.Dispose();
            gvConstitutionalDocuments.DataSource = null;
            gvConstitutionalDocuments.DataBind();

            txtCustomerName.Enabled = true;

            tcCustomerMaster.ActiveTab = tbAddress;
        }
        catch (Exception objException)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(objException, strPageName);
            cvCustomerMaster.ErrorMessage = Resources.LocalizationResources.ClearError;
            cvCustomerMaster.IsValid = false;

        }
    }

    /// <summary>
    /// Event for Cancel the Process
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    protected void btnCancel_Click(object sender, EventArgs e)
    {
        try
        {
            FunProClearCaches();
            if (Request.QueryString["IsFromEnquiry"] != null)
            {
                strAlert = "window.close();";
                //window.opener.location.reload();"; for bug in Pricing Commented on 15/02/2011 by Nataraj
                ScriptManager.RegisterStartupScript(this, this.GetType(), "Insert", strAlert, true);
            }
            else if (Request.QueryString["IsFromApplication"] != null)
            {
                strAlert = "window.close();";
                ScriptManager.RegisterStartupScript(this, this.GetType(), "Insert", strAlert, true);
            }
            else if (Request.QueryString["IsFromAssignment"] != null)
            {
                //strAlert = "window.close();";
                ScriptManager.RegisterStartupScript(this, this.GetType(), "Insert", "window.close();", true);
            }
            else
            {
                Response.Redirect("~/Origination/S3gOrgCustomerMaster_View.aspx");
            }
        }
        catch (Exception objException)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(objException, strPageName);
            cvCustomerMaster.ErrorMessage = Resources.LocalizationResources.CancelError;
            cvCustomerMaster.IsValid = false;
        }
    }
    #endregion

    #region Local Methods



    #region GetCompletionList
    /// <summary>
    /// GetCompletionList
    /// </summary>
    /// <param name="prefixText">search text</param>
    /// <param name="count">no of matches to display</param>
    /// <returns>string[] of matching names</returns>
    [System.Web.Services.WebMethod]
    public static string[] GetCompletionList(String prefixText, int count)
    {
        Dictionary<string, string> Procparam;
        Procparam = new Dictionary<string, string>();
        List<String> suggetions = new List<String>();
        DataTable dtCommon = new DataTable();
        DataSet Ds = new DataSet();

        Procparam.Clear();
        Procparam.Add("@Company_ID", obj_Page.intCompanyId.ToString());
        Procparam.Add("@Option", "3"); 
        //if (Convert.ToInt32(obj_Page.intUserId) > 0)
        //{
        //    Procparam.Add("@User_ID", obj_Page.intUserId.ToString());
        //}
        //Procparam.Add("@Program_Id", "45");        
        //Procparam.Add("@Is_Active", "1");
        Procparam.Add("@Prefixtext", prefixText);
        suggetions = Utility.GetSuggestions(Utility.GetDefaultData("S3G_OR_GET_CUSTOTHERS_DTLS", Procparam));
        return suggetions.ToArray();

        //DataTable dt1 = new DataTable();

        //dt1 = (DataTable)HttpContext.Current.Session["GroupDT"];

        //List<String> suggetions = GetSuggestions(prefixText, count, dt1);


        //return suggetions.ToArray();
    }

    //[System.Web.Services.WebMethod]
    //public static string[] GetIndustryList(String prefixText, int count)
    //{
    //    DataTable dt1 = new DataTable();

    //    dt1 = (DataTable)HttpContext.Current.Session["IndustryDT"];

    //    List<String> suggetions = GetSuggestions(prefixText, count, dt1);


    //    return suggetions.ToArray();
    //}

    //#endregion


    #region GetSuggestions
    /// <summary>
    /// GetSuggestions
    /// </summary>
    /// <param name="key">Country Names to search</param>
    /// <returns>Country Names Similar to key</returns>
    private static List<String> GetSuggestions(string key, int count, DataTable dt1)
    {
        List<String> suggestions = new List<string>();
        try
        {

            //DataTable dt1 = new DataTable();

            //dt1 = (DataTable)HttpContext.Current.Session["GroupDT"];// objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus);

            string filterExpression = "value like '" + key + "%'";
            DataRow[] dtSuggestions = dt1.Select(filterExpression);

            foreach (DataRow dr in dtSuggestions)
            {
                string suggestion = dr["value"].ToString();
                suggestions.Add(suggestion);
            }

        }
        catch (Exception objException)
        {
            return suggestions;
            ClsPubCommErrorLogDB.CustomErrorRoutine(objException, strPageName);
            //   lblErrorMessage.Text = Resources.LocalizationResources.CustomerTypeChangeError;
        }

        return suggestions;
    }
    #endregion


    /// <summary>
    /// Load the Master data in Dropdownlist
    /// </summary>
    private void FunPriLoadMasterData()
    {
        OrgMasterMgtServicesReference.OrgMasterMgtServicesClient objCustomerMasterClient = new OrgMasterMgtServicesReference.OrgMasterMgtServicesClient();
        try
        {

            S3GBusEntity.S3G_Status_Parameters ObjStatus = new S3G_Status_Parameters();
            ObjStatus.Option = 1;
            ObjStatus.Param1 = S3G_Statu_Lookup.CUSTOMER_TYPE.ToString();
            Utility.FillDLL(ddlCustomerType, objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus));
            //ddlCustomerType.SelectedIndex = 2;
            //ddlCustomerType.ClearDropDownList();

            ObjStatus.Param1 = S3G_Statu_Lookup.HOUSE_TYPE.ToString();
            Utility.FillDLL(ddlHouseType, objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus));

            //ObjStatus.Param1 = S3G_Statu_Lookup.COMPANY_TYPE.ToString();
            //Utility.FillDLL(cmbPublic, objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus));

            Dictionary<string, string> Procparam = new Dictionary<string, string>();
            Procparam.Add("@Option", "1");
            Procparam.Add("@Param1", "COMPANY_TYPE");
            cmbPublic.BindDataTable("S3G_OR_Get_CustLookUp", Procparam, true, "--Select--", new string[] { "ID", "Name" });

            ObjStatus.Param1 = S3G_Statu_Lookup.GOVERNMENT.ToString();
            Utility.FillDLL(ddlGovernment, objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus));

            ObjStatus.Param1 = S3G_Statu_Lookup.MARITAL_STATUS.ToString();
            Utility.FillDLL(ddlMaritalStatus, objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus));

            ObjStatus.Param1 = S3G_Statu_Lookup.ACCOUNT_TYPE.ToString();
            Utility.FillDLL(ddlAccountType, objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus));

            ObjStatus.Param1 = "TITLE";
            Utility.FillDLL(ddlTitle, objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus));

            

            ObjStatus.Option = 3;
            ObjStatus.Param1 = intCompanyId.ToString();
            ObjStatus.Param2 = intCustomerId.ToString();
            Utility.FillDLL(ddlPostingGroup, objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus));

            //ObjStatus.Option = 4;
            //ObjStatus.Param1 = intCompanyId.ToString();
            //ObjStatus.Param2 = intUserId.ToString();
            //Utility.FillDLL(ddlBranchList, objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus));

            ObjStatus.Option = 8;
            ObjStatus.Param1 = "GROUP";
            ObjStatus.Param2 = intCompanyId.ToString();
            DataTable dt = new DataTable();
            dt = objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus);
            System.Web.HttpContext.Current.Session["GroupDT"] = dt;


            //ObjStatus.Option = 8;
            //ObjStatus.Param1 = "INDUSTRY";
            //ObjStatus.Param2 = intCompanyId.ToString();
            //DataTable Indusdt = new DataTable();
            //Indusdt = objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus);
            //System.Web.HttpContext.Current.Session["IndustryDT"] = Indusdt;
            FunGetIndustryCode();

        }
        catch (Exception objException)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(objException, strPageName);
            throw objException;
        }
        finally
        {
            objCustomerMasterClient.Close();
        }
    }
    private void ConstitutionBind()
    {
        Dictionary<string, string> Procparam = new Dictionary<string, string>();
        Procparam.Add("@Option", "2");
        Procparam.Add("@Param1", Convert.ToString(intCompanyId));
        Procparam.Add("@Param3", ddlCustomerType.SelectedValue);
        ddlConstitutionName.BindDataTable("S3G_OR_Get_CustLookUp", Procparam, true, "--Select--", new string[] { "Constitution_ID", "ConstitutionName" });
        //ObjStatus.Option = 2;
        //ObjStatus.Param1 = intCompanyId.ToString();
        //Utility.FillDLL(ddlConstitutionName, objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus));
    }
    /*
    private void FunPriLoadRelationType()
    {
        try
        {
            if (Procparam != null)
                Procparam.Clear();
            else
                Procparam = new Dictionary<string, string>();

            Procparam.Add("@Company_ID", intCompanyId.ToString());
            DataTable dt = new DataTable();
            dt = Utility.GetDefaultData("S3G_ORG_GetRelationType", Procparam);
            GrvRelation.DataSource = dt;
            GrvRelation.DataBind();
        }
        catch (Exception objException)
        {
              ClsPubCommErrorLogDB.CustomErrorRoutine(objException, strPageName);
            throw objException;
        }
    }
     */

    /// <summary>
    /// Toggle the Tabs for LoanAdmin Checking
    /// </summary>
    /// <param name="blnIsEnabled"></param>
    private void FunPriToggleLoanAdminControls(bool blnIsEnabled)
    {
        try
        {
            tcCustomerMaster.Tabs[4].Enabled = blnIsEnabled;
            tcCustomerMaster.Tabs[5].Enabled = blnIsEnabled;
        }
        catch (Exception objException)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(objException, strPageName);
            throw new ApplicationException("Unable to Toggle Customer Track/Credit Details");
        }
    }

    /// <summary>
    /// Toggle the Controls for CustomerType(Individual/NonIndividual)
    /// </summary>
    private void FunPriToggleCustomerTypeControls()
    {
        try
        {
            if (Convert.ToInt16(ddlCustomerType.SelectedValue) > 0)
            {
                if (ddlCustomerType.SelectedItem.Text.ToUpper() == "INDIVIDUAL")
                {
                    PriFunToggleCustomerTypeControls(false);
                    cmbPublic.SelectedIndex = ddlGovernment.SelectedIndex = 0;
                    txtDirectors.Text = txtSE.Text = txtPaidCapital.Text = txtfacevalue.Text =
                    txtbookvalue.Text = txtBusinessProfile.Text = txtGeographical.Text =
                    txtnobranch.Text = txtPercentageStake.Text = txtJVPartnerName.Text =
                    txtJVPartnerStake.Text = txtCEOName.Text = txtCEOAge.Text =
                    txtCEOexperience.Text = //txtResidentialAddress.Text =
                        //txtCEOWeddingDate.Text = 
                    string.Empty;

                    //lblComEmail.CssClass = lblPerEmail.CssClass = "styleDisplayLabel";
                    lblIndustryCode.CssClass =
                        //lblIndustryName.CssClass =
                    lblPublic.CssClass =
                        //lblCEO.CssClass = lblDirectors.CssClass = lblGeographical.CssClass =
                        //lblCEOAge.CssClass = lblCEOexperience.CssClass = lblResidentialAddress.CssClass = lblnobranch.CssClass =
                        //lblBusinessProfile.CssClass = 
                    "styleDisplayLabel";
                    lblGender.CssClass = lblDOB.CssClass =
                        //lblQualification.CssClass = lblProfession.CssClass =
                        //lblHouseType.CssClass = lblOwn.CssClass =
                    "styleReqFieldLabel";
                }
                else
                {
                    PriFunToggleCustomerTypeControls(true);
                    txtDOB.Text = txtAge.Text = txtQualification.Text =
                    txtProfession.Text = txtSpouseName.Text = txtChildren.Text =
                    txtTotalDependents.Text = txtTotNetWorth.Text = txtRemainingLoanValue.Text =
                    txtWeddingdate.Text = string.Empty;
                    //frvCurrentMarketValue.Enabled = false;
                    //lblComEmail.CssClass = lblPerEmail.CssClass = "styleDisplayLabel";
                    // lblIndustryCode.CssClass =
                    //lblIndustryName.CssClass =
                    //  lblPublic.CssClass =
                    //lblCEO.CssClass = lblDirectors.CssClass = lblGeographical.CssClass = lblnobranch.CssClass =
                    //lblCEOAge.CssClass = lblCEOexperience.CssClass = lblResidentialAddress.CssClass =
                    //lblBusinessProfile.CssClass =
                    //  "styleReqFieldLabel";
                    lblGender.CssClass = lblDOB.CssClass =
                        //    lblQualification.CssClass = lblProfession.CssClass =
                        //lblHouseType.CssClass = lblOwn.CssClass =
                    "styleDisplayLabel";
                    ddlMaritalStatus.SelectedIndex = ddlHouseType.SelectedIndex = 0;//ddlOwn.SelectedIndex =
                    ddlGender.SelectedIndex = 0;

                }
            }
        }
        catch (Exception objException)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(objException, strPageName);
            throw new ApplicationException("Due to Data Problem,Unable to Toggle Controls for Customer Type");
        }
    }


    /// <summary>
    /// Toggle the Controls for CustomerType(Individual/NonIndividual)
    /// </summary>
    /// <param name="blnIsEnabled"></param>
    private void PriFunToggleCustomerTypeControls(bool blnIsEnabled)
    {
        try
        {

            //Toggle the Controls for IndividualCustomerType
            pnlNonIndividual.Enabled = cmbPublic.Enabled = txtDirectors.Enabled = blnIsEnabled;
            txtSE.Enabled = txtPaidCapital.Enabled = txtfacevalue.Enabled = txtbookvalue.Enabled = blnIsEnabled;
            txtBusinessProfile.Enabled = txtGeographical.Enabled = txtnobranch.Enabled = ddlGovernment.Enabled = blnIsEnabled;
            txtPercentageStake.Enabled = txtJVPartnerName.Enabled = txtJVPartnerStake.Enabled = txtCEOName.Enabled = blnIsEnabled;
            txtCEOAge.Enabled = txtCEOexperience.Enabled = blnIsEnabled;//txtResidentialAddress.Enabled =
            //txtCEOWeddingDate.Enabled = CalendarCEOWeddingDate.Enabled = blnIsEnabled= 

            rfvPublic.Enabled = blnIsEnabled;
            //rfvDirectors.Enabled = rfvBusinessProfile.Enabled = rfvGeographical.Enabled = rfvnobranch.Enabled = blnIsEnabled rfvIndustryName.Enabled =;
            //rfvCEOName.Enabled = rfvCEOAge.Enabled = rfvCEOexperience.Enabled = rfvResidentialAddress.Enabled = blnIsEnabled rfvIndustryCode.Enabled;


            //Toggle the Controls for NonIndividualCustomerType
            pnlIndividual.Enabled = ddlGender.Enabled = txtDOB.Enabled = CalendarExtenderSD.Enabled = !blnIsEnabled;
            txtAge.Enabled = ddlMaritalStatus.Enabled = txtQualification.Enabled = txtProfession.Enabled = !blnIsEnabled;
            //txtSpouseName.Enabled = txtChildren.Enabled = ddlHouseType.Enabled = ddlOwn.Enabled = txtTotalDependents.Enabled = !blnIsEnabled;
            txtSpouseName.Enabled = txtChildren.Enabled = ddlHouseType.Enabled //= ddlOwn.Enabled 
                = !blnIsEnabled;
            //txtTotNetWorth.Enabled = txtRemainingLoanValue.Enabled = txtWeddingdate.Enabled = CalendarWeddingdate.Enabled = !blnIsEnabled;
            txtWeddingdate.Enabled = CalendarWeddingdate.Enabled = !blnIsEnabled;
            // rfvGender.Enabled = rfvDOB.Enabled = !blnIsEnabled;
            //rfvHouseType.Enabled = rfvOwn.Enabled = rfvQualification.Enabled = rfvtxtProfession.Enabled =                !blnIsEnabled;
            //Common for BothCustomerTypes rfvIndustryCode.Enabled = rfvIndustryName.Enabled = 
            // rfvComEmail.Enabled = rfvPerEmail.Enabled =
            //revPerEmail.Enabled = revEmailId.Enabled = blnIsEnabled;

        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            throw new ApplicationException("Unable to Toggle Customer Type Controls");
        }
    }


    /// <summary>
    /// method for default settings for all controls
    /// </summary>
    private void FunPriSetControlSettings()
    {
        try
        {
            //lblCustomercode.Text = Resources.LocalizationResources.ORG_CUST_lblCustomercode;
            //lblCustomerType.Text = Resources.LocalizationResources.ORG_CUST_lblCustomerType;
            //lblgroupcode.Text = Resources.LocalizationResources.ORG_CUST_lblgroupcode;
            //lblGroupName.Text = Resources.LocalizationResources.ORG_CUST_lblGroupName;
            //lblIndustryCode.Text = Resources.LocalizationResources.ORG_CUST_lblIndustryCode;
            //lblIndustryName.Text = Resources.LocalizationResources.ORG_CUST_lblIndustryName;
            //lblConstitutionName.Text = Resources.LocalizationResources.ORG_CUST_lblConstitutionName;
            //lblTitle.Text = Resources.LocalizationResources.ORG_CUST_lblTitle;
            //lblCustomerName.Text = Resources.LocalizationResources.ORG_CUST_lblCustomerName;
            //lblCustomerPostingGroup.Text = Resources.LocalizationResources.ORG_CUST_lblCustomerPostingGroup;

            //lblComAddress1.Text = Resources.LocalizationResources.ORG_CUST_lblComAddress1;
            //lblPerAddress1.Text = Resources.LocalizationResources.ORG_CUST_lblPerAddress1;
            //lblComAddress2.Text = Resources.LocalizationResources.ORG_CUST_lblComAddress2;
            //lblPerAddress2.Text = Resources.LocalizationResources.ORG_CUST_lblPerAddress2;
            //lblComcity.Text = Resources.LocalizationResources.ORG_CUST_lblComcity;
            //lblPerCity.Text = Resources.LocalizationResources.ORG_CUST_lblPerCity;
            //lblComState.Text = Resources.LocalizationResources.ORG_CUST_lblComState;
            //lblPerState.Text = Resources.LocalizationResources.ORG_CUST_lblPerState;
            //lblComCountry.Text = Resources.LocalizationResources.ORG_CUST_lblComCountry;
            //lblPerCountry.Text = Resources.LocalizationResources.ORG_CUST_lblPerCountry;
            //lblCompincode.Text = Resources.LocalizationResources.ORG_CUST_lblCompincode;
            //lblPerpincode.Text = Resources.LocalizationResources.ORG_CUST_lblPerpincode;
            //lblComMobile.Text = Resources.LocalizationResources.ORG_CUST_lblComMobile;
            //lblPerMobile.Text = Resources.LocalizationResources.ORG_CUST_lblPerMobile;
            //lblComTelephone.Text = Resources.LocalizationResources.ORG_CUST_lblComTelephone;
            //lblPerTelephone.Text = Resources.LocalizationResources.ORG_CUST_lblPerTelephone;
            //lblComEmail.Text = Resources.LocalizationResources.ORG_CUST_lblComEmail;
            //lblPerEmail.Text = Resources.LocalizationResources.ORG_CUST_lblPerEmail;
            //lblComWebSite.Text = Resources.LocalizationResources.ORG_CUST_lblComWebSite;
            //lblPerWebSite.Text = Resources.LocalizationResources.ORG_CUST_lblPerWebSite;

            //lblGender.Text = Resources.LocalizationResources.ORG_CUST_lblGender;
            //lblDOB.Text = Resources.LocalizationResources.ORG_CUST_lblDOB;
            //lblAge.Text = Resources.LocalizationResources.ORG_CUST_lblAge;
            //lblMaritalStatus.Text = Resources.LocalizationResources.ORG_CUST_lblMaritalStatus;
            //lblQualification.Text = Resources.LocalizationResources.ORG_CUST_lblQualification;
            //lblProfession.Text = Resources.LocalizationResources.ORG_CUST_lblProfession;
            //lblSpouseName.Text = Resources.LocalizationResources.ORG_CUST_lblSpouseName;
            //lblChildren.Text = Resources.LocalizationResources.ORG_CUST_lblChildren;
            //lblTotalDependents.Text = Resources.LocalizationResources.ORG_CUST_lblTotalDependents;
            //lblWeddingdate.Text = Resources.LocalizationResources.ORG_CUST_lblWeddingdate;
            //lblHouseType.Text = Resources.LocalizationResources.ORG_CUST_lblHouseType;
            //lblOwn.Text = Resources.LocalizationResources.ORG_CUST_lblOwn;
            //lblCurrentMarketValue.Text = Resources.LocalizationResources.ORG_CUST_lblCurrentMarketValue;
            //lblRemainingLoanValue.Text = Resources.LocalizationResources.ORG_CUST_lblRemainingLoanValue;
            //lblTotNetWorth.Text = Resources.LocalizationResources.ORG_CUST_lblTotNetWorth;

            //lblPublic.Text = Resources.LocalizationResources.ORG_CUST_lblPublic;
            //lblDirectors.Text = Resources.LocalizationResources.ORG_CUST_lblDirectors;
            //lblStockExchange.Text = Resources.LocalizationResources.ORG_CUST_lblStockExchange;
            //lblPaidCapital.Text = Resources.LocalizationResources.ORG_CUST_lblPaidCapital;
            //lblfacevalue.Text = Resources.LocalizationResources.ORG_CUST_lblfacevalue;
            //lblbookvalue.Text = Resources.LocalizationResources.ORG_CUST_lblbookvalue;
            //lblBusinessProfile.Text = Resources.LocalizationResources.ORG_CUST_lblBusinessProfile;
            //lblGeographical.Text = Resources.LocalizationResources.ORG_CUST_lblGeographical;
            //lblnobranch.Text = Resources.LocalizationResources.ORG_CUST_lblnobranch;
            //lblGovernment.Text = Resources.LocalizationResources.ORG_CUST_lblGovernment;
            //lblStake.Text = Resources.LocalizationResources.ORG_CUST_lblStake;
            //lblJVPartnerName.Text = Resources.LocalizationResources.ORG_CUST_lblJVPartnerName;
            //lblJVPartnerStake.Text = Resources.LocalizationResources.ORG_CUST_lblJVPartnerStake;
            //lblCEO.Text = Resources.LocalizationResources.ORG_CUST_lblCEO;
            //lblCEOAge.Text = Resources.LocalizationResources.ORG_CUST_lblCEOAge;
            //lblCEOexperience.Text = Resources.LocalizationResources.ORG_CUST_lblCEOexperience;
            //lblResidentialAddress.Text = Resources.LocalizationResources.ORG_CUST_lblResidentialAddress;
            //lblCEOWeddingDate.Text = Resources.LocalizationResources.ORG_CUST_lblCEOWeddingDate;

            //lblAccountType.Text = Resources.LocalizationResources.ORG_CUST_lblAccountType;
            //lblAccountNumber.Text = Resources.LocalizationResources.ORG_CUST_lblAccountNumber;
            //lblBankName.Text = Resources.LocalizationResources.ORG_CUST_lblBankName;
            //lblBankBranch.Text = Resources.LocalizationResources.ORG_CUST_lblBankBranch;
            //lblMICRCode.Text = Resources.LocalizationResources.ORG_CUST_lblMICRCode;
            //lblBankAddress.Text = Resources.LocalizationResources.ORG_CUST_lblBankAddress;

            //lblLOBName.Text = Resources.LocalizationResources.ORG_CUST_lblLOBName;
            //lblProductGroup.Text = Resources.LocalizationResources.ORG_CUST_lblProductGroup;
            //lblSanctionamt.Text = Resources.LocalizationResources.ORG_CUST_lblSanctionamt;
            //lblValid.Text = Resources.LocalizationResources.ORG_CUST_lblValid;
            //lblUtilizedAmt.Text = Resources.LocalizationResources.ORG_CUST_lblUtilizedAmt;
            //lblFacilityType.Text = Resources.LocalizationResources.ORG_CUST_lblFacilityType;
            //lblHeading.Text = Resources.LocalizationResources.ORG_CUST_lblHeading;

            //btnSave.Text = Resources.LocalizationResources.ORG_CUST_btnSave;
            //btnClear.Text = Resources.LocalizationResources.ORG_CUST_btnClear;



            rfvCustomerType.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvCustomerType;
            rfvConstitutionName.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvConstitutionName;
            rfvTitle.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvTitle;
            //rfvComAddress1.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvComAddress1;
            //rfvtxtPerAddress1.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvtxtPerAddress1;
            ////<<Performance>>
            ////rfvComCity.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvComCity;
            ////txtComCity.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvComCity;
            ////rfvPerCity.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvPerCity;
            ////txtPerCity.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvPerCity;
            //rfvComState.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvComState;
            //rfvPerState.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvPerState;
            //rfvComCountry.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvComCountry;
            //rfvPerCountry.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvPerCountry;
            ////rfvComPincode.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvComPincode;
            ////rvfPerPincode.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rvfPerPincode;
            //rfvComTelephone.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvComTelephone;
            //rfvPerTelephone.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvPerTelephone;
            ////rfvComEmail.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvComEmail;
            //revEmailId.ErrorMessage = Resources.LocalizationResources.ORG_CUST_revEmailId;
            ////rfvPerEmail.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvPerEmail;
            //revPerEmail.ErrorMessage = Resources.LocalizationResources.ORG_CUST_revPerEmail;
            //revComWebsite.ErrorMessage = Resources.LocalizationResources.ORG_CUST_revComWebsite;

            //revPerWebSite.ErrorMessage = Resources.LocalizationResources.ORG_CUST_revPerWebSite;
            //rfvGender.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvGender;
            //rfvDOB.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvDOB;
            //rfvQualification.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvQualification;
            //rfvtxtProfession.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvtxtProfession;
            //rfvHouseType.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvHouseType;
            //rfvOwn.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvOwn;
            //rfvtotalnetworth.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvtotalnetworth;
            rfvPublic.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvPublic;
            //rfvDirectors.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvDirectors;
            //rfvBusinessProfile.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvBusinessProfile;
            //rfvGeographical.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvGeographical;
            //rfvnobranch.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvnobranch;
            //rfvCEOName.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvCEOName;
            //rfvCEOAge.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvCEOAge;
            //rfvCEOexperience.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvCEOexperience;
            //rfvResidentialAddress.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvResidentialAddress;

            rfvAccountType.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvAccountType;
            rfvAccountNumber.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvAccountNumber;
            rfvBankName.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvBankName;
            rfvBankBranch.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvBankBranch;
            //rfvMICRCode.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvMICRCode;
            rfvBankAddress.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rfvBankAddress;

            rvfCustomerName.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rvfCustomerName;

            rvfCustomerName.ErrorMessage = Resources.LocalizationResources.ORG_CUST_rvfCustomerName;


        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            throw new ApplicationException("Unable to Initialise the Controls");
        }
    }

    /// <summary>
    /// Method for Loading the Constitutional Documents
    /// </summary>
    /// <param name="CustomerID"></param>
    private void FunPriLoadCustomerConstitutionDocs(int CustomerID)
    {
        OrgMasterMgtServicesReference.OrgMasterMgtServicesClient objCustomerMasterClient = new OrgMasterMgtServicesReference.OrgMasterMgtServicesClient();
        try
        {
            S3GBusEntity.S3G_Status_Parameters ObjStatus = new S3G_Status_Parameters();
            ObjStatus.Option = 169;
            ObjStatus.Param1 = CustomerID.ToString();
            gvConstitutionalDocuments.DataSource = objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus);
            gvConstitutionalDocuments.DataBind();

            //Added By Thangam M on 12/Mar/2012 to fix bug id - 5451
            ScriptManager.RegisterStartupScript(this, this.GetType(), "Clear", "javascript:fnClearAsyncUploader('" + gvConstitutionalDocuments.Rows.Count.ToString() + "');", true);

            ViewState["ConstitutionDocument"] = objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus);
            ObjStatus.Option = 787;
            ObjStatus.Param1 = intCompanyId.ToString();
            DataTable dtConsDocPath = objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus);
            if (dtConsDocPath == null || (dtConsDocPath != null && dtConsDocPath.Rows.Count == 0))
            {
                Utility.FunShowAlertMsg(this, "Define the spooling path in Document Path Setup for Consitution Document");
                return;
            }
            ViewState["ConsDocPath"] = dtConsDocPath.Rows[0][0].ToString();
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            throw new ApplicationException("Due to Data Problem, Unable to Load the Constitution Documents");
        }
        finally
        {
            objCustomerMasterClient.Close();
        }
    }
    protected void hlnkView_Click(object sender, EventArgs e)
    {
        try
        {
            FunPriShowPRDD(sender);
        }
        catch (Exception ex)
        {
            cvCustomerMaster.ErrorMessage = ex.Message;
            cvCustomerMaster.IsValid = false;
        }
    }
    private void FunPriShowPRDD(object sender)
    {
        try
        {
            string strFieldAtt = ((LinkButton)sender).ClientID;
            int gRowIndex = Utility.FunPubGetGridRowID("gvConstitutionalDocuments", strFieldAtt);
            //Label lblPath = gvConstitutionalDocuments.Rows[gRowIndex].FindControl("myThrobber") as Label;
            Label lblActualPath = gvConstitutionalDocuments.Rows[gRowIndex].FindControl("lblActualPath") as Label;
            string strFileName = lblActualPath.Text.Replace("\\", "/").Trim();
            string strScipt = "window.open('../Common/S3GViewFile.aspx?qsFileName=" + strFileName + "', 'newwindow','toolbar=no,location=no,menubar=no,width=950,height=600,resizable=yes,scrollbars=yes,top=50,left=50');";
            ScriptManager.RegisterStartupScript(this, this.GetType(), strKey, strScipt, true);
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            throw new ApplicationException("Due to Data Problem, Unable to View the Document");
        }
    }
    private void FunPriLoadCustomerBankDetails(int CustomerID)
    {
        OrgMasterMgtServicesReference.OrgMasterMgtServicesClient objCustomerMasterClient = new OrgMasterMgtServicesReference.OrgMasterMgtServicesClient();
        try
        {
            S3GBusEntity.S3G_Status_Parameters ObjStatus = new S3G_Status_Parameters();
            ObjStatus.Option = 200;
            ObjStatus.Param1 = CustomerID.ToString();
            ViewState["DetailsTable"] = objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus);
            if (ViewState["DetailsTable"] != null)
            {
                grvBankDetails.DataSource = (DataTable)ViewState["DetailsTable"];
                grvBankDetails.DataBind();
                FunPriHideBankColumns();

            }
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            throw new ApplicationException("Due to Data Problem, Unable to Load Bank Details");
        }
        finally
        {
            objCustomerMasterClient.Close();
        }
    }

    private void FunPriLoadCustSubLimit(int CustomerID)
    {
        OrgMasterMgtServicesReference.OrgMasterMgtServicesClient objCustomerMasterClient = new OrgMasterMgtServicesReference.OrgMasterMgtServicesClient();
        try
        {
            DataTable dt = (DataTable)ViewState["CUST_SUBLIMIT"];
            DataTable dt1;
            S3GBusEntity.S3G_Status_Parameters ObjStatus = new S3G_Status_Parameters();
            ObjStatus.Option = 2000;
            ObjStatus.Param1 = CustomerID.ToString();

            dt1 = objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus);
            if (dt1.Rows.Count > 0)
            {
                dt.Merge(dt1, true, MissingSchemaAction.Ignore);

                ViewState["CUST_SUBLIMIT"] = dt;
                if (ViewState["CUST_SUBLIMIT"] != null)
                {
                    grvCustSubLimit.DataSource = (DataTable)ViewState["CUST_SUBLIMIT"];
                    grvCustSubLimit.DataBind();
                    grvCustSubLimit.Rows[0].Visible = false;

                }
            }

        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);

        }
        finally
        {
            objCustomerMasterClient.Close();
        }
    }

    private void FunPriHideBankColumns()
    {
        try
        {
            //grvBankDetails.Columns[0].Visible = false;
            //grvBankDetails.Columns[1].Visible = false;
            //grvBankDetails.Columns[2].Visible = false;
            //grvBankDetails.Columns[4].Visible = false;
            //grvBankDetails.Columns[6].Visible = false;
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            throw ex;
        }
    }

    /// <summary>
    /// Method for Disable the Text in Constitutional Document Details tab
    /// </summary>
    /// <param name="str"></param>
    /// <returns></returns>
    private bool FunPriDisableValueField(string str)
    {
        string[] strCheck = new string[2];
        bool blnIsResult = true;
        try
        {
            strCheck = str.Split('-');
            if (strCheck.Length > 0)
            {
                if (Convert.ToString(strCheck[0]) != "CID")
                    blnIsResult = false;
            }
        }
        catch (Exception objException)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(objException, strPageName);
            throw objException;
        }
        return blnIsResult;

    }

    /// <summary>
    /// Method for assign the Text into Coombobox
    /// </summary>
    /// <param name="strControlText"></param>
    /// <param name="cmbControl"></param>
    private void FunPriSetDropDownText(string strControlText, AjaxControlToolkit.ComboBox cmbControl)
    {
        try
        {
            for (int i = 0; i < cmbControl.Items.Count; i++)
            {
                if (cmbControl.Items[i].Text == strControlText)
                    cmbControl.SelectedItem.Text = strControlText;
            }
        }
        catch (Exception objException)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(objException, strPageName);
            throw objException;
        }
    }

    /// <summary>
    /// Method for Loading the Customer Details
    /// </summary>
    /// <param name="CustomerID"></param>
    private void FunPriLoadCustomerDetails(int CustomerID)
    {
        OrgMasterMgtServicesReference.OrgMasterMgtServicesClient objCustomerMasterClient = new OrgMasterMgtServicesReference.OrgMasterMgtServicesClient();
        try
        {
            S3GBusEntity.S3G_Status_Parameters ObjStatus = new S3G_Status_Parameters();
            ObjStatus.Option = 10;
            ObjStatus.Param1 = CustomerID.ToString();
            DataTable ObjCustomerDetails = new DataTable();
            ObjCustomerDetails = objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus);

            if (ObjCustomerDetails.Rows.Count > 0)
            {
                txtCustomercode.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Customer_Code"]);

                ListItem lst;

                if (strMode == "Q")
                {
                    lst = new ListItem(Convert.ToString(ObjCustomerDetails.Rows[0]["Customer_Type"]), Convert.ToString(ObjCustomerDetails.Rows[0]["Customer_Type_ID"]));
                    ddlCustomerType.Items.Add(lst);
                    cmbIndustryCode.Enabled = false;
                    cmbsub.Enabled = false;
                }
                ddlCustomerType.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Customer_Type_ID"]);
                if (Convert.ToString(ObjCustomerDetails.Rows[0]["GroupCode"]) != string.Empty)
                {
                    hdnGroupCode.Value = Convert.ToString(ObjCustomerDetails.Rows[0]["GroupCode"]);                    
                    txtGroupCode.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Groupname"]);
                }                
                //if (!string.IsNullOrEmpty(txtGroupName.Text))
                //{
                //    txtGroupName.ReadOnly = true;
                //}
                //  FunPriSetDropDownText(Convert.ToString(ObjCustomerDetails.Rows[0]["IndustryCode"]), cmbIndustryCode); commented by Prakash 
                FunGetIndustryCode();

                //cmbIndustryCode.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["IndustryCode"]);
                //                txtIndustryName.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["IndustryName"]);
                //cmbIndustryCode.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["IndustryName"]);
                //cmbsub.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Sub_Industryname"]);

                //txtFamilyName.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Family_Name"]);
                txtNotes.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Notes"]);
                rbCreditType.SelectedIndex = Convert.ToInt32(ObjCustomerDetails.Rows[0]["CreditType"]);
                chkBadTrack.Checked = Convert.ToBoolean(ObjCustomerDetails.Rows[0]["IS_BlocListed"]);

                //if (!string.IsNullOrEmpty(txtIndustryName.Text))
                //{
                //    txtIndustryName.Enabled = false;
                //}

                if (strMode == "Q")
                {
                    lst = new ListItem(Convert.ToString(ObjCustomerDetails.Rows[0]["Constitution_Name"]), Convert.ToString(ObjCustomerDetails.Rows[0]["Constitution_ID"]));
                    ddlConstitutionName.Items.Add(lst);
                }

                ddlConstitutionName.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Constitution_ID"]);


                if (strMode == "Q")
                {
                    lst = new ListItem(Convert.ToString(ObjCustomerDetails.Rows[0]["Title"]), Convert.ToString(ObjCustomerDetails.Rows[0]["Title_ID"]));
                    ddlTitle.Items.Add(lst);
                }
                ddlTitle.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Title_ID"]);
                //added Relation Type
                chkCustomer.Checked = Convert.ToBoolean(ObjCustomerDetails.Rows[0]["Customer"]);
                chkGuarantor1.Checked = Convert.ToBoolean(ObjCustomerDetails.Rows[0]["Guarantor1"]);
                chkGuarantor2.Checked = Convert.ToBoolean(ObjCustomerDetails.Rows[0]["Guarantor2"]);
                chkCoApplicant.Checked = Convert.ToBoolean(ObjCustomerDetails.Rows[0]["Co_Applicant"]);
                chkGroupDet.Checked = Convert.ToBoolean(ObjCustomerDetails.Rows[0]["CUSTOMER_GROUP"]);
                if (chkCustomer.Checked)
                    chkCustomer.Enabled = false;
                if (chkGuarantor1.Checked)
                    chkGuarantor1.Enabled = false;
                if (chkGuarantor2.Checked)
                    chkGuarantor2.Enabled = false;
                if (chkCoApplicant.Checked)
                    chkCoApplicant.Enabled = false;
                if (chkGroupDet.Checked)
                    chkGroupDet.Enabled = false;
                //end
                txtCustomerName.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Customer_Name"]);

                ListItem ListPosting = new ListItem(Convert.ToString(ObjCustomerDetails.Rows[0]["Posting_Code"]), Convert.ToString(ObjCustomerDetails.Rows[0]["Customer_Posting_Group_Code_ID"]), true);
                ListPosting.Selected = false;
                if (ddlPostingGroup.Items.FindByValue(Convert.ToString(ObjCustomerDetails.Rows[0]["Customer_Posting_Group_Code_ID"])) == null)
                {
                    if (ddlPostingGroup.Items.FindByText(Convert.ToString(ObjCustomerDetails.Rows[0]["Posting_Code"])) != null)
                    {
                        ddlPostingGroup.Items.Remove(ddlPostingGroup.Items.FindByText(Convert.ToString(ObjCustomerDetails.Rows[0]["Posting_Code"])));
                    }
                    ddlPostingGroup.Items.Add(ListPosting);
                }

                ddlPostingGroup.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Customer_Posting_Group_Code_ID"]);

                //ucBasicDetAddressSetup.BindAddressSetupDetails(1);
                //ucOtherDetAddressSetup.BindAddressSetupDetails(2);

                //if (ObjCustomerDetails.Tables[0].Rows.Count > 0)
                //{
                //    ucBasicDetAddressSetup.PostalCode_Text = ds.Tables[0].Rows[0]["Postal_Code_Text"].ToString();
                //    ucBasicDetAddressSetup.PostalCode_Value = ds.Tables[0].Rows[0]["Postal_Code_Value"].ToString();
                //    ucBasicDetAddressSetup.PostBoxNo = ds.Tables[0].Rows[0]["Post_Box_No"].ToString();
                //    ucBasicDetAddressSetup.WayNo = ds.Tables[0].Rows[0]["Way_No"].ToString();
                //    ucBasicDetAddressSetup.HouseNo = ds.Tables[0].Rows[0]["House_No"].ToString();
                //    ucBasicDetAddressSetup.BlockNo = ds.Tables[0].Rows[0]["Block_No"].ToString();
                //    ucBasicDetAddressSetup.FlatNo = ds.Tables[0].Rows[0]["Flat_No"].ToString();
                //    ucBasicDetAddressSetup.LandMark = ds.Tables[0].Rows[0]["LandMark"].ToString();
                //    ucBasicDetAddressSetup.AreaSheik_Text = ds.Tables[0].Rows[0]["Area_Sheik_Text"].ToString();
                //    ucBasicDetAddressSetup.AreaSheik_Value = ds.Tables[0].Rows[0]["Area_Sheik_Value"].ToString();
                //    ucBasicDetAddressSetup.ResidencePhoneNo = ds.Tables[0].Rows[0]["Residence_Phone_No"].ToString();
                //    ucBasicDetAddressSetup.ResidenceFaxNo = ds.Tables[0].Rows[0]["Residence_Fax_No"].ToString();
                //    ucBasicDetAddressSetup.MobilePhoneNo = ds.Tables[0].Rows[0]["Mobile_Phone_No"].ToString();
                //    ucBasicDetAddressSetup.ContactName = ds.Tables[0].Rows[0]["Contact_Name"].ToString();
                //    ucBasicDetAddressSetup.ContactNo = ds.Tables[0].Rows[0]["Contact_No"].ToString();
                //    ucBasicDetAddressSetup.OfficePhoneNo = ds.Tables[0].Rows[0]["Office_Phone_No"].ToString();
                //    ucBasicDetAddressSetup.OfficeFaxNo = ds.Tables[0].Rows[0]["Office_Fax_No"].ToString();
                //    ucBasicDetAddressSetup.CustomerEmail = ds.Tables[0].Rows[0]["Cust_Email"].ToString();
                //}
                //if (ds.Tables[1].Rows.Count > 0)
                //{
                //    ucOtherDetAddressSetup.PostalCode_Text = null;
                //    ucOtherDetAddressSetup.PostalCode_Value = null;
                //    ucOtherDetAddressSetup.AreaSheik_Text = null;
                //    ucOtherDetAddressSetup.AreaSheik_Value = null;

                //    ucOtherDetAddressSetup.PostalCode_Text = ds.Tables[1].Rows[0]["Postal_Code_Text"].ToString();
                //    ucOtherDetAddressSetup.PostalCode_Value = ds.Tables[1].Rows[0]["Postal_Code_Value"].ToString();
                //    ucOtherDetAddressSetup.PostBoxNo = ds.Tables[1].Rows[0]["Post_Box_No"].ToString();
                //    ucOtherDetAddressSetup.WayNo = ds.Tables[1].Rows[0]["Way_No"].ToString();
                //    ucOtherDetAddressSetup.HouseNo = ds.Tables[1].Rows[0]["House_No"].ToString();
                //    ucOtherDetAddressSetup.BlockNo = ds.Tables[1].Rows[0]["Block_No"].ToString();
                //    ucOtherDetAddressSetup.FlatNo = ds.Tables[1].Rows[0]["Flat_No"].ToString();
                //    ucOtherDetAddressSetup.LandMark = ds.Tables[1].Rows[0]["LandMark"].ToString();
                //    ucOtherDetAddressSetup.AreaSheik_Text = ds.Tables[1].Rows[0]["Area_Sheik_Text"].ToString();
                //    ucOtherDetAddressSetup.AreaSheik_Value = ds.Tables[1].Rows[0]["Area_Sheik_Value"].ToString();
                //    ucOtherDetAddressSetup.ResidencePhoneNo = ds.Tables[1].Rows[0]["Residence_Phone_No"].ToString();
                //    ucOtherDetAddressSetup.ResidenceFaxNo = ds.Tables[1].Rows[0]["Residence_Fax_No"].ToString();
                //    ucOtherDetAddressSetup.MobilePhoneNo = ds.Tables[1].Rows[0]["Mobile_Phone_No"].ToString();
                //    ucOtherDetAddressSetup.ContactName = ds.Tables[1].Rows[0]["Contact_Name"].ToString();
                //    ucOtherDetAddressSetup.ContactNo = ds.Tables[1].Rows[0]["Contact_No"].ToString();
                //    ucOtherDetAddressSetup.OfficePhoneNo = ds.Tables[1].Rows[0]["Office_Phone_No"].ToString();
                //    ucOtherDetAddressSetup.OfficeFaxNo = ds.Tables[1].Rows[0]["Office_Fax_No"].ToString();
                //    ucOtherDetAddressSetup.CustomerEmail = ds.Tables[1].Rows[0]["Cust_Email"].ToString();
                //}

                //txtComAddress1.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Comm_Address1"]);
                //txtCOmAddress2.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Comm_Address2"]);
                ////<<Performance>>
                ////txtComCity.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Comm_City"]);
                //txtComCity.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Comm_City"]);

                //if (strMode == "Q" || strMode == "M")
                //{
                //    txtComState.Items.Add(Convert.ToString(ObjCustomerDetails.Rows[0]["Comm_State"]));
                //    txtPerState.Items.Add(Convert.ToString(ObjCustomerDetails.Rows[0]["Perm_State"]));
                //    txtComCountry.Items.Add(Convert.ToString(ObjCustomerDetails.Rows[0]["Comm_Country"]));
                //    txtPerCountry.Items.Add(Convert.ToString(ObjCustomerDetails.Rows[0]["Perm_Country"]));
                //}
                //txtComState.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Comm_State"]);
                //txtComCountry.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Comm_Country"]);
                //txtComPincode.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Comm_PINCode"]);
                //txtComMobile.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Comm_Mobile"]);
                //txtComTelephone.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Comm_Telephone"]);
                //txtComEmail.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Comm_Email"]);
                //txtComWebsite.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Comm_Website"]);
                //txtPerAddress1.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Perm_Address1"]);
                //txtPerAddress2.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Perm_Address2"]);
                ////<<Performance>>
                ////txtPerCity.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Perm_City"]);
                //txtPerCity.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Perm_City"]);
                //txtPerState.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Perm_State"]);
                //txtPerCountry.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Perm_Country"]);
                //txtPerPincode.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Perm_PINCode"]);
                //txtPerMobile.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Perm_Mobile"]);
                //txtPerTelephone.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Perm_Telephone"]);
                //txtPerEmail.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Perm_Email"]);
                //txtPerWebSite.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Perm_Website"]);

                txtIdentityExpiredate.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["EXPR_DATE"]);
                txtIdentityIssueDate.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["EXPR_DATE"]);
                cmbIndustryCode.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Industry_ID"]);
                FunGetSubIndustryCode();
                cmbsub.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Sub_Industry_ID"]);

                if (Convert.ToString(ObjCustomerDetails.Rows[0]["Nationality"]) != string.Empty)
                {
                    ddlNationality.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Nationality"]);
                }
                if (Convert.ToString(ObjCustomerDetails.Rows[0]["Passport_Number"]) != string.Empty)
                {
                    txtIdentityColumn.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Passport_Number"]);
                }
                if (Convert.ToString(ObjCustomerDetails.Rows[0]["Passport_Issue_Date"]) != string.Empty)
                {
                    txtIdentityIssueDate.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Passport_Issue_Date"]);
                }
                if (Convert.ToString(ObjCustomerDetails.Rows[0]["Passport_Exp_Date"]) != string.Empty)
                {
                    txtIdentityExpiredate.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Passport_Exp_Date"]);
                }
                //if (((DataTable)ViewState["AddsDetailsTable"]).Rows.Count > 0)
                //{
                //    ObjCustomerMaster.XmlAddressDetails = ((DataTable)ViewState["AddsDetailsTable"]).FunPubFormXml();
                //}

                if (ddlCustomerType.SelectedItem.Text.ToUpper() == "INDIVIDUAL")
                {

                    #region Individual Type
                    if (ObjCustomerDetails.Rows[0]["Gender"] == DBNull.Value)
                    {
                        ddlGender.SelectedIndex = 0;
                    }
                    else
                    {
                        ddlGender.SelectedValue = Convert.ToInt16(ObjCustomerDetails.Rows[0]["Gender"]).ToString();
                    }
                    if (Convert.ToString(ObjCustomerDetails.Rows[0]["DateofBirth"]) != "") txtDOB.Text = DateTime.Parse(Convert.ToString(ObjCustomerDetails.Rows[0]["DateofBirth"]), CultureInfo.CurrentCulture.DateTimeFormat).ToString(ObjS3GSession.ProDateFormatRW);

                    //Check if not exist
                    if (txtDOB.Text == "1/1/1900")
                    {
                        txtDOB.Text = string.Empty;
                    }
                    if (!string.IsNullOrEmpty(txtDOB.Text))
                    {
                        int intDOBYear = Utility.StringToDate(txtDOB.Text).Year;
                        txtAge.Text = ((DateTime.Now.Year - intDOBYear) + 1).ToString();
                    }

                    if (ObjCustomerDetails.Rows[0]["Marital_Status_ID"] == DBNull.Value)
                    {
                        ddlMaritalStatus.SelectedIndex = -1;
                    }
                    else
                    {
                        if (strMode == "Q")
                        {
                            lst = new ListItem(Convert.ToString(ObjCustomerDetails.Rows[0]["Marital_Status"]), Convert.ToString(ObjCustomerDetails.Rows[0]["Marital_Status_ID"]));
                            ddlMaritalStatus.Items.Add(lst);
                        }

                        ddlMaritalStatus.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Marital_Status_ID"]);
                    }
                    txtQualification.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Qualification"]);
                    txtProfession.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Profession"]);
                    txtSpouseName.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Spouse_Name"]);
                    txtChildren.Text = (Convert.ToString(ObjCustomerDetails.Rows[0]["Children"]) == "0") ? "" : Convert.ToString(ObjCustomerDetails.Rows[0]["Children"]);
                    txtTotalDependents.Text = (Convert.ToString(ObjCustomerDetails.Rows[0]["Total_Dependents"]) == "0") ? "" : Convert.ToString(ObjCustomerDetails.Rows[0]["Total_Dependents"]);
                    if (Convert.ToString(ObjCustomerDetails.Rows[0]["Wedding_Anniversary_Date"]) != "") txtWeddingdate.Text = DateTime.Parse(Convert.ToString(ObjCustomerDetails.Rows[0]["Wedding_Anniversary_Date"]), CultureInfo.CurrentCulture.DateTimeFormat).ToString(ObjS3GSession.ProDateFormatRW);
                    if (txtWeddingdate.Text == "1/1/1900")
                    {
                        txtWeddingdate.Text = string.Empty;
                    }

                    if (ObjCustomerDetails.Rows[0]["House_Flat_ID"] == DBNull.Value)
                    {
                        ddlHouseType.SelectedIndex = -1;
                    }
                    else
                    {
                        if (strMode == "Q")
                        {
                            lst = new ListItem(Convert.ToString(ObjCustomerDetails.Rows[0]["House_Flat"]), Convert.ToString(ObjCustomerDetails.Rows[0]["House_Flat_ID"]));
                            ddlHouseType.Items.Add(lst);
                        }

                        ddlHouseType.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["House_Flat_ID"]);
                    }
                    //if (ObjCustomerDetails.Rows[0]["Is_Own"] == DBNull.Value)
                    //{
                    //    ddlOwn.SelectedIndex = -1;
                    //}
                    //else
                    //{
                    //    ddlOwn.SelectedValue = (Convert.ToString(ObjCustomerDetails.Rows[0]["Is_Own"]).ToLower() == "true") ? "1" : "0";
                    //}
                    ////Added by ganapathy to fix the bugID 6343
                    //if (ddlOwn.SelectedValue == "0")
                    //{
                    //    txtCurrentMarketValue.Enabled = false;
                    //    txtRemainingLoanValue.Enabled = false;
                    //    txtTotNetWorth.Enabled = false;
                    //}
                    //else
                    //{
                    //    txtCurrentMarketValue.Enabled = true;
                    //    txtRemainingLoanValue.Enabled = true;
                    //    txtTotNetWorth.Enabled = true;
                    //}
                    //End here
                    //Commented by Thangam M on 09/Mar/2012 to fix bug id 5445
                    //txtCurrentMarketValue.Text = (Convert.ToString(ObjCustomerDetails.Rows[0]["Current_Market_Value"]) == "0") ? "" : Convert.ToString(ObjCustomerDetails.Rows[0]["Current_Market_Value"]);
                    //End here
                    //Code Modified By Ganapathy for fixing the bug 6343
                    txtCurrentMarketValue.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Current_Market_Value"]);
                    //txtCurrentMarketValue.Text = (Convert.ToString(ObjCustomerDetails.Rows[0]["Current_Market_Value"]) == "0") ? "" : Convert.ToString(ObjCustomerDetails.Rows[0]["Current_Market_Value"]);
                    //txtRemainingLoanValue.Text = (Convert.ToString(ObjCustomerDetails.Rows[0]["Remaining_Loan_Value"]) == "0") ? "" : Convert.ToString(ObjCustomerDetails.Rows[0]["Remaining_Loan_Value"]);
                    txtRemainingLoanValue.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Remaining_Loan_Value"]);
                    //txtTotNetWorth.Text = (Convert.ToString(ObjCustomerDetails.Rows[0]["Total_Net_Morth"]) == "0") ? "" : Convert.ToString(ObjCustomerDetails.Rows[0]["Total_Net_Morth"]);
                    txtTotNetWorth.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Total_Net_Morth"]);
                    //End here
                    txtFirstName.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["CUSTOMER_NAME1"]);
                    txtSecondName.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["CUSTOMER_NAME2"]);
                    txtThirdName.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["CUSTOMER_NAME3"]);
                    txtFourthName.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["CUSTOMER_NAME4"]);
                    txtFifthName.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["CUSTOMER_NAME5"]);
                    txtSixthName.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["CUSTOMER_NAME6"]);
                    //if (!(ddlCustomerType.SelectedItem.ToString().ToLower() == "non individual"))
                    //{
                    //    ObjCustomerMaster.CUSTOMER_NAME1 = txtFirstName.Text.Trim();
                    //    ObjCustomerMaster.CUSTOMER_NAME2 = txtSecondName.Text.Trim();
                    //    ObjCustomerMaster.CUSTOMER_NAME3 = txtThirdName.Text.Trim();
                    //    ObjCustomerMaster.CUSTOMER_NAME4 = txtFourthName.Text.Trim();
                    //    ObjCustomerMaster.CUSTOMER_NAME5 = txtFifthName.Text.Trim();
                    //    ObjCustomerMaster.CUSTOMER_NAME6 = txtSixthName.Text.Trim();
                    //    txtCustomerName.Text = txtFirstName.Text.Trim() + " " + txtSecondName.Text.Trim() + " " + txtThirdName.Text.Trim() + " " + txtFourthName.Text.Trim() + " " + txtFifthName.Text.Trim() + " " + txtSixthName.Text.Trim();
                    //    ObjCustomerMaster.CustomerName = txtCustomerName.Text.Trim();
                    //}
                    if (Convert.ToString(ObjCustomerDetails.Rows[0]["Visa_Number"]) != string.Empty)
                    {
                        txtVisaNo.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Visa_Number"]);
                    }
                    if (Convert.ToString(ObjCustomerDetails.Rows[0]["Labour_Card_No"]) != string.Empty)
                    {
                        txtLabourCardNo.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Labour_Card_No"]);
                    }
                    if (Convert.ToString(ObjCustomerDetails.Rows[0]["Labour_Card_Issue_Date"]) != string.Empty)
                    {
                        txtLabourCardDate.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Labour_Card_Issue_Date"]);
                    }
                    if (Convert.ToString(ObjCustomerDetails.Rows[0]["Labour_Card_Exp_Date"]) != string.Empty)
                    {
                        txtLaborExpDate.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Labour_Card_Exp_Date"]);
                    }
                    if (Convert.ToString(ObjCustomerDetails.Rows[0]["Occupation"]) != string.Empty)
                    {
                        cmbOccupation.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Occupation"]);
                    }
                    if (Convert.ToString(ObjCustomerDetails.Rows[0]["MFC_Employee_Indi"]) != string.Empty)
                    {
                        rbnMFCEmpIndi.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["MFC_Employee_Indi"]);
                    }
                    if (Convert.ToString(ObjCustomerDetails.Rows[0]["MFC_Employee_ID"]) != string.Empty && Convert.ToString(ObjCustomerDetails.Rows[0]["MFC_Employee_ID"]) != "0")
                    {
                        hdnMFCUserID.Value = Convert.ToString(ObjCustomerDetails.Rows[0]["MFC_Employee_ID"]);
                        txtMfcCode.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["MFC_Employee_Name"]);
                    }
                    if (Convert.ToString(ObjCustomerDetails.Rows[0]["Employer_Name"]) != string.Empty)
                    {
                        cmbEmployerName.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Employer_Name"]);
                    }
                    if (Convert.ToString(ObjCustomerDetails.Rows[0]["Employer_Eco_Act_Code"]) != string.Empty)
                    {
                        cmEmpEcoCode.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Employer_Eco_Act_Code"]);
                    }
                    if (Convert.ToString(ObjCustomerDetails.Rows[0]["Employee_Code"]) != string.Empty)
                    {
                        txtEmployeeCode.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Employee_Code"]);
                    }
                    if (Convert.ToString(ObjCustomerDetails.Rows[0]["Department_Name"]) != string.Empty)
                    {
                        txtDepartmentName.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Department_Name"]);
                    }
                    if (Convert.ToString(ObjCustomerDetails.Rows[0]["Designation"]) != string.Empty)
                    {
                        txtDesignation.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Designation"]);
                    }
                    if (Convert.ToString(ObjCustomerDetails.Rows[0]["Place_of_Work"]) != string.Empty)
                    {
                        txtPlaceofWork.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Place_of_Work"]);
                    }
                    if (Convert.ToString(ObjCustomerDetails.Rows[0]["Date_Of_Join"]) != string.Empty)
                    {
                        txtDateOfJoin.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Date_Of_Join"]);
                    }
                    if (Convert.ToString(ObjCustomerDetails.Rows[0]["Monthily_Income"]) != string.Empty)
                    {
                        txtMonBusIncome.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Monthily_Income"]);
                    }
                    if (Convert.ToString(ObjCustomerDetails.Rows[0]["VIP_Customer"]) != string.Empty)
                    {
                        ddlVIP.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["VIP_Customer"]);
                    }
                    #endregion
                }
                else
                {
                    #region Non-Individual

                    if (strMode == "Q")
                    {
                        lst = new ListItem(Convert.ToString(ObjCustomerDetails.Rows[0]["Public_Closely"]), Convert.ToString(ObjCustomerDetails.Rows[0]["Public_Closely_ID"]));
                        cmbPublic.Items.Add(lst);
                    }

                    cmbPublic.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Public_Closely_ID"]);
                    txtDirectors.Text = (Convert.ToString(ObjCustomerDetails.Rows[0]["No_Of_Directors"]) == "0") ? "" : Convert.ToString(ObjCustomerDetails.Rows[0]["No_Of_Directors"]);
                    txtSE.Text = (Convert.ToString(ObjCustomerDetails.Rows[0]["Listed_At_Stock_Exchange"]) == "0") ? "" : Convert.ToString(ObjCustomerDetails.Rows[0]["Listed_At_Stock_Exchange"]);
                    txtPaidCapital.Text = (Convert.ToString(ObjCustomerDetails.Rows[0]["Paidup_Capital"]) == "0") ? "" : Convert.ToString(ObjCustomerDetails.Rows[0]["Paidup_Capital"]);
                    txtfacevalue.Text = (Convert.ToString(ObjCustomerDetails.Rows[0]["Face_Value_of_Shares"]) == "0") ? "" : Convert.ToString(ObjCustomerDetails.Rows[0]["Face_Value_of_Shares"]);
                    txtbookvalue.Text = (Convert.ToString(ObjCustomerDetails.Rows[0]["Book_Value_of_Shares"]) == "0") ? "" : Convert.ToString(ObjCustomerDetails.Rows[0]["Book_Value_of_Shares"]);
                    txtBusinessProfile.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Business_Profile"]);
                    txtGeographical.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Geographical_Coverage"]);
                    txtnobranch.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["No_Of_Branches"]);

                    if (strMode == "Q")
                    {
                        lst = new ListItem(Convert.ToString(ObjCustomerDetails.Rows[0]["Participation"]), Convert.ToString(ObjCustomerDetails.Rows[0]["Participation_ID"]));
                        ddlGovernment.Items.Add(lst);
                    }
                    ddlGovernment.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Participation_ID"]);

                    //Changed By Thangam M on 12/Mar/2012 to fix bug id - 5447
                    txtPercentageStake.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Percentage_Of_Stake"]);
                    //txtPercentageStake.Text = (Convert.ToString(ObjCustomerDetails.Rows[0]["Percentage_Of_Stake"]).StartsWith("0")) ? "" : Convert.ToString(ObjCustomerDetails.Rows[0]["Percentage_Of_Stake"]);

                    txtJVPartnerName.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["JV_Partner_Name"]);

                    txtJVPartnerStake.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["JV_Partner_Stake"]);
                    //txtJVPartnerStake.Text = (Convert.ToString(ObjCustomerDetails.Rows[0]["JV_Partner_Stake"]).StartsWith("0")) ? "" : Convert.ToString(ObjCustomerDetails.Rows[0]["JV_Partner_Stake"]);
                    //End here

                    txtCEOName.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["CEO_Name"]);
                    txtCEOAge.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["CEO_Age"]);
                    //if (Convert.ToString(ObjCustomerDetails.Rows[0]["CEO_Wedding_Date"]) != "") txtCEOWeddingDate.Text = DateTime.Parse(Convert.ToString(ObjCustomerDetails.Rows[0]["CEO_Wedding_Date"]), CultureInfo.CurrentCulture.DateTimeFormat).ToString(ObjS3GSession.ProDateFormatRW);
                    //if (txtCEOWeddingDate.Text == "1/1/1900")
                    //{
                    //    txtCEOWeddingDate.Text = string.Empty;
                    //}

                    txtCEOexperience.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["CEO_Experience_In_Years"]);
                    //txtResidentialAddress.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Residential_Address"]);
                    //Created By : Anbuvel.T,Date : 19-MAY-2018, Description : Customer Master Changes done                    
                    
                    if (Convert.ToString(ObjCustomerDetails.Rows[0]["Financial_required"]) != string.Empty)
                    {
                        txtFinancialrequired.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Financial_required"]);
                    }
                    if (Convert.ToString(ObjCustomerDetails.Rows[0]["Financial_received"]) != string.Empty)
                    {
                        cmbFinancialReceived.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Financial_received"]);
                    }
                    if (Convert.ToString(ObjCustomerDetails.Rows[0]["OCCI_Issue_Date"]) != string.Empty)
                    {
                        txtOCCIIssueDate.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["OCCI_Issue_Date"]);
                    }
                    if (Convert.ToString(ObjCustomerDetails.Rows[0]["OCCI_Exp_Date"]) != string.Empty)
                    {
                        txtOCCIExpiryDate.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["OCCI_Exp_Date"]);
                    }
                    
                    //if (((DataTable)ViewState["ShareDetails"]).Rows.Count > 0)
                    //{
                    //    ObjCustomerMaster.XmlShareDetails = ((DataTable)ViewState["ShareDetails"]).FunPubFormXml();
                    //}
                    #endregion
                }
                if (Convert.ToString(ObjCustomerDetails.Rows[0]["Fac_Applicable"]) != string.Empty)
                {
                    rbnSeMemStatus.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Fac_Applicable"]);
                }
                if (Convert.ToString(ObjCustomerDetails.Rows[0]["Fac_Type"]) != string.Empty)
                {
                    cmbFactoringType.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Fac_Type"]);
                }
                if (Convert.ToString(ObjCustomerDetails.Rows[0]["Fac_Limit"]) != string.Empty)
                {
                    txtFactoringLimit.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Fac_Limit"]);
                }
                if (Convert.ToString(ObjCustomerDetails.Rows[0]["Covenants_Applicable"]) != string.Empty)
                {
                    rbnCovenantApplicable.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Covenants_Applicable"]);
                }
                if (Convert.ToString(ObjCustomerDetails.Rows[0]["Covenants_Clause"]) != string.Empty)
                {
                    txtCovenantClause.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Covenants_Clause"]);
                }
                if (Convert.ToString(ObjCustomerDetails.Rows[0]["Assignment_Collection"]) != string.Empty)
                {
                    txtAssCollection.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Assignment_Collection"]);
                }
                if (Convert.ToString(ObjCustomerDetails.Rows[0]["Fact_Limit_Exp_date"]) != string.Empty)
                {
                    txtFacLimitExp.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Fact_Limit_Exp_date"]);
                }
                if (Convert.ToString(ObjCustomerDetails.Rows[0]["Customer_Industry"]) != string.Empty)
                {
                    cmbIndustryType.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Customer_Industry"]);
                }
                if (Convert.ToString(ObjCustomerDetails.Rows[0]["Seni_Mem_Applicable"]) != string.Empty)
                {
                    rbnSenAppli.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Seni_Mem_Applicable"]);
                }
                if (Convert.ToString(ObjCustomerDetails.Rows[0]["Seni_Mem_Status"]) != string.Empty)
                {
                    rbnSenMemStatus.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Seni_Mem_Status"]);
                }
                if (Convert.ToString(ObjCustomerDetails.Rows[0]["Seni_Mem_Rela_Indi"]) != string.Empty)
                {
                    rbnSenMemRelInd.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Seni_Mem_Rela_Indi"]);
                }
                if (Convert.ToString(ObjCustomerDetails.Rows[0]["Max_Lend_Amount"]) != string.Empty)
                {
                    txtMaxLenLimit.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Max_Lend_Amount"]);
                }
                if (Convert.ToString(ObjCustomerDetails.Rows[0]["Related_Parti_Indi"]) != string.Empty)
                {
                    rbnRelaPartyind.SelectedValue = Convert.ToString(ObjCustomerDetails.Rows[0]["Related_Parti_Indi"]);
                }
                if (Convert.ToString(ObjCustomerDetails.Rows[0]["Max_Lend_Limit_Exp"]) != string.Empty)
                {
                    txtMaxLenLimiExpDate.Text = Convert.ToString(ObjCustomerDetails.Rows[0]["Max_Lend_Limit_Exp"]);
                }
                FunPriLoadCustomerBankDetails(CustomerID);
                FunPriLoadCustSubLimit(CustomerID);
                FunPriLoadCustomerConstitutionDocs(CustomerID);
                FunPriLoadCustomerTrackDetails(CustomerID);
                FunPriLoadAddressDetails(CustomerID);
                FunPriLoadShareDetails(CustomerID);
                FunPriToggleCustomerTypeControls();
                FunProClearUploader();
            }

        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            throw ex;
        }
        finally
        {
            objCustomerMasterClient.Close();
        }
    }

    #region Alert Tab

    private void FunPriBindCustomerTrackDLL()
    {
        try
        {
            Dictionary<string, string> ProcParam = new Dictionary<string, string>();
            ProcParam.Add("@CompanyId", intCompanyId.ToString());
            ProcParam.Add("@CustomerId", intCustomerId.ToString());
            ProcParam.Add("@UserId", intUserId.ToString());
            DataSet dsCustomerTrackDDL = Utility.GetDataset("S3G_ORG_LOADCUSTOMERTRACKDDL", ProcParam);
            ViewState["TrackLOB"] = dsCustomerTrackDDL.Tables[0];
            ViewState["TrackAccountNo"] = dsCustomerTrackDDL.Tables[1];
            ViewState["TrackType"] = dsCustomerTrackDDL.Tables[2];

            DataTable objTrack = ViewState["CustomerTrackDetails"] as DataTable;
            bool blnIsFooterOnly = false;
            if (objTrack.Rows.Count == 0)
            {
                DataRow drTrack = objTrack.NewRow();
                drTrack["LOB_ID"] = 0;
                drTrack["LOB_NAME"] = "";
                drTrack["PA_SA_REF_ID"] = 0;
                drTrack["ACCOUNTNO"] = "";
                drTrack["DATE"] = "";
                drTrack["RELEASEDATE"] = "";
                drTrack["LOGINBY"] = "";
                drTrack["RELEASED_BY"] = 0;
                drTrack["RELEASEDBY"] = "";
                drTrack["REASON"] = "";
                drTrack["TRACK_TYPE"] = "";
                drTrack["TRACK_TYPE_ID"] = 0;
                objTrack.Rows.Add(drTrack);
                blnIsFooterOnly = true;
            }
            gvTrack.DataSource = objTrack;
            gvTrack.DataBind();
            if (blnIsFooterOnly)
            {
                objTrack.Rows.Clear();
                ViewState["CustomerTrackDetails"] = objTrack;

                gvTrack.Rows[0].Cells.Clear();
                gvTrack.Rows[0].Visible = false;
            }
            FunPriGenerateNewAlertRow();


        }
        catch (Exception ex)
        {
            throw ex;
        }

    }

    private void FunPriGenerateNewAlertRow()
    {
        try
        {

            DropDownList ddlLOBTrack = gvTrack.FooterRow.FindControl("ddlLOBTrack") as DropDownList;
            DropDownList ddlAccountNo = gvTrack.FooterRow.FindControl("ddlAccountNo") as DropDownList;
            DropDownList ddlType = gvTrack.FooterRow.FindControl("ddlType") as DropDownList;

            Utility.FillDLL(ddlLOBTrack, ((DataTable)ViewState["TrackLOB"]), true);
            Utility.FillDLL(ddlAccountNo, ((DataTable)ViewState["TrackAccountNo"]), true);
            Utility.FillDLL(ddlType, ((DataTable)ViewState["TrackType"]), true);

            ddlLOBTrack.Focus();
        }
        catch (Exception ex)
        {
            throw ex;
        }
    }

    protected void Track_AddRow_OnClick(object sender, EventArgs e)
    {

        DataTable objTrack = (DataTable)ViewState["CustomerTrackDetails"];

        DropDownList ddlLOBTrack = gvTrack.FooterRow.FindControl("ddlLOBTrack") as DropDownList;
        DropDownList ddlAccountNo = gvTrack.FooterRow.FindControl("ddlAccountNo") as DropDownList;
        DropDownList ddlType = gvTrack.FooterRow.FindControl("ddlType") as DropDownList;
        TextBox txtDate = gvTrack.FooterRow.FindControl("txtDate") as TextBox;
        TextBox txtReleaseDate = gvTrack.FooterRow.FindControl("txtReleaseDate") as TextBox;
        TextBox txtReason = gvTrack.FooterRow.FindControl("txtReason") as TextBox;
        //if (ddlLOBTrack.SelectedIndex <= 0)
        //{
        //    Utility.FunShowAlertMsg(this, "Select the Line of Business");
        //    return;
        //}
        //if (ddlAccountNo.SelectedIndex <= 0)
        //{
        //    Utility.FunShowAlertMsg(this, "Select the Account No.");
        //    return;
        //}
        //if (ddlType.SelectedIndex <= 0)
        //{
        //    Utility.FunShowAlertMsg(this, "Select the Account No.");
        //    return;
        //}
        //if (string.IsNullOrEmpty(txtReleaseDate.Text))
        //{
        //    Utility.FunShowAlertMsg(this, "Select the Release Date");
        //    return;
        //}
        //if (string.IsNullOrEmpty(txtDate.Text))
        //{
        //    Utility.FunShowAlertMsg(this, "Select the Date");
        //    return;
        //}
        DataRow drTrack = objTrack.NewRow();
        drTrack["LOB_ID"] = ddlLOBTrack.SelectedValue;
        drTrack["LOB_NAME"] = ddlLOBTrack.SelectedItem.Text;
        drTrack["PA_SA_REF_ID"] = ddlAccountNo.SelectedValue;
        drTrack["ACCOUNTNO"] = ddlAccountNo.SelectedItem.Text;
        drTrack["DATE"] = txtDate.Text;
        drTrack["RELEASEDATE"] = txtReleaseDate.Text;
        drTrack["LOGINBY"] = ObjUserInfo.ProUserNameRW;
        drTrack["RELEASED_BY"] = intUserId.ToString();
        drTrack["RELEASEDBY"] = ObjUserInfo.ProUserNameRW;
        drTrack["REASON"] = txtReason.Text;
        drTrack["TRACK_TYPE"] = ddlType.SelectedItem.Text;
        drTrack["TRACK_TYPE_ID"] = ddlType.SelectedValue;
        objTrack.Rows.Add(drTrack);

        gvTrack.DataSource = objTrack;
        gvTrack.DataBind();
        ViewState["CustomerTrackDetails"] = objTrack;
        FunPriGenerateNewAlertRow();
        //}
        //else
        //{
        //    ScriptManager.RegisterStartupScript(this, this.GetType(), "Alert", "alert('Please select Email or SMS');", true);

        //}
    }

    protected void gvTrack_RowCreated(object sender, GridViewRowEventArgs e)
    {
        try
        {
            if (e.Row.RowType == DataControlRowType.Footer)
            {
                TextBox txtDate = e.Row.FindControl("txtDate") as TextBox;
                TextBox txtReleaseDate = e.Row.FindControl("txtReleaseDate") as TextBox;
                DropDownList ddlLOBTrack = e.Row.FindControl("ddlLOBTrack") as DropDownList;
                DropDownList ddlAccountNo = e.Row.FindControl("ddlAccountNo") as DropDownList;
                DropDownList ddlType = e.Row.FindControl("ddlType") as DropDownList;

                txtDate.Attributes.Add("readonly", "readonly");
                AjaxControlToolkit.CalendarExtender CalendarDate = e.Row.FindControl("CalendarDate") as AjaxControlToolkit.CalendarExtender;
                CalendarDate.Format = strDateFormat;


                txtReleaseDate.Attributes.Add("readonly", "readonly");
                AjaxControlToolkit.CalendarExtender CalendarReleaseDate = e.Row.FindControl("CalendarReleaseDate") as AjaxControlToolkit.CalendarExtender;
                CalendarReleaseDate.Format = strDateFormat;

            }
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex);
            cvCustomerMaster.ErrorMessage = "Due to Data Problem,Unable to Set the DateFormat in Customer Track Details";
            cvCustomerMaster.IsValid = false;
        }
    }

    protected void gvTrack_RowDataBound(object sender, System.Web.UI.WebControls.GridViewRowEventArgs e)
    {
        try
        {
            if (e.Row.RowType == DataControlRowType.DataRow)
            {
                Label lblLOBName = (Label)e.Row.FindControl("lblLOBName");
                Label lblAccountNo = (Label)e.Row.FindControl("lblAccountNo");
                Label lblTypeId = (Label)e.Row.FindControl("lblTypeId");
                Label lblDate = (Label)e.Row.FindControl("lblDate");
                Label lblReason = (Label)e.Row.FindControl("lblReason");
                Label lblReleaseDate = (Label)e.Row.FindControl("lblReleaseDate");
                Label lblReleasedBy = (Label)e.Row.FindControl("lblReleasedBy");
                if (ViewState["CustomerTrackDetails"] != null)
                {
                    DataTable dtCustomerTrack = (DataTable)ViewState["CustomerTrackDetails"];
                    lblLOBName.Text = Convert.ToString(dtCustomerTrack.Rows[e.Row.RowIndex]["LOB_NAME"]);
                    lblAccountNo.Text = Convert.ToString(dtCustomerTrack.Rows[e.Row.RowIndex]["ACCOUNTNO"]);
                    lblReason.Text = Convert.ToString(dtCustomerTrack.Rows[e.Row.RowIndex]["REASON"]);
                    lblDate.Text = Convert.ToString(dtCustomerTrack.Rows[e.Row.RowIndex]["DATE"]);
                    lblReleaseDate.Text = Convert.ToString(dtCustomerTrack.Rows[e.Row.RowIndex]["RELEASEDATE"]);
                    lblTypeId.Text = Convert.ToString(dtCustomerTrack.Rows[e.Row.RowIndex]["TRACK_TYPE"]);
                    if (dtCustomerTrack.Rows[e.Row.RowIndex]["RELEASEDBY"].ToString() == "")
                    {
                        lblReleasedBy.Text = intUserId.ToString();
                        e.Row.Cells[8].Text =
                        e.Row.Cells[11].Text = ObjUserInfo.ProUserNameRW;
                    }
                    else
                    {
                        lblReleasedBy.Text = Convert.ToString(dtCustomerTrack.Rows[e.Row.RowIndex]["RELEASED_BY"]);
                        e.Row.Cells[8].Text = Convert.ToString(dtCustomerTrack.Rows[e.Row.RowIndex]["LOGINBY"]);
                        e.Row.Cells[11].Text = Convert.ToString(dtCustomerTrack.Rows[e.Row.RowIndex]["RELEASEDBY"]);
                    }
                }

            }
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            throw ex;
        }
    }
    #endregion
    private void FunPriLoadCustomerTrackDetails(int intCustomerId)
    {
        OrgMasterMgtServicesReference.OrgMasterMgtServicesClient objCustomerMasterClient = new OrgMasterMgtServicesReference.OrgMasterMgtServicesClient();
        try
        {

            S3GBusEntity.S3G_Status_Parameters ObjStatus = new S3G_Status_Parameters();
            ObjStatus.Option = 303;
            ObjStatus.Param1 = intCustomerId.ToString();
            ObjStatus.Param2 = intUserId.ToString();
            ObjStatus.Param3 = intCompanyId.ToString();
            DataTable ObjCustomerTrackDetails = objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus);
            ViewState["CustomerTrackDetails"] = ObjCustomerTrackDetails;
            FunPriBindCustomerTrackDLL();
            if (gvTrack.Rows.Count < 1 && gvTrack.FooterRow.Visible)
            {
                lblNoCustomerTrack.Visible = true;
                // Need to comment by Manikandan. R
                gvTrack.Visible = false;
                divTrack.Visible = false;
            }
            else
            {
                lblNoCustomerTrack.Visible = false;
                gvTrack.Visible = true;
                divTrack.Visible = true;
            }
            Dictionary<string, string> objProcedureParameters = new Dictionary<string, string>();
            objProcedureParameters.Add("@CustomerId", intCustomerId.ToString());
            gvCredit.DataSource = Utility.GetDefaultData("s3g_org_LoadCustomerCreditDetails", objProcedureParameters);
            gvCredit.DataBind();

        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            throw new ApplicationException("Due to Data Problem, Unable to Load the Customer Track Details");
        }
        finally
        {
            objCustomerMasterClient.Close();
        }

    }
    /// <summary>
    /// Toggle the Controls based on User's AccessPermission
    /// </summary>
    /// <param name="intModeID"></param>
    private void FunPriDisableControls(int intModeID)
    {
        try
        {
            if (!bQuery)
            {
                Response.Redirect(strRedirectPageView);
            }


            switch (intModeID)
            {
                case 0: // Create Mode
                    FunPriToggleLoanAdminControls(false);
                    lblHeading.Text = FunPubGetPageTitles(enumPageTitle.Create);
                    btnClear.Enabled = true;
                    ddlGender.SelectedIndex = 0;
                    if ((!bCreate))
                    {
                        btnSave.Enabled = false;
                    }
                    btnModify.Enabled = false;
                    txtCustomercode.ReadOnly = false;
                    lblCustomercode.Visible = txtCustomercode.Visible = false;
                    break;

                case 1: // Modify Mode
                    lblHeading.Text = FunPubGetPageTitles(enumPageTitle.Modify);
                    FunPriSetControlSettings();
                    FunPriLoadCustomerDetails(intCustomerId);
                    FunPriToggleCustomerTypeControls();
                    btnModify.Enabled = false;
                    tcCustomerMaster.ActiveTabIndex = 0;
                    txtCustomercode.ReadOnly = true;
                    //Lined by Thangam M 0n 28/Feb/2012 for bug id 5453
                    //txtCustomerName.ReadOnly = true;
                    //End here
                    lblCustomercode.Visible = txtCustomercode.Visible = true;
                    txtAge.ReadOnly = true;
                    if ((!bModify))
                    {
                        btnSave.Enabled = false;
                    }
                    btnClear.Enabled = false;
                    Dictionary<string, string> ProcParam = new Dictionary<string, string>();
                    ProcParam.Add("@COMPANYID", intCompanyId.ToString());
                    ProcParam.Add("@CUSTOMERID", intCustomerId.ToString());
                    DataSet dsAccountCount = Utility.GetDataset("S3G_ORG_GETACCOUNTCOUNT", ProcParam);
                    if (Convert.ToInt32(dsAccountCount.Tables[0].Rows[0][0]) > 0)
                    {
                        txtCustomerName.ReadOnly = true;
                        if (bClearList)
                        {
                            ddlTitle.RemoveDropDownList();
                            ddlCustomerType.RemoveDropDownList();
                            ddlConstitutionName.RemoveDropDownList();
                            ddlPostingGroup.RemoveDropDownList();
                            ddlGender.ClearDropDownList();

                        }

                        //CalendarExtenderSD.Enabled = false;
                        //cmbIndustryCode.ReadOnly = txtIndustryName.ReadOnly = true;
                    }
                    break;
                case -1:// Query Mode

                    FunPriSetControlSettings();
                    FunPriLoadCustomerDetails(intCustomerId);
                    FunPriToggleCustomerTypeControls();
                    lblHeading.Text = FunPubGetPageTitles(enumPageTitle.View);
                    tcCustomerMaster.ActiveTabIndex = 0;
                    lblCustomercode.Visible = true;
                    txtCustomercode.Visible = true;
                    FunPriToggleQueryModeControls();
                    txtGroupCode.Enabled = false;
                    //btnCopyAddress.Visible = false;
                    chkCustomer.Enabled = false;
                    chkGuarantor1.Enabled = false;
                    chkGuarantor2.Enabled = false;
                    chkCoApplicant.Enabled = false;
                    rbCreditType.Enabled = false;
                    grvCustSubLimit.Columns[grvCustSubLimit.Columns.Count - 1].Visible = false;
                    grvCustSubLimit.FooterRow.Visible = false;
                    grvAddressDetails.Columns[grvAddressDetails.Columns.Count - 1].Visible = false;
                    grvAddressDetails.FooterRow.Visible = false;
                    txtCustomercode.ReadOnly = true;
                    break;
            }
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            throw ex;
        }
    }

    private void FunPriToggleQueryModeControls()
    {
        txtCustomerName.ReadOnly = true;
        tblBankDetails.Visible = false;
        if (bClearList)
        {
            ddlCustomerType.RemoveDropDownList();
            ddlConstitutionName.RemoveDropDownList();
            ddlGender.ClearDropDownList();
            ddlGovernment.RemoveDropDownList();
            ddlHouseType.RemoveDropDownList();

            ddlMaritalStatus.RemoveDropDownList();
            //ddlOwn.RemoveDropDownList();
            ddlPostingGroup.RemoveDropDownList();
            //cmbPublic.RemoveDropDownList();
            ddlTitle.RemoveDropDownList();
        }
        CalendarExtenderSD.Enabled = false;

        //<<Performance>>
        //txtComCity.DropDownStyle = 
        //txtComCity.Items.Clear();
        //txtComCity.ClearDropDownList();
        //txtComState.DropDownStyle = AjaxControlToolkit.ComboBoxStyle.DropDownList;
        ////txtComCity.ClearDropDownList();
        //txtComState.ClearDropDownList();


        ////<<Performance>>

        //txtComCountry.DropDownStyle = txtPerCity.DropDownStyle = txtPerCountry.DropDownStyle;
        //txtPerCountry.ClearDropDownList(); txtComCountry.ClearDropDownList();

        //txtPerState.DropDownStyle = AjaxControlToolkit.ComboBoxStyle.DropDownList;
        ////txtPerCity.ClearDropDownList();
        ////txtPerCity.Items.Clear();
        //txtPerCity.ClearDropDownList();
        //txtPerState.ClearDropDownList();

        ////Commented By R. Manikandan 17 - SEP - 2014 by NCPM Changes
        ////txtComCity.ReadOnly = txtComCountry.ReadOnly = txtComState.ReadOnly =
        //// = txtPerCity.ReadOnly = txtPerCountry.ReadOnly = txtPerState.ReadOnly = 
        //cmbGroupCode.ReadOnly = txtGroupName.ReadOnly =
        //txtComAddress1.ReadOnly = txtCOmAddress2.ReadOnly = txtComEmail.ReadOnly =
        //txtComMobile.ReadOnly = txtComPincode.ReadOnly = txtComTelephone.ReadOnly = txtComWebsite.ReadOnly =
        //txtPerAddress1.ReadOnly = txtPerAddress2.ReadOnly = txtPerEmail.ReadOnly =
        //txtPerMobile.ReadOnly = txtPerPincode.ReadOnly = txtPerTelephone.ReadOnly = txtPerWebSite.ReadOnly =
        txtQualification.ReadOnly = txtProfession.ReadOnly = txtSpouseName.ReadOnly = txtChildren.ReadOnly = txtTotalDependents.ReadOnly =
        txtCurrentMarketValue.ReadOnly = txtRemainingLoanValue.ReadOnly = txtTotNetWorth.ReadOnly =
        txtDirectors.ReadOnly = txtSE.ReadOnly = txtPaidCapital.ReadOnly = txtfacevalue.ReadOnly = txtbookvalue.ReadOnly =
        txtBusinessProfile.ReadOnly = txtGeographical.ReadOnly = txtnobranch.ReadOnly = txtPercentageStake.ReadOnly =
        txtJVPartnerName.ReadOnly = txtJVPartnerStake.ReadOnly = txtCEOName.ReadOnly = txtCEOAge.ReadOnly = txtCEOexperience.ReadOnly =
            //txtResidentialAddress.ReadOnly = 
        txtAccountNumber.ReadOnly = txtBankAddress.ReadOnly = txtBankBranch.ReadOnly =
        txtBankName.ReadOnly = txtMICRCode.ReadOnly = true;
        //CalendarCEOWeddingDate.Enabled = false;
        CalendarWeddingdate.Enabled = false;
        //cmbIndustryCode.Items.Clear();
        cmbIndustryCode.ClearDropDownList();
        btnAdd.Enabled = btnModify.Enabled = btnClear.Enabled = btnSave.Enabled = false;
        /*Modified By prabhu on 16-Nov-2011 for CR (Default Account in Bank Details)*/
        grvBankDetails.Columns[11].Visible = false;
        if (gvTrack.Rows.Count > 0)
        {
            if (gvTrack.Columns[12] != null) gvTrack.Columns[12].Visible = false;
            //gvTrack.FooterRow.Visible = false;
        }
    }
    private void FunPriToggleModifyModeControls()
    {

    }


    #endregion

    #region Dropdown Events

    protected void ddlCustomerType_OnSelectedIndexChanged(object sender, EventArgs e)
    {
        try
        {
            FunPriToggleCustomerTypeControls();
            ddlCustomerType.Focus();
            grvBankDetails.DataSource = null;
            grvBankDetails.DataBind();

            //Added By Thangam M on 09/mar/2012 to fix bug id - 6031
            FunProIntializeData();
            //End
            ddlNationality.SelectedValue = "0";
            if (ddlCustomerType.SelectedItem.ToString().ToLower() == "non individual")
            {
                //rfvComEmail.Enabled = true;
                //rfvPerEmail.Enabled = true;
                txtCustomerName.ReadOnly = false;
                rvfCustomerName.Enabled = true;
                pnlCustdtls.Visible = false;
                FunPubBindSharsGrid();
                IndReqFieldValidate(false);
                NonIndReqFieldValidate(true);
                funPriLoadNonIndividualLoad();
            }
            else
            {
                txtCustomerName.ReadOnly = true;
                rvfCustomerName.Enabled = false;
                pnlCustdtls.Visible = true;
                IndReqFieldValidate(true);
                NonIndReqFieldValidate(false);
                funPriLoadIndividualLoad();
            }
            if (ddlCustomerType.SelectedIndex > 0)
            {
                ConstitutionBind();
            }            
            //upAddress.Update();
            //upPersonal.Update();
        }
        catch (Exception objException)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(objException, strPageName);
            cvCustomerMaster.ErrorMessage = Resources.LocalizationResources.CustomerTypeChangeError;
            cvCustomerMaster.IsValid = false;
        }
    }

    private void IndReqFieldValidate(Boolean Value)
    {
        rfvQualification.Enabled = Value;
        rfvProfession.Enabled = Value;
        rfvHouseType.Enabled = Value;
        rfvVisaNo.Enabled = Value;
        rfvLabourCardNo.Enabled = Value;
        rfvLabourCardDate.Enabled = Value;
        rfvLaborExpDate.Enabled = Value;
        rfvOccupation.Enabled = Value;
        rfvVIP.Enabled = Value;
    }

    private void NonIndReqFieldValidate(Boolean Value)
    {
        rfvPublic.Enabled = Value;
        rfvDirectors.Enabled = Value;
        rfvBusinessProfile.Enabled = Value;
        rfvGeographical.Enabled = Value;
        rfvOmaniStaff.Enabled = Value;
        rfvJVPartnerStake.Enabled = Value;
        rfvJVPartnerStake.Enabled = Value;
    }

    protected void ddlConstitutionName_OnSelectedIndexChanged(object sender, EventArgs e)
    {
        OrgMasterMgtServicesReference.OrgMasterMgtServicesClient objCustomerMasterClient = new OrgMasterMgtServicesReference.OrgMasterMgtServicesClient();
        try
        {

            if (Convert.ToInt16(ddlConstitutionName.SelectedValue) > 0)
            {
                S3GBusEntity.S3G_Status_Parameters ObjStatus = new S3G_Status_Parameters();
                ObjStatus.Option = 7;
                ObjStatus.Param1 = ddlConstitutionName.SelectedValue.ToString();
                gvConstitutionalDocuments.DataSource = objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus);
                gvConstitutionalDocuments.DataBind();

                //Added By Thangam on 12/Mar/2012 to fix bug id - 5451
                FunProClearUploader();

                ViewState["ConstitutionDocument"] = objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus);
                ddlConstitutionName.Focus();
                ObjStatus.Option = 787;
                ObjStatus.Param1 = intCompanyId.ToString();
                DataTable dtConsDocPath = objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus);
                if (dtConsDocPath == null)
                {
                    Utility.FunShowAlertMsg(this, "Define the spooling path in Document Path Setup for Consitution Document");
                    return;
                }
                if (dtConsDocPath.Rows.Count == 0)
                {
                    Utility.FunShowAlertMsg(this, "Define the spooling path in Document Path Setup for Consitution Document");
                    return;
                }
                ViewState["ConsDocPath"] = dtConsDocPath.Rows[0][0].ToString();
            }
            else
            {
                tcCustomerMaster.Tabs[3].Enabled = false;
            }
        }
        catch (Exception objException)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(objException, strPageName);
            cvCustomerMaster.ErrorMessage = Resources.LocalizationResources.ConstitutionChangeError;
            cvCustomerMaster.IsValid = false;
        }
        finally
        {
            objCustomerMasterClient.Close();
            //upConstitution.Update();
        }
    }

    protected void cmbGroupCode_OnTextChanged(object sender, EventArgs e)
    {
        try
        {

            //txtGroupName.Text = string.Empty;
            //txtGroupName.Focus();

            //DataTable dt = (DataTable)HttpContext.Current.Session["GroupDT"];

            //if (dt.Rows.Count > 0)
            //{
            //    string filterExpression = "Value = '" + cmbGroupCode.Text + "'";
            //    DataRow[] dtSuggestions = dt.Select(filterExpression);

            //    if (dtSuggestions.Length > 0)
            //    {
            //        txtGroupName.Text = dtSuggestions[0]["Description"].ToString();
            //        //txtGroupName.ReadOnly = true;
            //        txtGroupName.ReadOnly = false;
            //    }
            //    else
            //    {
            //        txtGroupName.ReadOnly = false;
            //    }
            //}
            //if (cmbGroupCode.Text == string.Empty)
            //{
            //    //txtGroupName.ReadOnly = false;
            //    txtGroupName.ReadOnly = true;
            //    txtGroupName.Text = string.Empty;
            //}


        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            cvCustomerMaster.ErrorMessage = Resources.LocalizationResources.GroupChangeError;
            cvCustomerMaster.IsValid = false;
        }
    }

    protected void cmbIndustryCode_OnTextChanged(object sender, EventArgs e)
    {
        //txtIndustryName.Text = string.Empty;
        //try
        //{
        //    DataTable dt = (DataTable)HttpContext.Current.Session["IndustryDT"];

        //    if (dt.Rows.Count > 0)
        //    {
        //        string filterExpression = "Value = '" + cmbIndustryCode.Text + "' and Company_Id = " + intCompanyId.ToString();
        //        DataRow[] dtSuggestions = dt.Select(filterExpression);
        //        if (dtSuggestions.Length > 0)
        //        {
        //            txtIndustryName.Text = dtSuggestions[0]["Description"].ToString();
        //            //txtIndustryName.ReadOnly = true;
        //            txtIndustryName.ReadOnly = false;
        //        }
        //        else
        //        {
        //            txtIndustryName.ReadOnly = false;
        //        }
        //    }
        //    if (cmbIndustryCode.Text == string.Empty)
        //    {
        //        //txtIndustryName.ReadOnly = false;
        //        txtIndustryName.ReadOnly = true;
        //        txtIndustryName.Text = string.Empty;
        //    }
        //    upIndustryCode.Update();
        //}
        //catch (Exception ex)
        //{
        //    ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
        //    cvCustomerMaster.ErrorMessage = "Due to Data Problem, Unable to Load the Industry Name";
        //    cvCustomerMaster.IsValid = false;
        //}
    }

    //protected void ddlPANum_SelectedIndexChanged(object sender, EventArgs e)
    //{
    //    try
    //    {
    //        ddlSANum.Items.Clear();
    //        DataSet dsContractNos = new DataSet();
    //        if (ViewState["dsContractNos"] != null)
    //        {
    //            dsContractNos = (DataSet)ViewState["dsContractNos"];
    //            dtSubContractNos = dsContractNos.Tables[1].Copy();
    //            if (dtSubContractNos.Rows.Count > 0)
    //            {
    //                DataRow[] drSANum = dtSubContractNos.Select("PANum='" + ddlPANum.SelectedValue + "'");
    //                if (drSANum.Length > 0)
    //                    ddlSANum.FillDataTable(drSANum.CopyToDataTable(), "SANum", "SANum");
    //            }
    //        }

    //    }
    //    catch (Exception objException)
    //    {
    //        ClsPubCommErrorLogDB.CustomErrorRoutine(objException, strPageName);
    //        cvCustomerMaster.ErrorMessage = "Error in loading sub contract no";
    //        cvCustomerMaster.IsValid = false;
    //    }
    //}
    #endregion

    #region Grid Events

    /// <summary>
    /// Disable the "Values" Control in Constitutional Document Tab
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    protected void gvConstitutionalDocuments_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        try
        {
            e.Row.Cells[0].Visible = false;
            if (e.Row.RowType == DataControlRowType.DataRow)
            {
                Label lblPath = e.Row.FindControl("myThrobber") as Label;
                LinkButton hlnkView = e.Row.FindControl("hlnkView") as LinkButton;
                CheckBox chkIsMandatory = e.Row.FindControl("chkIsMandatory") as CheckBox;
                CheckBox chkIsNeedImageCopy = e.Row.FindControl("chkIsNeedImageCopy") as CheckBox;
                //AjaxControlToolkit.AsyncFileUpload asyFileUpload = e.Row.FindControl("asyFileUpload") as AjaxControlToolkit.AsyncFileUpload;
                CheckBox chkCollected = e.Row.FindControl("chkCollected") as CheckBox;
                CheckBox chkScanned = e.Row.FindControl("chkScanned") as CheckBox;
                TextBox txtValues = e.Row.FindControl("txtValues") as TextBox;


                FileUpload flUpload = (FileUpload)e.Row.FindControl("flUpload");
                //Button btnDlg = (Button)e.Row.FindControl("btnDlg");
                //HiddenField hdnSelectedPath = (HiddenField)e.Row.FindControl("hdnSelectedPath");
                Label lblActualPath = (Label)e.Row.FindControl("lblActualPath");
                TextBox txtFileupld = e.Row.FindControl("txtFileupld") as TextBox;
                Button btnBrowse = (Button)e.Row.FindControl("btnBrowse");

                if (!chkIsNeedImageCopy.Checked)
                {
                    chkScanned.Enabled = false;
                }

                // AjaxControlToolkit.AsyncFileUpload AsyncFileUpload1 = (AjaxControlToolkit.AsyncFileUpload)e.Row.FindControl("asyFileUpload");
                if (lblActualPath != null)
                {
                    if (lblActualPath.Text.Trim() != "")
                    {
                        hlnkView.Enabled = true;
                    }
                    else
                    {
                        hlnkView.Enabled = false;
                    }
                }
                else
                {
                    hlnkView.Enabled = false;
                }

                if (!chkIsNeedImageCopy.Checked)
                {
                    txtFileupld.Visible =
                    flUpload.Visible = false;
                    hlnkView.Enabled = false;
                }



                TextBox txtVal = (TextBox)e.Row.FindControl("txtValues");
                // Commented By R. Manikandan Enable value field to enter the Remarks on 07-JAN-2013

                //if (txtVal != null)
                //{
                //    txtVal.Enabled = FunPriDisableValueField(e.Row.Cells[1].Text);
                //}
                if (!string.IsNullOrEmpty(Request.QueryString["qsMode"]))
                {
                    if (Request.QueryString["qsMode"].ToString() == "Q")
                    {
                        txtFileupld.Visible =
                    flUpload.Visible =
                        chkIsMandatory.Enabled = chkIsNeedImageCopy.Enabled = chkCollected.Enabled =
                            chkScanned.Enabled = txtValues.Enabled = false;
                    }
                }



                //flUpload.Attributes.Add("onchange", "fnAssignPath('" + flUpload.ClientID + "','" + hdnSelectedPath.ClientID + "', '" + btnBrowse.ClientID + "'); ");
                flUpload.Attributes.Add("onchange", "fnLoadPath('" + btnBrowse.ClientID + "'); ");

                //fnLoadPath('" + btnBrowse.ClientID + "');

            }
            //e.Row.Cells[11].Visible = false;

        }
        catch (Exception objException)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(objException, strPageName);
            cvCustomerMaster.ErrorMessage = "Unable to Toggle the Values in Constitution Document Details";
            cvCustomerMaster.IsValid = false;
        }
    }

    //Added by Thangam M on 12/Mar/2012 to fix bug id - 5451
    private void FunPriClearUploader(AjaxControlToolkit.AsyncFileUpload Uploader)
    {
        if (Uploader != null)
        {
            HttpContext crntContext;
            if (HttpContext.Current != null && HttpContext.Current.Session != null)
            {
                crntContext = HttpContext.Current;
            }
            else
            {
                crntContext = null;
            }
            if (crntContext != null)
            {
                foreach (string key in crntContext.Session.Keys)
                {
                    if (key.Contains(Uploader.ClientID))
                    {
                        crntContext.Session.Remove(key);
                    }
                }
            }
        }
    }

    //Added by Thangam M on 12/Mar/2012 to fix bug id - 5451
    protected void FunProClearUploader()
    {
        try
        {
            if (gvConstitutionalDocuments.Rows.Count > 0)
            {
                for (int i = 0; i <= gvConstitutionalDocuments.Rows.Count - 1; i++)
                {
                    LinkButton hlnkView = gvConstitutionalDocuments.Rows[i].FindControl("hlnkView") as LinkButton;
                    AjaxControlToolkit.AsyncFileUpload AsyncFileUpload1 = (AjaxControlToolkit.AsyncFileUpload)gvConstitutionalDocuments.Rows[i].FindControl("asyFileUpload");
                    FunPriClearUploader(AsyncFileUpload1);
                }

                ScriptManager.RegisterStartupScript(this, this.GetType(), "Clear", "javascript:fnClearAsyncUploader('" + gvConstitutionalDocuments.Rows.Count.ToString() + "');", true);

            }
        }
        catch (Exception)
        {

        }
    }

    protected void gvCustomerTrack_RowDataBound(object sender, System.Web.UI.WebControls.GridViewRowEventArgs e)
    {
        try
        {
            if (e.Row.RowType == DataControlRowType.DataRow)
            {
                DropDownList ddlType = (DropDownList)e.Row.FindControl("ddlType");
                OrgMasterMgtServicesReference.OrgMasterMgtServicesClient objCustomerMasterClient = new OrgMasterMgtServicesReference.OrgMasterMgtServicesClient();
                S3GBusEntity.S3G_Status_Parameters ObjStatus = new S3G_Status_Parameters();
                ObjStatus.Option = 1;
                ObjStatus.Param1 = S3G_Statu_Lookup.CATEGORY_TYPE.ToString();
                Utility.FillDLL(ddlType, objCustomerMasterClient.FunPub_GetS3GStatusLookUp(ObjStatus));

                if (ViewState["CustomerTrackDetails"] != null)
                {
                    DataTable dtCustomerTrack = (DataTable)ViewState["CustomerTrackDetails"];
                    ddlType.SelectedValue = dtCustomerTrack.Rows[e.Row.RowIndex]["TRACK_TYPE_ID"].ToString();
                    if (dtCustomerTrack.Rows[e.Row.RowIndex]["RELEASEDBY"].ToString() == "")
                    {
                        Label lblReleasedBy = (Label)e.Row.FindControl("lblReleasedBy");
                        lblReleasedBy.Text = intUserId.ToString();
                        e.Row.Cells[10].Text = ObjUserInfo.ProUserNameRW;
                    }
                }

            }
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            throw ex;
        }
    }
    protected void gvCustomerTrack_RowCreated(object sender, GridViewRowEventArgs e)
    {
        try
        {
            if (e.Row.RowType == DataControlRowType.DataRow)
            {
                TextBox txtDate = e.Row.FindControl("txtDate") as TextBox;
                txtDate.Attributes.Add("readonly", "readonly");
                AjaxControlToolkit.CalendarExtender CalendarDate = e.Row.FindControl("CalendarDate") as AjaxControlToolkit.CalendarExtender;
                CalendarDate.Format = ObjS3GSession.ProDateFormatRW;

                TextBox txtReleaseDate = e.Row.FindControl("txtReleaseDate") as TextBox;
                txtReleaseDate.Attributes.Add("readonly", "readonly");
                AjaxControlToolkit.CalendarExtender CalendarReleaseDate = e.Row.FindControl("CalendarReleaseDate") as AjaxControlToolkit.CalendarExtender;
                CalendarReleaseDate.Format = ObjS3GSession.ProDateFormatRW;
            }
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex);
            cvCustomerMaster.ErrorMessage = "Due to Data Problem,Unable to Set the DateFormat in Customer Track Details";
            cvCustomerMaster.IsValid = false;
        }
    }

    #endregion

    #region TextBox Events

    /// <summary>
    /// Assign the Age field while DOB Changing 
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    protected void txtDOB_OnTextChanged(object sender, EventArgs e)
    {
        try
        {
            txtAge.Text = string.Empty;
            if (!string.IsNullOrEmpty(txtDOB.Text))
            {
                int intDOBYear = Utility.StringToDate(txtDOB.Text).Year;
                txtAge.Text = ((DateTime.Now.Year - intDOBYear) + 1).ToString();
            }
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            cvCustomerMaster.ErrorMessage = Resources.LocalizationResources.AgeCalculateError;
            cvCustomerMaster.IsValid = false;
        }
    }
    #endregion

    #region Bank Details Tab
    protected void FunProIntializeData()
    {
        DataTable dtBankViewDetails = new DataTable("BankDetails");
        try
        {
            dtBankViewDetails.Columns.Add("AccountType");
            dtBankViewDetails.Columns.Add("AccountType_ID");
            dtBankViewDetails.Columns.Add("Account_Number");
            dtBankViewDetails.Columns.Add("Bank_Name");
            dtBankViewDetails.Columns.Add("Branch_Name");
            dtBankViewDetails.Columns.Add("IFSC_Code");
            dtBankViewDetails.Columns.Add("PANum");
            dtBankViewDetails.Columns.Add("SANum");
            dtBankViewDetails.Columns.Add("MICR_Code");
            dtBankViewDetails.Columns.Add("Bank_Address");
            dtBankViewDetails.Columns.Add("BankMapping_ID");
            dtBankViewDetails.Columns.Add("Master_ID");
            dtBankViewDetails.Columns.Add("IsDefaultAccount", typeof(bool));
            dtBankViewDetails.Columns[4].Unique = true;
            ViewState["DetailsTable"] = dtBankViewDetails;
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            throw new ApplicationException("Unable to Initialize the Data for BankDetails");
        }
    }

    protected void btnAdd_Click(object sender, EventArgs e)
    {
        try
        {
            if (txtBankAddress.Text.Length > 300)
            {
                ScriptManager.RegisterStartupScript(this, this.GetType(), "Followup Details", "alert('Bank Address Length should be less than or equal to 300');", true);
                tcCustomerMaster.ActiveTabIndex = 2;
                return;
            }
            DataRow drDetails;
            DataTable dtBankDetails = (DataTable)ViewState["DetailsTable"];
            /*Modified By prabhu on 16-Nov-2011 for CR (Default Account in Bank Details)*/
            DataRow[] drDefault = dtBankDetails.Select("IsDefaultAccount = 'True'");
            //if (drDefault.Length > 0 && chkDefaultAccount.Checked)
            //{
            //    Utility.FunShowAlertMsg(this, "Only one Default Account is applicable to particular Customer");
            //    return;
            //}

            if (dtBankDetails.Rows.Count < 10)
            {
                drDetails = dtBankDetails.NewRow();
                string strBankMapId = Convert.ToString(dtBankDetails.Rows.Count + 1);
                drDetails["BankMapping_ID"] = strBankMapId;
                drDetails["Master_ID"] = "0";
                drDetails["AccountType"] = ddlAccountType.SelectedItem.Text;
                drDetails["AccountType_ID"] = ddlAccountType.SelectedItem.Value;
                drDetails["Account_Number"] = txtAccountNumber.Text.Trim();
                drDetails["Bank_Name"] = txtBankName.Text.Trim();
                drDetails["Branch_Name"] = txtBankBranch.Text.Trim();
                drDetails["MICR_Code"] = txtMICRCode.Text.Trim();
                drDetails["Bank_Address"] = txtBankAddress.Text.Trim();
                /*Modified By prabhu on 16-Nov-2011 for CR (Default Account in Bank Details)*/
                drDetails["IsDefaultAccount"] = chkDefaultAccount.Checked;

                drDetails["IFSC_Code"] = txtIFSC_Code.Text.Trim();
                //if (ddlPANum.SelectedIndex > 0)
                //    drDetails["PANum"] = ddlPANum.SelectedValue;
                //if (ddlSANum.SelectedIndex > 0)
                //    drDetails["SANum"] = ddlSANum.SelectedValue;



                dtBankDetails.Rows.Add(drDetails);
                grvBankDetails.DataSource = dtBankDetails;
                grvBankDetails.DataBind();
                FunPriHideBankColumns();
                ViewState["DetailsTable"] = dtBankDetails;
                ClearBankDetailsControls();

            }
            else
            {
                ScriptManager.RegisterStartupScript(this, this.GetType(), "Bank Details", "alert('Customer Bank Details should be less than or equal to 9 Banks');", true);
            }

        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            cvCustomerMaster.ErrorMessage = "Due to Data Problem, Unable to Add Bank Details";
            cvCustomerMaster.IsValid = false;
        }
    }

    protected void btnModify_Click(object sender, EventArgs e)
    {
        try
        {
            if (txtBankAddress.Text.Length > 300)
            {
                ScriptManager.RegisterStartupScript(this, this.GetType(), "Followup Details", "alert('Bank Address Length should be less than or equal to 300');", true);
                tcCustomerMaster.ActiveTabIndex = 2;
                return;
            }
            DataTable dtBankDetails = (DataTable)ViewState["DetailsTable"];
            /*Modified By prabhu on 16-Nov-2011 for CR (Default Account in Bank Details)*/
            DataRow[] drDefault = dtBankDetails.Select("IsDefaultAccount = 'True' and BankMapping_ID <> '" + hdnBankId.Value + "'");
            //if (drDefault.Length > 0 && chkDefaultAccount.Checked)
            //{
            //    Utility.FunShowAlertMsg(this, "Only one Default Account is applicable to particular Customer");
            //    return;
            //}
            DataView dvBankdetails = dtBankDetails.DefaultView;
            dvBankdetails.Sort = "BankMapping_ID";
            int rowindex = dvBankdetails.Find(hdnBankId.Value);
            dvBankdetails[rowindex].Row["AccountType"] = ddlAccountType.SelectedItem.Text;
            dvBankdetails[rowindex].Row["AccountType_ID"] = ddlAccountType.SelectedItem.Value;
            dvBankdetails[rowindex].Row["Account_Number"] = txtAccountNumber.Text.Trim();
            dvBankdetails[rowindex].Row["Bank_Name"] = txtBankName.Text.Trim();
            dvBankdetails[rowindex].Row["Branch_Name"] = txtBankBranch.Text.Trim();


            dvBankdetails[rowindex].Row["IFSC_Code"] = txtIFSC_Code.Text.Trim();
            //if (ddlPANum.SelectedIndex > 0)
            //    dvBankdetails[rowindex].Row["PANum"] = ddlPANum.SelectedValue;
            //if (ddlSANum.SelectedIndex > 0)
            //    dvBankdetails[rowindex].Row["SANum"] = ddlSANum.SelectedValue;


            dvBankdetails[rowindex].Row["MICR_Code"] = txtMICRCode.Text.Trim();
            dvBankdetails[rowindex].Row["Bank_Address"] = txtBankAddress.Text.Trim();
            /*Modified By prabhu on 16-Nov-2011 for CR (Default Account in Bank Details)*/
            dvBankdetails[rowindex].Row["IsDefaultAccount"] = chkDefaultAccount.Checked;
            grvBankDetails.DataSource = dvBankdetails;
            grvBankDetails.DataBind();
            FunPriHideBankColumns();
            ViewState["DetailsTable"] = dvBankdetails.Table;
            ClearBankDetailsControls();
            btnAdd.Enabled = true;
            btnModify.Enabled = false;
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            cvCustomerMaster.ErrorMessage = "Due to Data Problem, Unable to Modify the Bank Details";
            cvCustomerMaster.IsValid = false;

        }
    }

    protected void ClearBankDetailsControls()
    {
        try
        {
            ddlAccountType.SelectedIndex = 0;
            txtAccountNumber.Text = "";
            txtBankName.Text = "";
            txtBankBranch.Text = "";
            txtMICRCode.Text = "";
            txtBankAddress.Text = "";
            /*Modified By prabhu on 16-Nov-2011 for CR (Default Account in Bank Details)*/
            chkDefaultAccount.Checked = false;

            txtIFSC_Code.Text = string.Empty;
            //if (ddlSANum.Items.Count > 0)
            //    ddlSANum.Items.Clear();
            //ddlPANum.SelectedIndex = -1;
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            throw ex;
        }
    }

    protected void btnBnkClear_Click(object sender, EventArgs e)
    {
        try
        {

            ddlAccountType.SelectedIndex = 0;
            txtAccountNumber.Text = "";
            txtBankName.Text = "";
            txtBankBranch.Text = "";
            txtMICRCode.Text = "";
            txtBankAddress.Text = "";
            hdnBankId.Value = "";
            btnAdd.Enabled = true;
            btnModify.Enabled = false;
            /*Modified By prabhu on 16-Nov-2011 for CR (Default Account in Bank Details)*/
            chkDefaultAccount.Checked = false;

            txtIFSC_Code.Text = string.Empty;
            //if (ddlSANum.Items.Count > 0)
            //    ddlSANum.Items.Clear();
            //ddlPANum.SelectedIndex = -1;
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            cvCustomerMaster.ErrorMessage = "Unable to Clear the Data in Bank Details";
            cvCustomerMaster.IsValid = false;
        }
    }

    protected void grvBankDetails_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        try
        {
            if (strMode != "Q")
            {
                if (e.Row.RowType == DataControlRowType.DataRow)
                {
                    /* For Deleting purpose, Restrcit to add attribute to the Cell Remove linkbutton*/
                    for (int intCellIndex = 0; intCellIndex < e.Row.Cells.Count - 2; intCellIndex++)
                    {
                        e.Row.Cells[intCellIndex].Attributes["onclick"] = ClientScript.GetPostBackClientHyperlink
                        (this.grvBankDetails, "Select$" + e.Row.RowIndex);
                    }
                    e.Row.Attributes["onmouseover"] = "javascript:setMouseOverColor(this);";
                    e.Row.Attributes["onmouseout"] = "javascript:setMouseOutColor(this);";

                }
            }
            if (strMode == "Q" && e.Row.RowType == DataControlRowType.DataRow)
            {
                TextBox lblBankAddress = e.Row.FindControl("lblBankAddress") as TextBox;
                lblBankAddress.Enabled = true;
                lblBankAddress.ReadOnly = true;
            }
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            throw new ApplicationException("Unable to Load the Bank Details");
        }
    }

    protected void grvBankDetails_RowDeleting(object sender, GridViewDeleteEventArgs e)
    {
        try
        {
            DataTable dtDelete = (DataTable)ViewState["DetailsTable"];
            dtDelete.Rows.RemoveAt(e.RowIndex);
            grvBankDetails.DataSource = dtDelete;
            grvBankDetails.DataBind();
            FunPriHideBankColumns();
            ViewState["DetailsTable"] = dtDelete;
            ClearBankDetailsControls();
            if (grvBankDetails.Rows.Count == 0)
            {

                btnAdd.Enabled = true;
                btnModify.Enabled = false;
            }
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            cvCustomerMaster.ErrorMessage = "Due to Data Problem, Unable to Remove Bank Details";
            cvCustomerMaster.IsValid = false;
        }
    }

    protected void grvBankDetails_SelectedIndexChanged(object sender, EventArgs e)
    {
        try
        {

            Label lblBankMappingId = grvBankDetails.SelectedRow.FindControl("lblBankMappingId") as Label;
            Label lblMasterId = grvBankDetails.SelectedRow.FindControl("lblMasterId") as Label;
            Label lblAccountType = grvBankDetails.SelectedRow.FindControl("lblAccountType") as Label;
            Label lblAccountTypeId = grvBankDetails.SelectedRow.FindControl("lblAccountTypeId") as Label;
            TextBox lblBankAddress = grvBankDetails.SelectedRow.FindControl("lblBankAddress") as TextBox;
            /*Modified By prabhu on 16-Nov-2011 for CR (Default Account in Bank Details)*/
            CheckBox chkGridDefaultAccount = grvBankDetails.SelectedRow.FindControl("chkDefaultAccount") as CheckBox;

            ddlAccountType.SelectedValue = lblAccountTypeId.Text;
            if (grvBankDetails.SelectedRow.Cells[5].Text != "&nbsp;")
                txtAccountNumber.Text = Convert.ToString(grvBankDetails.SelectedRow.Cells[5].Text);
            if (grvBankDetails.SelectedRow.Cells[9].Text != "&nbsp;")
                txtMICRCode.Text = Convert.ToString(grvBankDetails.SelectedRow.Cells[9].Text);
            if (grvBankDetails.SelectedRow.Cells[10].Text != "&nbsp;")
                txtBankName.Text = Convert.ToString(grvBankDetails.SelectedRow.Cells[10].Text);
            if (grvBankDetails.SelectedRow.Cells[11].Text != "&nbsp;")
                txtBankBranch.Text = Convert.ToString(grvBankDetails.SelectedRow.Cells[11].Text);
            txtBankAddress.Text = lblBankAddress.Text;
            hdnBankId.Value = lblBankMappingId.Text;
            /*Modified By prabhu on 16-Nov-2011 for CR (Default Account in Bank Details)*/
            chkDefaultAccount.Checked = chkGridDefaultAccount.Checked;
            if (grvBankDetails.SelectedRow.Cells[6].Text != "&nbsp;")
                txtIFSC_Code.Text = Convert.ToString(grvBankDetails.SelectedRow.Cells[6].Text);//IFSC Code
            //ddlPANum.SelectedIndex = -1;
            //if (!string.IsNullOrEmpty(grvBankDetails.SelectedRow.Cells[7].Text))
            //{
            //    if (grvBankDetails.SelectedRow.Cells[7].Text != "&nbsp;")
            //        ddlPANum.SelectedValue = Convert.ToString(grvBankDetails.SelectedRow.Cells[7].Text);
            //}
            //ddlSANum.Items.Clear();
            //if (!string.IsNullOrEmpty(grvBankDetails.SelectedRow.Cells[8].Text))
            //{
            //    if (grvBankDetails.SelectedRow.Cells[8].Text != "&nbsp;")
            //    {
            //        ddlPANum_SelectedIndexChanged(null, null);
            //        ddlSANum.SelectedValue = Convert.ToString(grvBankDetails.SelectedRow.Cells[8].Text);
            //    }
            //}
            btnAdd.Enabled = false;
            btnModify.Enabled = true;

        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            cvCustomerMaster.ErrorMessage = "Due to Data Problem,Unable to view the Bank Details";
            cvCustomerMaster.IsValid = false;
        }
    }

    #endregion

    protected void asyncFileUpload_UploadedComplete(object sender, AjaxControlToolkit.AsyncFileUploadEventArgs e)
    {

    }

    private void FunPriCopyCommuncationAddress()
    {

        //if (txtPerState.Items.Contains(new ListItem((txtComState.SelectedItem.Text), (txtComState.SelectedItem.Text))))// && txtComState.SelectedItem.Text.Trim() != "")
        //{
        //    txtPerState.Items.Add(new ListItem((txtComState.SelectedItem.Text), (txtComState.SelectedItem.Text)));
        //}

        //if (txtPerCountry.Items.Contains(new ListItem((txtComCountry.SelectedItem.Text), (txtComCountry.SelectedItem.Text))))// && txtComCountry.SelectedItem.Text.Trim() != "")
        //{
        //    txtPerCountry.Items.Add(new ListItem((txtComCountry.SelectedItem.Text), (txtComCountry.SelectedItem.Text)));
        //}        
        //txtPerAddress1.Text = txtComAddress1.Text;
        //txtPerAddress2.Text = txtCOmAddress2.Text;        
        //txtPerCity.SelectedValue = txtComCity.SelectedValue;       
        //if (txtComState.SelectedItem.Value == "0")
        //{
        //    txtPerState.SelectedIndex = 0;
        //}
        //else
        //{
        //    txtPerState.SelectedValue = txtComState.SelectedValue;
        //}

        //if (txtComCountry.SelectedItem.Value == "0")
        //{
        //    txtPerCountry.SelectedIndex = 0;
        //}
        //else
        //{
        //    txtPerCountry.SelectedItem.Text = txtComCountry.SelectedItem.Text;
        //}
        //txtPerTelephone.Text = txtComTelephone.Text;
        //txtPerPincode.Text = txtComPincode.Text;
        //txtPerMobile.Text = txtComMobile.Text;
        //txtPerEmail.Text = txtComEmail.Text;
        //txtPerWebSite.Text = txtComWebsite.Text;
    }

    protected void btnCopyAddress_Click(object sender, EventArgs e)
    {
        FunPriCopyCommuncationAddress();
    }
    protected void gvCredit_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        if (gvCredit.DataSource != null && ((DataTable)gvCredit.DataSource).Rows.Count > 0)
        {
            if (e.Row.Cells[1] != null && e.Row.Cells[1].Text != string.Empty)
            {
                e.Row.Cells[1].HorizontalAlign = HorizontalAlign.Right;
            }
            if (e.Row.Cells[2] != null && e.Row.Cells[2].Text != string.Empty)
            {
                e.Row.Cells[2].HorizontalAlign = HorizontalAlign.Right;
            }
            if (e.Row.Cells[3] != null && e.Row.Cells[3].Text != string.Empty)
            {
                e.Row.Cells[3].HorizontalAlign = HorizontalAlign.Right;
            }
            if (e.Row.Cells[4] != null && e.Row.Cells[4].Text != string.Empty)
            {
                e.Row.Cells[4].HorizontalAlign = HorizontalAlign.Right;
            }


        }

    }


    private void FunPriLoadEnquiryDetails(int intEnquiryNumber)
    {
        Procparam = new Dictionary<string, string>();
        Procparam.Add("@Company_ID", intCompanyId.ToString());
        Procparam.Add("@EnquiryResponse_ID", intEnquiryNumber.ToString());
        DataTable dt = Utility.GetDefaultData("S3G_ORG_GETENQUIRYDETAILSFORPRICING", Procparam);
        txtCustomerName.Text = dt.Rows[0]["Customer_Name"].ToString();
        //txtComAddress1.Text = dt.Rows[0]["Address"].ToString();
        //txtCOmAddress2.Text = dt.Rows[0]["Address2"].ToString();        
        //txtComCity.SelectedValue = dt.Rows[0]["City"].ToString();
        //txtComTelephone.Text = dt.Rows[0]["TELNO"].ToString();
        //txtComWebsite.Text = dt.Rows[0]["WEBSITE"].ToString();        
        //txtComState.SelectedValue = txtComState.Items.FindByText(dt.Rows[0]["State"].ToString()).Value;
        //txtComCountry.SelectedItem.Text = dt.Rows[0]["Country"].ToString();
        //txtComCountry.SelectedValue = txtComCountry.Items.FindByText(dt.Rows[0]["Country"].ToString()).Value;
        //txtPerCountry.SelectedItem.Text = dt.Rows[0]["Country"].ToString();
        //txtPerCountry.SelectedValue = txtComCountry.Items.FindByText(dt.Rows[0]["Country"].ToString()).Value;       
        //txtComPincode.Text = dt.Rows[0]["PINCode_ZipCode"].ToString();
        //txtComMobile.Text = dt.Rows[0]["Mobile"].ToString();
        //txtComEmail.Text = dt.Rows[0]["EMail"].ToString();
        ddlConstitutionName.SelectedValue = dt.Rows[0]["Constitution_ID"].ToString();
        chkCustomer.Checked = true;
        ddlConstitutionName_OnSelectedIndexChanged(this, new EventArgs());
    }


    #region ""

    protected void btnBrowse_OnClick(object sender, EventArgs e)
    {
        int intRowIndex = Utility.FunPubGetGridRowID("gvConstitutionalDocuments", ((Button)sender).ClientID);

        HttpFileCollection hfc = Request.Files;
        for (int i = 0; i < hfc.Count; i++)
        {
            HttpPostedFile hpf = hfc[i];
            if (hpf.ContentLength > 0)
            {
                CheckBox chkScanned = (CheckBox)gvConstitutionalDocuments.Rows[intRowIndex].FindControl("chkScanned");
                HiddenField hdnSelectedPath = (HiddenField)gvConstitutionalDocuments.Rows[intRowIndex].FindControl("hdnSelectedPath");
                FileUpload flUpload = (FileUpload)gvConstitutionalDocuments.Rows[intRowIndex].FindControl("flUpload");
                //Label lblActualPath = (Label)gvConstitutionalDocuments.Rows[intRowIndex].FindControl("lblActualPath");
                TextBox txtFileupld = (TextBox)gvConstitutionalDocuments.Rows[intRowIndex].FindControl("txtFileupld");

                //chkSelect.Checked = true;
                //chkScanned.ToolTip = flUpload.ToolTip = hdnSelectedPath.Value;
                //lblActualPath.Text = hpf.FileName;
                txtFileupld.Text = hpf.FileName;
                string strViewst = "File" + intRowIndex.ToString();
                Cache[strViewst] = hpf;
            }
        }
    }

    protected void chkScanned_CheckedChanged(object sender, EventArgs e)
    {
        int intRowIndex = Utility.FunPubGetGridRowID("gvConstitutionalDocuments", ((CheckBox)sender).ClientID);
        CheckBox chkScanned = (CheckBox)gvConstitutionalDocuments.Rows[intRowIndex].FindControl("chkScanned");
        Label lblActualPath = (Label)gvConstitutionalDocuments.Rows[intRowIndex].FindControl("lblActualPath");
        TextBox txtFileupld = (TextBox)gvConstitutionalDocuments.Rows[intRowIndex].FindControl("txtFileupld");
        //Button btnBrowse = (Button)gvConstitutionalDocuments.Rows[intRowIndex].FindControl("btnBrowse");

        if (!chkScanned.Checked)
        {
            lblActualPath.Text =
               txtFileupld.Text = string.Empty;
        }


    }

    protected void FunProUploadFilesNew()
    {
        try
        {
            for (int i = 0; i <= gvConstitutionalDocuments.Rows.Count - 1; i++)
            {
                string strViewst = "File" + i.ToString();
                CheckBox chkScanned = (CheckBox)gvConstitutionalDocuments.Rows[i].FindControl("chkScanned");
                Label lblCurrentPath = (Label)gvConstitutionalDocuments.Rows[i].FindControl("lblActualPath");

                if (chkScanned.Checked)
                {
                    HttpPostedFile hpf = (HttpPostedFile)Cache[strViewst];
                    //string strServerPath = Server.MapPath(".").Replace("\\LoanAdmin", "");
                    //string strFilePath = "\\Data\\Invoice\\" + intCompanyId.ToString() + "_" + ddlMLA.SelectedText.Replace("/", "");

                    //if (!System.IO.Directory.Exists(strServerPath + strFilePath))
                    //{
                    //    System.IO.Directory.CreateDirectory(strServerPath + strFilePath);
                    //}

                    //if (ddlSLA.SelectedValue.ToString() != "0")
                    //{
                    //    strFilePath = strFilePath + @"\" + ddlSLA.SelectedItem.ToString().Replace("/", "") + "_" + (i + 1).ToString() + "_" + System.IO.Path.GetFileName(hpf.FileName).Replace("%20", "_").Replace(" ", "_");
                    //}
                    //else
                    //{
                    //    strFilePath = strFilePath + @"\" + (i + 1).ToString() + "_" + System.IO.Path.GetFileName(hpf.FileName).Replace("%20", "_").Replace(" ", "_");
                    //}

                    string strNewFileName = @"\COMPANY" + intCompanyId.ToString();
                    string strPath = "";
                    //if (txOD.Text != "")
                    //{
                    strPath = strNewFileName;
                    strPath = Convert.ToString(ViewState["ConsDocPath"]) + strNewFileName;

                    if (!Directory.Exists(strPath))
                    {
                        Directory.CreateDirectory(strPath);
                    }

                    if (hpf != null)
                    {
                        strPath += @"\" + System.IO.Path.GetFileName(hpf.FileName).Split('.')[0].ToString() + DateTime.Now.ToLocalTime().ToString().Replace(" ", "").Replace("/", "").Replace(":", "") + "." + System.IO.Path.GetFileName(hpf.FileName).Split('.')[1].ToString();
                        lblCurrentPath.Text = strPath;
                        hpf.SaveAs(strPath);
                    }
                }
            }
        }
        catch (Exception ex)
        {

        }
    }

    private void FunPriUploadFiles()
    {
        try
        {


            foreach (GridViewRow grv in gvConstitutionalDocuments.Rows)
            {
                AjaxControlToolkit.AsyncFileUpload AsyncFileUpload1 = (AjaxControlToolkit.AsyncFileUpload)grv.FindControl("asyFileUpload");
                TextBox txOD = grv.FindControl("txOD") as TextBox;

                if (AsyncFileUpload1.FileName != "")
                {
                    FileInfo fileInfo = new FileInfo(AsyncFileUpload1.FileName);
                    if (AsyncFileUpload1.HasFile)
                    {

                        string strNewFileName = @"\COMPANY" + intCompanyId.ToString();
                        string strPath = "";
                        //if (txOD.Text != "")
                        //{
                        strPath = strNewFileName;
                        strPath = Convert.ToString(ViewState["ConsDocPath"]) + strNewFileName;
                        if (!Directory.Exists(strPath))
                        {
                            Directory.CreateDirectory(strPath);
                        }

                        strPath += @"\" + AsyncFileUpload1.FileName.Split('.')[0].ToString() + DateTime.Now.ToLocalTime().ToString().Replace(" ", "").Replace("/", "").Replace(":", "") + "." + AsyncFileUpload1.FileName.Split('.')[1].ToString();
                        //}
                        txOD.Text = strPath;

                        AsyncFileUpload1.SaveAs(strPath);
                    }
                }
            }
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            throw new ApplicationException("PRDD Master Document Path does not exist");
        }
    }

    protected void FunProClearCaches()
    {
        for (int i = 0; i <= gvConstitutionalDocuments.Rows.Count - 1; i++)
        {
            string strViewst = "File" + i.ToString();
            if (Cache[strViewst] != null)
            {
                Cache.Remove(strViewst);
            }
        }
    }

    //protected void FunSetCompanyCountryName()
    //{

    //    Procparam = new Dictionary<string, string>();
    //    Procparam.Add("@Param1", intCompanyId.ToString());
    //    Procparam.Add("@Option", "1000");
    //    DataTable dt = Utility.GetDefaultData("S3G_ORG_GetCustomerLookUp", Procparam);
    //    if (dt.Rows.Count > 0)
    //    {
    //        txtPerCountry.Text = txtComCountry.Text = dt.Rows[0]["COUNTRY"].ToString();
    //    }
    //}
    #endregion

    protected void grvCustSubLimit_RowCommand(object sender, GridViewCommandEventArgs e)
    {
        try
        {
            if (e.CommandName == "Add")
            {
                Label lblSerialNo = grvCustSubLimit.FooterRow.FindControl("lblSerialNo") as Label;
                DropDownList ddlEntityTypeF = grvCustSubLimit.FooterRow.FindControl("ddlEntityTypeF") as DropDownList;
                TextBox txtLimitF = grvCustSubLimit.FooterRow.FindControl("txtLimitF") as TextBox;
                TextBox txtCutOffDateF = grvCustSubLimit.FooterRow.FindControl("txtCutOffDateF") as TextBox;
                FunPriInsertCustSubLimit(lblSerialNo.Text, ddlEntityTypeF.SelectedValue, ddlEntityTypeF.SelectedItem.Text, txtLimitF.Text.Trim(), txtCutOffDateF.Text.Trim());
            }
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
        }
    }


    protected void grvCustSubLimit_RowDeleting(object sender, GridViewDeleteEventArgs e)
    {
        try
        {

            dtCustSubLimit = FunPriGetSubLimitDataTable();
            if (dtCustSubLimit.Rows.Count == 1)
            {
                Utility.FunShowAlertMsg(this.Page, "There should be atleast one row in the grid");
                return;
            }
            dtCustSubLimit.Rows.RemoveAt(e.RowIndex);
            ViewState["CUST_SUBLIMIT"] = dtCustSubLimit;
            FunPriFillGrid();

        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
        }
    }

    protected void grvCustSubLimit_RowEditing(object sender, GridViewEditEventArgs e)
    {
        try
        {
            grvCustSubLimit.EditIndex = e.NewEditIndex;
            FunPriFillGrid();
            DropDownList ddlEntityTypeE = grvCustSubLimit.Rows[e.NewEditIndex].FindControl("ddlEntityTypeE") as DropDownList;
            TextBox txtCutOffDateE = grvCustSubLimit.Rows[e.NewEditIndex].FindControl("txtCutOffDateE") as TextBox;
            AjaxControlToolkit.CalendarExtender CECutoffDate = grvCustSubLimit.Rows[e.NewEditIndex].FindControl("CalendarExtenderCuttOffDateE") as AjaxControlToolkit.CalendarExtender;
            CECutoffDate.Format = strDateFormat;

            txtCutOffDateE.Attributes.Add("onblur", "fnDoDate(this,'" + txtDOB.ClientID + "','" + strDateFormat + "',true,false);");

            txtCutOffDateE.Text = DateTime.Parse(txtCutOffDateE.Text.ToString(), CultureInfo.CurrentCulture.DateTimeFormat).ToString(strDateFormat);
            FunPubLoadEntityType(ddlEntityTypeE);

            ddlEntityTypeE.SelectedValue = ((DataTable)ViewState["CUST_SUBLIMIT"]).Rows[e.NewEditIndex]["Entity_Id"].ToString();

        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
        }
    }

    protected void grvCustSubLimit_RowUpdating(object sender, GridViewUpdateEventArgs e)//Added By Sathish
    {
        try
        {
            DataTable dtEditApprDet = (DataTable)ViewState["CUST_SUBLIMIT"];
            int IEditIndex = 0;
            IEditIndex = e.RowIndex;
            DropDownList ddlEntityTypeE = (DropDownList)grvCustSubLimit.Rows[e.RowIndex].FindControl("ddlEntityTypeE");
            TextBox txtLimitAmntE = (TextBox)grvCustSubLimit.Rows[e.RowIndex].FindControl("txtLimitAmntE");
            TextBox txtCutOffDateE = (TextBox)grvCustSubLimit.Rows[e.RowIndex].FindControl("txtCutOffDateE");
            DataTable dt = (DataTable)ViewState["CUST_SUBLIMIT"];
            if (dt.Rows.Count > 0)
            {
                DataRow[] drDupCheck = dt.Select("Entity_Id<>'" + ddlEntityTypeE.SelectedValue + "'");
                if (drDupCheck.Count() > 0)
                {
                    DataRow[] drDupCheck2 = drDupCheck.CopyToDataTable().Select("Entity_Id='" + ddlEntityTypeE.SelectedValue + "'");
                    if (drDupCheck2.Count() > 0)
                    {
                        Utility.FunShowAlertMsg(this, "Supplier already Added");
                        return;
                    }
                }
            }
            dtEditApprDet.Rows[IEditIndex]["Entity_Id"] = ddlEntityTypeE.SelectedValue;
            dtEditApprDet.Rows[IEditIndex]["ENTITY_NAME"] = ddlEntityTypeE.SelectedItem.Text;
            dtEditApprDet.Rows[IEditIndex]["Limit"] = txtLimitAmntE.Text;
            dtEditApprDet.Rows[IEditIndex]["CuttOffDate"] = Utility.StringToDate(txtCutOffDateE.Text);
            ViewState["CUST_SUBLIMIT"] = dtEditApprDet;
            grvCustSubLimit.EditIndex = -1;
            FunPriFillGrid();
        }
        catch (Exception ex)
        {
        }
    }

    protected void grvCustSubLimit_RowCancelingEdit(object sender, GridViewCancelEditEventArgs e)
    {
        try
        {
            grvCustSubLimit.EditIndex = -1;
            FunPriFillGrid();
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
        }
    }
    private void FunPriInsertCustSubLimit(string strSno, string strEntityId, string strEntityName, string strEntityLimit, string strCuttoffDate)
    {
        try
        {
            DataTable dt = (DataTable)ViewState["CUST_SUBLIMIT"];
            if (ViewState["CUST_SUBLIMIT"] != null)
            {
                DataRow[] drDupCheck = dt.Select("Entity_Id='" + strEntityId + "'");
                if (drDupCheck.Count() > 0)
                {
                    Utility.FunShowAlertMsg(this, "Supplier already Added");
                    return;
                }
            }

            DataRow drEmptyRow;
            dtCustSubLimit = FunPriGetSubLimitDataTable();
            drEmptyRow = dtCustSubLimit.NewRow();
            drEmptyRow["Serial_Number"] = "0";
            drEmptyRow["Entity_Id"] = strEntityId;
            drEmptyRow["ENTITY_NAME"] = strEntityName;
            if (strEntityLimit != string.Empty)
                drEmptyRow["Limit"] = Convert.ToDecimal(strEntityLimit);
            if (strCuttoffDate != string.Empty)
                drEmptyRow["CuttOffDate"] = Utility.StringToDate(strCuttoffDate);
            drEmptyRow["DEL_STAT"] = 3;

            dtCustSubLimit.Rows.Add(drEmptyRow);
            ViewState["CUST_SUBLIMIT"] = dtCustSubLimit;
            FunPriFillGrid();


        }
        catch (Exception ex)
        {

        }
        finally
        {

        }
    }
    private void FunPriFillGrid()
    {
        try
        {
            DataTable dtCustSubLimit = (DataTable)ViewState["CUST_SUBLIMIT"];
            grvCustSubLimit.DataSource = dtCustSubLimit;
            grvCustSubLimit.DataBind();
            grvCustSubLimit.Rows[0].Visible = false;
        }
        catch (Exception ex)
        {
        }
    }

    private DataTable FunPriGetSubLimitDataTable()
    {
        try
        {
            DataRow drEmptyRow;
            if (ViewState["CUST_SUBLIMIT"] == null)
            {
                dtCustSubLimit = new DataTable();
                dtCustSubLimit.Columns.Add("Serial_Number");
                dtCustSubLimit.Columns.Add("Entity_Id");
                dtCustSubLimit.Columns.Add("ENTITY_NAME");
                dtCustSubLimit.Columns.Add("Limit", System.Type.GetType("System.Decimal"));
                dtCustSubLimit.Columns.Add("CuttOffDate");
                dtCustSubLimit.Columns.Add("DEL_STAT", Type.GetType("System.Int32"));
                ViewState["CUST_SUBLIMIT"] = dtCustSubLimit;
            }
            dtCustSubLimit = (DataTable)ViewState["CUST_SUBLIMIT"];

        }
        catch (Exception ex)
        {

        }
        return dtCustSubLimit;

    }

    protected void grvCustSubLimit_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        try
        {
            if (e.Row.RowType == DataControlRowType.Footer)
            {
                DropDownList ddlEntityTypeF = e.Row.FindControl("ddlEntityTypeF") as DropDownList;
                DropDownList lnkAdd = e.Row.FindControl("lnkAdd") as DropDownList;
                TextBox txtCutOffDateF = e.Row.FindControl("txtCutOffDateF") as TextBox;
                txtCutOffDateF.Attributes.Add("onblur", "fnDoDate(this,'" + txtDOB.ClientID + "','" + strDateFormat + "',true,false);");

                AjaxControlToolkit.CalendarExtender CalendarExtenderCuttOffDate = e.Row.FindControl("CalendarExtenderCuttOffDate") as AjaxControlToolkit.CalendarExtender;
                CalendarExtenderCuttOffDate.Format = strDateFormat;
                FunPubLoadEntityType(ddlEntityTypeF);
            }
            if (e.Row.RowType == DataControlRowType.DataRow)
            {
                LinkButton lnkEdit = e.Row.FindControl("lnkEdit") as LinkButton;
                LinkButton lnkRemove = e.Row.FindControl("lnkRemove") as LinkButton;
                LinkButton lnkAdd = e.Row.FindControl("lnkAdd") as LinkButton;
                TextBox txtCutOffDate = e.Row.FindControl("txtCutOffDate") as TextBox;
                Label lbldelst = e.Row.FindControl("lbldelst") as Label;
                Label lblEntityId = e.Row.FindControl("lblEntityId") as Label;



                if (strMode == "Q")
                {
                    lnkEdit.Enabled = false;
                    lnkRemove.Enabled = false;
                    lnkAdd.Enabled = false;
                }
                else
                {
                    Dictionary<string, string> ProParm = new Dictionary<string, string>();
                    ProParm.Add("@OPTION", "2001");
                    ProParm.Add("@Param1", intCustomerId.ToString());
                    ProParm.Add("@Param2", lblEntityId.Text);
                    DataTable dt = Utility.GetDefaultData("S3G_OR_GET_CUSTLOOKUP", ProParm);
                    if (dt.Rows.Count > 0)
                    {
                        lnkRemove.Enabled = false;
                        lnkRemove.OnClientClick = null;
                    }
                }
                if (txtCutOffDate.Text != string.Empty)
                {
                    txtCutOffDate.Text = DateTime.Parse(txtCutOffDate.Text.ToString(), CultureInfo.CurrentCulture.DateTimeFormat).ToString(strDateFormat);
                }

            }
        }
        catch (Exception ex)
        {

        }
    }
    public void FunPubLoadEntityType(DropDownList ddlCommon)
    {
        Dictionary<string, string> ProParm = new Dictionary<string, string>();
        ProParm.Add("@COMPANY_ID", "1");
        ddlCommon.BindDataTable("S3G_ORG_GET_ENTITY", ProParm, new string[] { "ID", "NAME" });

    }
    public void txtLimitAmnt_OntextChanged(object sender, EventArgs e)
    {
        TextBox txtAmount = (TextBox)sender;
        if (Convert.ToDecimal(txtAmount.Text) <= 0)
        {
            Utility.FunShowAlertMsg(this, "Amount Should be greater than Zero");
            txtAmount.Text = string.Empty;
            return;
        }
    }
    public void OntxtPercentageStake(object sender, EventArgs e)
    {
        StaffUpdation();
    }

    private void StaffUpdation()
    {
        //txtnobranch.Text = "0";

        if (txtPercentageStake.Text != string.Empty)
        {
            if (txtJVPartnerStake.Text != string.Empty)
                txtnobranch.Text = (Convert.ToInt32(txtPercentageStake.Text) + Convert.ToInt32(txtJVPartnerStake.Text)).ToString();
            else
                txtnobranch.Text = Convert.ToInt32(txtPercentageStake.Text).ToString();
        }
        else
        {
            if (txtJVPartnerStake.Text != string.Empty)
                txtnobranch.Text = Convert.ToInt32(txtJVPartnerStake.Text).ToString();
            else
                txtnobranch.Text = "";
        }
    }

    public void OntxtJVPartnerStake(object sender, EventArgs e)
    {
        StaffUpdation();
    }
    // Added By R. Manikandan CBO Related CR
    protected void FunGetCity()
    {
        Procparam = new Dictionary<string, string>();
        Procparam.Clear();
        Procparam.Add("@Company_ID", "1");
        Procparam.Add("@Category", "1");
        Procparam.Add("@PrefixText", "");
        //txtComCity.BindDataTable("S3G_SYSAD_GetAddressLoodup_AGT", Procparam, true, "-- Select --", new string[] { "ID", "NAME" });
        //txtPerCity.BindDataTable("S3G_SYSAD_GetAddressLoodup_AGT", Procparam, true, "-- Select --", new string[] { "ID", "NAME" });
    }
    protected void FunGetIndustryCode()
    {
        Procparam = new Dictionary<string, string>();
        Procparam.Clear();
        Procparam.Add("@Company_ID", "1");
        DataTable dtSource = new DataTable();
        DataTable dtAddr = Utility.GetDefaultData("OR_GET_INDUSTRYCODE", Procparam);
        //cmbIndustryCode.BindDataTable("OR_GET_INDUSTRYCODE", Procparam, true, "-- Select --", new string[] { "ID", "NAME" });
        cmbIndustryCode.FillDataTable(dtAddr, "ID", "NAME", true);
    }
    protected void FunGetSubIndustryCode()
    {
        Procparam = new Dictionary<string, string>();
        Procparam.Clear();
        Procparam.Add("@Company_ID", "1");
        Procparam.Add("@INDUSTRY_ID", cmbIndustryCode.SelectedValue);
        DataTable dtAddr = Utility.GetDefaultData("OR_GET_SUBINDUSTRYCODE", Procparam);

        //DataTable dtSource = new DataTable();
        //cmbIndustryCode.BindDataTable("OR_GET_INDUSTRYCODE", Procparam, true, "-- Select --", new string[] { "ID", "NAME" });
        cmbsub.FillDataTable(dtAddr, "ID", "NAME", true);
    }
    //protected void FunGetConstitutionName()
    //{
    //    Procparam = new Dictionary<string, string>();
    //    Procparam.Clear();
    //    Procparam.Add("@Company_ID", "1");
    //    Procparam.Add("@INDUSTRY_ID", cmbIndustryCode.SelectedValue);
    //    DataTable dtAddr = Utility.GetDefaultData("OR_GET_SUBINDUSTRYCODE", Procparam);

    //    //DataTable dtSource = new DataTable();
    //    //cmbIndustryCode.BindDataTable("OR_GET_INDUSTRYCODE", Procparam, true, "-- Select --", new string[] { "ID", "NAME" });
    //    ddlConstitutionName.FillDataTable(dtAddr, "ID", "NAME", true);
    //}


    #endregion

    protected void cmbIndustryCode_SelectedIndexChanged(object sender, EventArgs e)
    {
        FunGetSubIndustryCode();
    }

    protected void grvShars_RowCommand(object sender, System.Web.UI.WebControls.GridViewCommandEventArgs e)
    {
        try
        {
            TextBox txtFSholderName = (TextBox)grvShars.FooterRow.FindControl("txtFSholderName");
            TextBox txtFSHARE_HOLDER_NO = (TextBox)grvShars.FooterRow.FindControl("txtFSHARE_HOLDER_NO");
            TextBox txtFSHARE_HOLDER_NATION = (TextBox)grvShars.FooterRow.FindControl("txtFSHARE_HOLDER_NATION");
            TextBox txtFSHARE_HOLDER_PERC = (TextBox)grvShars.FooterRow.FindControl("txtFSHARE_HOLDER_PERC");
            Label lblSNO = (Label)grvShars.FindControl("lblSNO");
            DataRow dr = null;
            DataTable dtShars = (DataTable)ViewState["SharsDetails"];

            if (e.CommandName == "AddNew")
            {
                if (txtFSholderName.Text == string.Empty)
                {
                    txtFSholderName.Focus();
                    Utility.FunShowAlertMsg(this, "Enter the Share holder Name");
                    return;
                }


                dr = dtShars.NewRow();
                dr["SNO"] = dtShars.Rows.Count + 1;
                dr["SHARE_HOLDER_NAME"] = txtFSholderName.Text.Trim();
                dr["SHARE_HOLDER_NO"] = txtFSHARE_HOLDER_NO.Text.Trim();
                dr["SHARE_HOLDER_NATION"] = txtFSHARE_HOLDER_NATION.Text.Trim();
                dr["SHARE_HOLDER_PERC"] = txtFSHARE_HOLDER_PERC.Text.Trim();
                dtShars.Rows.Add(dr);
                grvShars.DataSource = dtShars;
                grvShars.DataBind();
                ViewState["SharsDetails"] = dtShars;
            }
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
        }
        finally
        {
        }
    }

    protected void grvShars_RowDeleting(object sender, GridViewDeleteEventArgs e)
    {
        try
        {
            Dictionary<string, string> dictParam;
            dictParam = new Dictionary<string, string>();
            grvShars.EditIndex = -1;
            DataTable dtEditApprDet = (DataTable)ViewState["SharsDetails"];
            dtEditApprDet.Rows.RemoveAt(e.RowIndex);
            if (dtEditApprDet.Rows.Count > 0)
            {
                grvShars.DataSource = dtEditApprDet;
                grvShars.DataBind();
                ViewState["SharsDetails"] = dtEditApprDet;
            }
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);

        }
        finally
        {
        }
    }

    private void FunPubBindSharsGrid()
    {
        try
        {
            DataTable dtUsers = new DataTable();
            DataRow dr;
            dtUsers.Columns.Add("SNO");
            dtUsers.Columns.Add("SHARE_HOLDER_NAME");
            dtUsers.Columns.Add("SHARE_HOLDER_NO");
            dtUsers.Columns.Add("SHARE_HOLDER_NATION");
            dtUsers.Columns.Add("SHARE_HOLDER_PERC");
            dr = dtUsers.NewRow();
            dtUsers.Rows.Add(dr);
            grvShars.DataSource = dtUsers;
            grvShars.DataBind();
            dtUsers.Rows[0].Delete();
            ViewState["SharsDetails"] = dtUsers;
            grvShars.Rows[0].Visible = false;
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);

        }
        finally
        {
        }
    }

    private void FunPubBindAddsGrid()
    {
        try
        {
            DataTable dtadds = new DataTable();
            DataRow dr;
            dtadds.Columns.Add("CUST_ADD_MAPPING_ID");
            dtadds.Columns.Add("Cust_Address_ID");
            dtadds.Columns.Add("Cust_Address_Type_ID");
            dtadds.Columns.Add("Postal_Code_Text");
            dtadds.Columns.Add("Postal_Code_Value");
            dtadds.Columns.Add("Post_Box_No");
            dtadds.Columns.Add("Way_No");
            dtadds.Columns.Add("House_No");
            dtadds.Columns.Add("Block_No");
            dtadds.Columns.Add("Flat_No");
            dtadds.Columns.Add("LandMark");
            dtadds.Columns.Add("Area_Sheik_Text");
            dtadds.Columns.Add("Area_Sheik_Value");
            dtadds.Columns.Add("Residence_Phone_No");
            dtadds.Columns.Add("Residence_Fax_No");
            dtadds.Columns.Add("Mobile_Phone_No");
            dtadds.Columns.Add("Contact_Name");
            dtadds.Columns.Add("Contact_No");
            dtadds.Columns.Add("Office_Phone_No");
            dtadds.Columns.Add("Cust_Email");
            dr = dtadds.NewRow();
            dtadds.Rows.Add(dr);
            grvAddressDetails.DataSource = dtadds;
            grvAddressDetails.DataBind();
            dtadds.Rows[0].Delete();
            ViewState["AddsDetailsTable"] = dtadds;
            grvAddressDetails.Rows[0].Visible = false;
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);

        }
        finally
        {
        }
    }

    private void funPriLoadNationality()
    {
        try
        {
            Dictionary<string, string> Procparam = new Dictionary<string, string>();
            Procparam.Add("@Company_ID", intCompanyId.ToString());
            Procparam.Add("@Lookup_Type", "NATIONALITY");
            Procparam.Add("@Table_Name", "S3G_ORG_GROUP_INDUSTRY_TYPE");
            ddlNationality.BindDataTable("S3G_GET_COMMON_LOOKUP_VAL", Procparam, true, "--Select--", new string[] { "ID", "LOOKUP_CODE", "DESCRIPTION" });
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex);
        }

    }

    protected void ddlNationality_OnSelectedIndexChanged(object sender, EventArgs e)
    {
        if (ddlCustomerType.SelectedItem.Text.Trim().ToUpper() == "INDIVIDUAL")
        {
            if (ddlNationality.SelectedItem.Text.Trim().ToUpper().Contains("888"))//Oman
            {
                lblIdentityColumn.Text = "N.ID.";
                lblIdentityColumn.ToolTip = "N.ID.";
                txtIdentityColumn.ToolTip = "N.ID.";
                lblIdentityIssueDate.Text = "N.ID. Issue Date";
                lblIdentityIssueDate.ToolTip = "N.ID. Issue Date";
                txtIdentityIssueDate.ToolTip = "N.ID. Issue Date";
                lblIdentityExpiredate.Text = "N.ID. Expiry Date";
                lblIdentityExpiredate.ToolTip = "N.ID. Expiry Date";
                txtIdentityExpiredate.ToolTip = "N.ID. Expiry Date";
            }
            else//Non Oman
            {
                lblIdentityColumn.Text = "Passport Number";
                lblIdentityColumn.ToolTip = "Passport Number";
                txtIdentityColumn.ToolTip = "Passport Number";
                lblIdentityIssueDate.Text = "Passport Issue Date";
                lblIdentityIssueDate.ToolTip = "Passport Issue Date";
                txtIdentityIssueDate.ToolTip = "Passport Issue Date";
                lblIdentityExpiredate.Text = "Passport Expiry Date";
                lblIdentityExpiredate.ToolTip = "Passport Expiry Date";
                txtIdentityExpiredate.ToolTip = "Passport Expiry Date";
            }
        }
        else
        {
            lblIdentityColumn.Text = "CR No.";
            lblIdentityColumn.ToolTip = "CR No.";
            txtIdentityColumn.ToolTip = "CR No.";
            lblIdentityIssueDate.Text = "CR No. Issue Date";
            lblIdentityIssueDate.ToolTip = "CR No. Issue Date";
            txtIdentityIssueDate.ToolTip = "CR No. Issue Date";
            lblIdentityExpiredate.Text = "CR No. Expiry Date";
            lblIdentityExpiredate.ToolTip = "CR No. Expiry Date";
            txtIdentityExpiredate.ToolTip = "CR No. Expiry Date";
        }
    }

    //protected void ddlAddressType_OnSelectedIndexChanged(object sender, EventArgs e)
    //{
    //    try
    //    {
    //        if (ddlAddressType.SelectedIndex > 0)
    //        {
    //            pnlCA.GroupingText = ddlAddressType.SelectedItem.Text.Trim() + " Address";
    //            //ucBasicDetAddressSetup.BindAddressSetupDetails(Convert.ToInt32(ddlAddressType.SelectedValue));
    //        }
    //    }
    //    catch(Exception ex)
    //    {

    //    }
    //}

    private void funPriLoadAddressType()
    {
        try
        {
            Dictionary<string, string> Procparam = new Dictionary<string, string>();
            Procparam.Add("@Company_ID", intCompanyId.ToString());
            Procparam.Add("@Lookup_Type", "ADDRESS_TYPE");
            Procparam.Add("@Table_Name", "S3G_ORG_Lookup");
            ddlAddressType.BindDataTable("S3G_GET_COMMON_LOOKUP_VAL", Procparam, true, "--Select--", new string[] { "ID", "DESCRIPTION" });
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex);
        }
    }

    private void funPriLoadIndividualLoad()
    {
        try
        {
            Dictionary<string, string> Procparam = new Dictionary<string, string>();
            Procparam.Add("@Company_ID", intCompanyId.ToString());
            Procparam.Add("@Lookup_Type", "OCCUPATION");
            Procparam.Add("@Table_Name", "S3G_ORG_Lookup");
            cmbOccupation.BindDataTable("S3G_GET_COMMON_LOOKUP_VAL", Procparam, true, "--Select--", new string[] { "ID", "DESCRIPTION" });

            Procparam = new Dictionary<string, string>();
            Procparam.Add("@Company_ID", intCompanyId.ToString());
            Procparam.Add("@Lookup_Type", "EMPLOYER");
            Procparam.Add("@Table_Name", "S3G_ORG_Lookup");
            cmbEmployerName.BindDataTable("S3G_GET_COMMON_LOOKUP_VAL", Procparam, true, "--Select--", new string[] { "ID", "DESCRIPTION" });

            Procparam = new Dictionary<string, string>();
            Procparam.Add("@Company_ID", intCompanyId.ToString());
            Procparam.Add("@Lookup_Type", "EMPLOYER_ACTCODE");
            Procparam.Add("@Table_Name", "S3G_ORG_Lookup");
            cmEmpEcoCode.BindDataTable("S3G_GET_COMMON_LOOKUP_VAL", Procparam, true, "--Select--", new string[] { "ID", "DESCRIPTION" });


        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex);
        }
    }

    private void funPriLoadCommonLoad()
    {
        try
        {
            Dictionary<string, string> Procparam = new Dictionary<string, string>();
            Procparam.Add("@Company_ID", intCompanyId.ToString());
            Procparam.Add("@Lookup_Type", "FACTORING_TYPE");
            Procparam.Add("@Table_Name", "S3G_ORG_Lookup");
            cmbFactoringType.BindDataTable("S3G_GET_COMMON_LOOKUP_VAL", Procparam, true, "--Select--", new string[] { "ID", "DESCRIPTION" });

            Procparam = new Dictionary<string, string>();
            Procparam.Add("@Company_ID", intCompanyId.ToString());
            Procparam.Add("@Lookup_Type", "INDUSTRY_TYPE");
            Procparam.Add("@Table_Name", "S3G_ORG_Lookup");
            cmbIndustryType.BindDataTable("S3G_GET_COMMON_LOOKUP_VAL", Procparam, true, "--Select--", new string[] { "ID", "DESCRIPTION" });
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex);
        }
    }

    private void funPriLoadNonIndividualLoad()
    {
        try
        {
            Dictionary<string, string> Procparam = new Dictionary<string, string>();
            Procparam.Add("@Company_ID", intCompanyId.ToString());
            Procparam.Add("@Lookup_Type", "FINANCIAL_RECEIVED");
            Procparam.Add("@Table_Name", "S3G_ORG_Lookup");
            cmbFinancialReceived.BindDataTable("S3G_GET_COMMON_LOOKUP_VAL", Procparam, true, "--Select--", new string[] { "ID", "DESCRIPTION" });

        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex);
        }
    }

    //private void funPriLoadNonIndividualLoad()
    //{
    //    try
    //    {
    //        Dictionary<string, string> Procparam = new Dictionary<string, string>();
    //        Procparam.Add("@Company_ID", intCompanyId.ToString());
    //        Procparam.Add("@Lookup_Type", "FINANCIAL_RECEIVED");
    //        Procparam.Add("@Table_Name", "S3G_ORG_Lookup");
    //        cmbFinancialReceived.BindDataTable("S3G_GET_COMMON_LOOKUP_VAL", Procparam, true, "--Select--", new string[] { "ID", "DESCRIPTION" });

    //    }
    //    catch (Exception ex)
    //    {
    //        ClsPubCommErrorLogDB.CustomErrorRoutine(ex);
    //    }
    //}

    protected void btnAddAdds_Click(object sender, EventArgs e)
    {
        try
        {
            //if (txtBankAddress.Text.Length > 300)
            //{
            //    ScriptManager.RegisterStartupScript(this, this.GetType(), "Followup Details", "alert('Bank Address Length should be less than or equal to 300');", true);
            //    tcCustomerMaster.ActiveTabIndex = 2;
            //    return;
            //}
            DataRow drDetails;
            DataTable dtAddsDetails = (DataTable)ViewState["AddsDetailsTable"];
            if (dtAddsDetails.Rows.Count < 10)
            {
                drDetails = dtAddsDetails.NewRow();
                string strBankMapId = Convert.ToString(dtAddsDetails.Rows.Count + 1);
                drDetails["CUST_ADD_MAPPING_ID"] = strBankMapId;
                drDetails["Cust_Address_ID"] = "0";
                drDetails["Cust_Address_Type_ID"] = ddlAddressType.SelectedValue;
                drDetails["Postal_Code_Text"] = ucBasicDetAddressSetup.PostalCode_Text;
                drDetails["Postal_Code_Value"] = ucBasicDetAddressSetup.PostalCode_Value;
                drDetails["Post_Box_No"] = ucBasicDetAddressSetup.PostBoxNo;
                drDetails["Way_No"] = ucBasicDetAddressSetup.WayNo;
                drDetails["House_No"] = ucBasicDetAddressSetup.HouseNo;
                drDetails["Block_No"] = ucBasicDetAddressSetup.BlockNo;
                drDetails["Flat_No"] = ucBasicDetAddressSetup.FlatNo;
                drDetails["LandMark"] = ucBasicDetAddressSetup.LandMark;
                drDetails["Area_Sheik_Text"] = ucBasicDetAddressSetup.AreaSheik_Text;
                drDetails["Area_Sheik_Value"] = ucBasicDetAddressSetup.AreaSheik_Value;
                drDetails["Residence_Phone_No"] = ucBasicDetAddressSetup.ResidencePhoneNo;
                drDetails["Residence_Fax_No"] = ucBasicDetAddressSetup.ResidenceFaxNo;
                drDetails["Mobile_Phone_No"] = ucBasicDetAddressSetup.MobilePhoneNo;
                drDetails["Contact_Name"] = ucBasicDetAddressSetup.ContactName;
                drDetails["Contact_No"] = ucBasicDetAddressSetup.ContactNo;
                drDetails["Office_Phone_No"] = ucBasicDetAddressSetup.OfficePhoneNo;
                drDetails["Cust_Email"] = ucBasicDetAddressSetup.CustomerEmail;
                dtAddsDetails.Rows.Add(drDetails);
                grvAddressDetails.DataSource = dtAddsDetails;
                grvAddressDetails.DataBind();

                ViewState["AddsDetailsTable"] = dtAddsDetails;               
            }
            else
            {
                ScriptManager.RegisterStartupScript(this, this.GetType(), "Bank Details", "alert('Customer Bank Details should be less than or equal to 9 Banks');", true);
            }
            ucBasicDetAddressSetup.BindAddressSetupDetails(1);
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            cvCustomerMaster.ErrorMessage = "Due to Data Problem, Unable to Add Bank Details";
            cvCustomerMaster.IsValid = false;
        }
    }

    protected void btnModifyAdds_Click(object sender, EventArgs e)
    {
        try
        {
            if (txtBankAddress.Text.Length > 300)
            {
                ScriptManager.RegisterStartupScript(this, this.GetType(), "Followup Details", "alert('Bank Address Length should be less than or equal to 300');", true);
                tcCustomerMaster.ActiveTabIndex = 2;
                return;
            }
            DataTable dtAddsDetails = (DataTable)ViewState["AddsDetailsTable"];

            DataView dvAddsdetails = dtAddsDetails.DefaultView;
            dvAddsdetails.Sort = "CUST_ADD_MAPPING_ID";
            int rowindex = dvAddsdetails.Find(hdnAddsID.Value);
            dvAddsdetails[rowindex].Row["Cust_Address_Type_ID"] = ddlAccountType.SelectedItem.Text;
            dvAddsdetails[rowindex].Row["Postal_Code_Text"] = ucBasicDetAddressSetup.PostalCode_Text;
            dvAddsdetails[rowindex].Row["Postal_Code_Value"] = ucBasicDetAddressSetup.PostalCode_Value;
            dvAddsdetails[rowindex].Row["Post_Box_No"] = ucBasicDetAddressSetup.PostBoxNo;
            dvAddsdetails[rowindex].Row["Way_No"] = ucBasicDetAddressSetup.WayNo;
            dvAddsdetails[rowindex].Row["House_No"] = ucBasicDetAddressSetup.HouseNo;
            dvAddsdetails[rowindex].Row["Block_No"] = ucBasicDetAddressSetup.BlockNo;
            dvAddsdetails[rowindex].Row["Flat_No"] = ucBasicDetAddressSetup.FlatNo;
            dvAddsdetails[rowindex].Row["LandMark"] = ucBasicDetAddressSetup.LandMark;
            dvAddsdetails[rowindex].Row["Area_Sheik_Text"] = ucBasicDetAddressSetup.AreaSheik_Text;
            dvAddsdetails[rowindex].Row["Area_Sheik_Value"] = ucBasicDetAddressSetup.AreaSheik_Value;
            dvAddsdetails[rowindex].Row["Residence_Phone_No"] = ucBasicDetAddressSetup.ResidencePhoneNo;
            dvAddsdetails[rowindex].Row["Residence_Fax_No"] = ucBasicDetAddressSetup.ResidenceFaxNo;
            dvAddsdetails[rowindex].Row["Mobile_Phone_No"] = ucBasicDetAddressSetup.MobilePhoneNo;
            dvAddsdetails[rowindex].Row["Contact_Name"] = ucBasicDetAddressSetup.ContactName;
            dvAddsdetails[rowindex].Row["Contact_No"] = ucBasicDetAddressSetup.ContactNo;
            dvAddsdetails[rowindex].Row["Office_Phone_No"] = ucBasicDetAddressSetup.OfficePhoneNo;
            dvAddsdetails[rowindex].Row["Cust_Email"] = ucBasicDetAddressSetup.CustomerEmail;
            grvAddressDetails.DataSource = dvAddsdetails;
            grvAddressDetails.DataBind();
            FunPriHideBankColumns();
            ViewState["AddsDetailsTable"] = dvAddsdetails.Table;
            ClearBankDetailsControls();
            btnAddAdds.Enabled = true;
            btnModifyAdds.Enabled = false;
            ucBasicDetAddressSetup.BindAddressSetupDetails(1);
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            cvCustomerMaster.ErrorMessage = "Due to Data Problem, Unable to Modify the Bank Details";
            cvCustomerMaster.IsValid = false;

        }
    }

    protected void grvAddressDetails_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        try
        {
            if (strMode != "Q")
            {
                if (e.Row.RowType == DataControlRowType.DataRow)
                {
                    /* For Deleting purpose, Restrcit to add attribute to the Cell Remove linkbutton*/
                    for (int intCellIndex = 0; intCellIndex < e.Row.Cells.Count - 2; intCellIndex++)
                    {
                        e.Row.Cells[intCellIndex].Attributes["onclick"] = ClientScript.GetPostBackClientHyperlink
                        (this.grvAddressDetails, "Select$" + e.Row.RowIndex);
                    }
                    e.Row.Attributes["onmouseover"] = "javascript:setMouseOverColor(this);";
                    e.Row.Attributes["onmouseout"] = "javascript:setMouseOutColor(this);";

                }
            }
            //if (strMode == "Q" && e.Row.RowType == DataControlRowType.DataRow)
            //{
            //    TextBox lblBankAddress = e.Row.FindControl("lblBankAddress") as TextBox;
            //    lblBankAddress.Enabled = true;
            //    lblBankAddress.ReadOnly = true;
            //}
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            throw new ApplicationException("Unable to Load the Bank Details");
        }
    }

    protected void grvAddressDetails_RowDeleting(object sender, GridViewDeleteEventArgs e)
    {
        try
        {
            DataTable dtDelete = (DataTable)ViewState["AddsDetailsTable"];
            dtDelete.Rows.RemoveAt(e.RowIndex);
            grvAddressDetails.DataSource = dtDelete;
            grvAddressDetails.DataBind();
            ViewState["AddsDetailsTable"] = dtDelete;
            ClearBankDetailsControls();
            if (grvAddressDetails.Rows.Count == 0)
            {
                btnAddAdds.Enabled = true;
                btnModifyAdds.Enabled = false;
            }
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            cvCustomerMaster.ErrorMessage = "Due to Data Problem, Unable to Remove Address Details";
            cvCustomerMaster.IsValid = false;
        }
    }

    protected void grvAddressDetails_SelectedIndexChanged(object sender, EventArgs e)
    {
        try
        {

            Label lblCust_Add_Mapping_ID = grvAddressDetails.SelectedRow.FindControl("lblCust_Add_Mapping_ID") as Label;
            Label lblCust_Address_ID = grvAddressDetails.SelectedRow.FindControl("lblCust_Address_ID") as Label;
            Label lblCust_Address_Type_ID = grvAddressDetails.SelectedRow.FindControl("lblCust_Address_Type_ID") as Label;
            Label lblPostalCode_Text = grvAddressDetails.SelectedRow.FindControl("lblPostalCode_Text") as Label;
            Label lblPostalCode_Value = grvAddressDetails.SelectedRow.FindControl("lblPostalCode_Value") as Label;
            if (lblCust_Address_Type_ID.Text.Trim() != string.Empty)
            {
                hdnAddsID.Value = lblCust_Add_Mapping_ID.Text.Trim();
                ucBasicDetAddressSetup.PostalCode_Text = lblPostalCode_Text.Text.Trim();
                ucBasicDetAddressSetup.PostalCode_Value = lblPostalCode_Value.Text.Trim();
                ucBasicDetAddressSetup.PostBoxNo = Convert.ToString(grvAddressDetails.SelectedRow.Cells[5].Text.Trim());
                ucBasicDetAddressSetup.WayNo = Convert.ToString(grvAddressDetails.SelectedRow.Cells[6].Text.Trim());
                ucBasicDetAddressSetup.HouseNo = Convert.ToString(grvAddressDetails.SelectedRow.Cells[7].Text.Trim());
                ucBasicDetAddressSetup.BlockNo = Convert.ToString(grvAddressDetails.SelectedRow.Cells[8].Text.Trim());
                ucBasicDetAddressSetup.FlatNo = Convert.ToString(grvAddressDetails.SelectedRow.Cells[9].Text.Trim());
                ucBasicDetAddressSetup.LandMark = Convert.ToString(grvAddressDetails.SelectedRow.Cells[10].Text.Trim());
                ucBasicDetAddressSetup.AreaSheik_Text = Convert.ToString(grvAddressDetails.SelectedRow.Cells[11].Text.Trim());
                ucBasicDetAddressSetup.AreaSheik_Value = Convert.ToString(grvAddressDetails.SelectedRow.Cells[12].Text.Trim());
                ucBasicDetAddressSetup.ResidencePhoneNo = Convert.ToString(grvAddressDetails.SelectedRow.Cells[13].Text.Trim());
                ucBasicDetAddressSetup.ResidenceFaxNo = Convert.ToString(grvAddressDetails.SelectedRow.Cells[14].Text.Trim());
                ucBasicDetAddressSetup.MobilePhoneNo = Convert.ToString(grvAddressDetails.SelectedRow.Cells[15].Text.Trim());
                ucBasicDetAddressSetup.ContactName = Convert.ToString(grvAddressDetails.SelectedRow.Cells[16].Text.Trim());
                ucBasicDetAddressSetup.ContactNo = Convert.ToString(grvAddressDetails.SelectedRow.Cells[17].Text.Trim());
                ucBasicDetAddressSetup.OfficePhoneNo = Convert.ToString(grvAddressDetails.SelectedRow.Cells[18].Text.Trim());
                ucBasicDetAddressSetup.OfficeFaxNo = Convert.ToString(grvAddressDetails.SelectedRow.Cells[19].Text.Trim());
                ucBasicDetAddressSetup.CustomerEmail = Convert.ToString(grvAddressDetails.SelectedRow.Cells[20].Text.Trim());
            }
            //Label lblAccountTypeId = grvBankDetails.SelectedRow.FindControl("lblAccountTypeId") as Label;
            //TextBox lblBankAddress = grvBankDetails.SelectedRow.FindControl("lblBankAddress") as TextBox;

            //CheckBox chkGridDefaultAccount = grvBankDetails.SelectedRow.FindControl("chkDefaultAccount") as CheckBox;

            //ddlAccountType.SelectedValue = lblAccountTypeId.Text;
            //if (grvBankDetails.SelectedRow.Cells[5].Text != "&nbsp;")
            //    txtAccountNumber.Text = Convert.ToString(grvBankDetails.SelectedRow.Cells[5].Text);
            //if (grvBankDetails.SelectedRow.Cells[9].Text != "&nbsp;")
            //    txtMICRCode.Text = Convert.ToString(grvBankDetails.SelectedRow.Cells[9].Text);
            //if (grvBankDetails.SelectedRow.Cells[10].Text != "&nbsp;")
            //    txtBankName.Text = Convert.ToString(grvBankDetails.SelectedRow.Cells[10].Text);
            //if (grvBankDetails.SelectedRow.Cells[11].Text != "&nbsp;")
            //    txtBankBranch.Text = Convert.ToString(grvBankDetails.SelectedRow.Cells[11].Text);
            //txtBankAddress.Text = lblBankAddress.Text;
            //hdnBankId.Value = lblCust_Add_Mapping_ID.Text;
            ///*Modified By prabhu on 16-Nov-2011 for CR (Default Account in Bank Details)*/
            //chkDefaultAccount.Checked = chkGridDefaultAccount.Checked;
            //if (grvBankDetails.SelectedRow.Cells[6].Text != "&nbsp;")
            //    txtIFSC_Code.Text = Convert.ToString(grvBankDetails.SelectedRow.Cells[6].Text);//IFSC Code
            //ddlPANum.SelectedIndex = -1;
            //if (!string.IsNullOrEmpty(grvBankDetails.SelectedRow.Cells[7].Text))
            //{
            //    if (grvBankDetails.SelectedRow.Cells[7].Text != "&nbsp;")
            //        ddlPANum.SelectedValue = Convert.ToString(grvBankDetails.SelectedRow.Cells[7].Text);
            //}
            //ddlSANum.Items.Clear();
            //if (!string.IsNullOrEmpty(grvBankDetails.SelectedRow.Cells[8].Text))
            //{
            //    if (grvBankDetails.SelectedRow.Cells[8].Text != "&nbsp;")
            //    {
            //        ddlPANum_SelectedIndexChanged(null, null);
            //        ddlSANum.SelectedValue = Convert.ToString(grvBankDetails.SelectedRow.Cells[8].Text);
            //    }
            //}
            btnAddAdds.Enabled = false;
            btnModifyAdds.Enabled = true;

        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, strPageName);
            cvCustomerMaster.ErrorMessage = "Due to Data Problem,Unable to view the Address Details";
            cvCustomerMaster.IsValid = false;
        }
    }

    protected void txtBranchList_OnTextChanged(object sender, EventArgs e)
    {
        try
        {
            string strhdnValue = hdnLocationID.Value;
            if ((strhdnValue == "-1" || strhdnValue == string.Empty) || txtBranchList.Text.Trim() == "Records not found!")
            {
                txtBranchList.Text = string.Empty;
                hdnLocationID.Value = string.Empty;
            }
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, "User Management");
        }
    }

    protected void txtGroupCode_OnTextChanged(object sender, EventArgs e)
    {
        try
        {
            string strhdnValue = hdnGroupCode.Value;
            if ((strhdnValue == "-1" || strhdnValue == string.Empty) || txtGroupCode.Text.Trim() == "Records not found!")
            {
                txtGroupCode.Text = string.Empty;
                hdnGroupCode.Value = string.Empty;
            }
        }
        catch (Exception ex)
        {
            ClsPubCommErrorLogDB.CustomErrorRoutine(ex, "User Management");
        }
    }

    #region Location Bind
    // Created By: Anbuvel
    // Created Date: 19-May-2018
    // Description: To Bind Location Value
    /// <summary>
    /// GetBranchList
    /// </summary>
    /// <param name="prefixText">search text</param>
    /// <param name="count">no of matches to display</param>
    /// <returns>string[] of matching names</returns>
    [System.Web.Services.WebMethod]
    public static string[] GetBranchList(String prefixText, int count)
    {
        Dictionary<string, string> Procparam;
        Procparam = new Dictionary<string, string>();
        List<String> suggetions = new List<String>();
        DataTable dtCommon = new DataTable();
        DataSet Ds = new DataSet();

        Procparam.Clear();
        Procparam.Add("@Company_ID", obj_Page.intCompanyId.ToString());
        Procparam.Add("@Type", "GEN");
        if (Convert.ToInt32(obj_Page.intUserId) > 0)
        {
            Procparam.Add("@User_ID", obj_Page.intUserId.ToString());
        }
        Procparam.Add("@Program_Id", "45");
        //Procparam.Add("@Lob_Id", obj_Page.ddlLOB.SelectedValue);
        Procparam.Add("@Is_Active", "1");
        Procparam.Add("@PrefixText", prefixText);
        suggetions = Utility.GetSuggestions(Utility.GetDefaultData(SPNames.S3G_SA_GET_BRANCHLIST, Procparam));

        return suggetions.ToArray();
    }

    #endregion

    private void FunPriLoadAddressDetails(int intCustomerId)
    {
        try
        {
            DataTable dt = new DataTable();
            Dictionary<string, string> objProcedureParameters = new Dictionary<string, string>();
            objProcedureParameters.Add("@Option", "1");
            objProcedureParameters.Add("@CustomerId", intCustomerId.ToString());
            dt = Utility.GetDefaultData("S3G_OR_GET_CUSTOTHERS_DTLS", objProcedureParameters);
            if (dt.Rows.Count > 0)
            {
                grvAddressDetails.DataSource = dt;
                grvAddressDetails.DataBind();
                ViewState["AddsDetailsTable"] = dt;
                ucBasicDetAddressSetup.SetAddressDetails(dt.Rows[0]);
                //ucBasicDetAddressSetup.PostalCode_Text = Convert.ToString(dt.Rows[0]["PostalCode_Text"]);
                //ucBasicDetAddressSetup.PostalCode_Value = Convert.ToString(dt.Rows[0]["PostalCode_Value"]);
                //ucBasicDetAddressSetup.PostBoxNo = Convert.ToString(dt.Rows[0]["Post_Box_No"]);
                //ucBasicDetAddressSetup.WayNo = Convert.ToString(dt.Rows[0]["Way_No"]);
                //ucBasicDetAddressSetup.HouseNo = Convert.ToString(dt.Rows[0]["House_No"]);
                //ucBasicDetAddressSetup.BlockNo = Convert.ToString(dt.Rows[0]["Block_No"]);
                //ucBasicDetAddressSetup.FlatNo = Convert.ToString(dt.Rows[0]["Flat_No"]);
                //ucBasicDetAddressSetup.LandMark =Convert.ToString( dt.Rows[0]["LandMark"]);
                //ucBasicDetAddressSetup.AreaSheik_Text = Convert.ToString(dt.Rows[0]["Area_Sheik_Text"]);
                //ucBasicDetAddressSetup.AreaSheik_Value = Convert.ToString(dt.Rows[0]["Area_Sheik_Value"]);
                //ucBasicDetAddressSetup.ResidencePhoneNo = Convert.ToString(dt.Rows[0]["Residence_Phone_No"]);
                //ucBasicDetAddressSetup.ResidenceFaxNo = Convert.ToString(dt.Rows[0]["Residence_Fax_No"]);
                //ucBasicDetAddressSetup.MobilePhoneNo = Convert.ToString(dt.Rows[0]["Mobile_Phone_No"]);
                //ucBasicDetAddressSetup.ContactName = Convert.ToString(dt.Rows[0]["Contact_Name"]);
                //ucBasicDetAddressSetup.ContactNo = Convert.ToString(dt.Rows[0]["Contact_No"]);
                //ucBasicDetAddressSetup.OfficePhoneNo = Convert.ToString(dt.Rows[0]["Office_Phone_No"]);
                //ucBasicDetAddressSetup.OfficeFaxNo = Convert.ToString(dt.Rows[0]["Office_Fax_No"]);
                //ucBasicDetAddressSetup.CustomerEmail = Convert.ToString(dt.Rows[0]["Cust_Email"]);
                //ddlAddressType.SelectedValue = Convert.ToString(dt.Rows[0]["Cust_Address_Type_ID"]);
            }
        }
        catch (Exception ex)
        {

        }
    }
    private void FunPriLoadShareDetails(int intCustomerId)
    {
        try
        {
            DataTable dt = new DataTable();
            Dictionary<string, string> objProcedureParameters = new Dictionary<string, string>();
            objProcedureParameters.Add("@Option", "2");
            objProcedureParameters.Add("@CustomerId", intCustomerId.ToString());
            dt = Utility.GetDefaultData("S3G_OR_GET_CUSTOTHERS_DTLS", objProcedureParameters);
            if (dt.Rows.Count > 0)
            {               
                grvShars.DataSource = dt;
                grvShars.DataBind();
                ViewState["SharsDetails"] = dt;
            }
        }
        catch (Exception ex)
        {

        }
    }

    [System.Web.Services.WebMethod]
    public static string[] GetAddressPostalCodeList(String prefixText, int count)
    {

        Dictionary<string, string> Procparam;
        Procparam = new Dictionary<string, string>();
        List<String> suggetions = new List<String>();
        DataTable dtCommon = new DataTable();
        Procparam.Add("@Company_ID", obj_Page.intCompanyId.ToString());
        Procparam.Add("@Type", "1");
        Procparam.Add("@PrefixText", prefixText.Trim());
        suggetions = Utility.GetSuggestions(Utility.GetDefaultData("S3G_SYSAD_GET_ADD_SETUP_LOOKUP", Procparam));
        return suggetions.ToArray();
    }
    [System.Web.Services.WebMethod]
    public static string[] GetAddressArea_SheikList(String prefixText, int count)
    {

        Dictionary<string, string> Procparam;
        Procparam = new Dictionary<string, string>();
        List<String> suggetions = new List<String>();
        DataTable dtCommon = new DataTable();
        Procparam.Add("@Company_ID", obj_Page.intCompanyId.ToString());
        Procparam.Add("@Type", "2");
        Procparam.Add("@PrefixText", prefixText.Trim());
        suggetions = Utility.GetSuggestions(Utility.GetDefaultData("S3G_SYSAD_GET_ADD_SETUP_LOOKUP", Procparam));
        return suggetions.ToArray();

    }

    [System.Web.Services.WebMethod]
    public static string[] GetUserList(String prefixText, int count)
    {
        Dictionary<string, string> Procparam;
        Procparam = new Dictionary<string, string>();
        List<String> suggestions = new List<String>();
        DataTable dtCommon = new DataTable();
        DataSet Ds = new DataSet();
        Procparam.Clear();
        Procparam.Add("@Company_ID", obj_Page.intCompanyId.ToString());
        Procparam.Add("@Prefix", prefixText);
        suggestions = Utility.GetSuggestions(Utility.GetDefaultData(SPNames.S3G_Get_User_List, Procparam));
        return suggestions.ToArray();
    }
}

